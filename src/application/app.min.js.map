{"version":3,"sources":["app.min.js"],"names":["app","angular","module","api_url","withoutToken","POST","GET","config","$filterProvider","$routeProvider","$httpProvider","$sceDelegateProvider","when","templateUrl","otherwise","redirectTo","interceptors","push","resourceUrlWhitelist","factory","$rootScope","$cookieStore","interceptor","request","req","get","token","isObject","url","split","indexOf","method","arr","i","length","requestError","reqErr","response","data","status","alert","info","run","$location","$window","$on","location","path","user","undefined","controller","$scope","$http","$cookies","mxxServices","remove","pass","getObject","refresh","success","image","key","codeKey","loginQrcode","$","email","password","accountExp","phoneExp","mailExp","submit","captcha","md5Pwd","hex_md5","charAt","obj","clientType","userType","join","code","test","phone","account","post","callback","focus","tempToken","uid","school","sid","res","voucher","window","href","tid","loginTime","Date","getTime","put","cookieDate","schoolId","schoolName","photo","putObject","isRemember","expireDate","setDate","getDate","expires","schoolList","selected","id","chooseSid","confirm","teacherName","$routeParams","$filter","userInfo","activateUid","ishidden","currentPage","search","css","classesInfo","worksInfo","work","papersInfo","testPaper","pageSize","pageLength","offset","getData","worklist","workList","avgScore","toString","index","substring","Number","count","num","Math","ceil","pageNums","skip","$event","target","className","$timeout","classTypeName","priviteClasses","classList","linkToClass","cid","type","document","onkeydown","ev","keyCode","which","mouse","mouseover","mouseout","isAllVisible","visible","allCheck","forEach","classlist","value","array","oneCheck","headers","Content-Type","change","publicClasses","html","isAgree","isagree","parseInt","parents","changeCourse","style","cursor","liveStatusName","nowTime","parse","startTime","endTime","liveTimeList","liveRoomList","startTimeOne","endTimeOne","val","configResource","timeId","goToLive","roomId","liveStatus","teacherUrl","encodeURI","open","toolServices","click","getRandomNum","validateOne","classNumber","isNaN","validateTwo","reg","classAnnounce","createTid","maxNumber","remarkName","JSON","stringify","getClassInfo","userlist","studentList","showClass2WM","studentName","username","studentId","nickname","trim","cancel","dataStatus","description","imgCode","qrCode","getList","monitorlist","tutorList","tutorId","children","empty","monitorCode","rimgCode","len","unbindRepresent","deleteQrCode","serachSuccess","searchData","searchWork","searchName","workName","wid","showSingleTable","load","showStat","showQuestionBox","assignmentNow","showSingleCountTable","wname","submitNum","submitNumber","ansSeenTime","showAnswerType","maxScore","typeList","name","rankList","questionTypeName","questionAnswerName","changeShowStatus","checkStatus","showQuestion","qid","qType","qNumber","questionType","questionNumber","wrongStudentList","questionScore","qScore","questionAnswer","answer","userScore","score","percentage","concat","showNoneStudent","closeStudentBox","assignmentWork","paperlist","paperList","n","students","classStudent","sourceStudent","sourceStudentId","y","wrongStudent","wrongStudentId","isMake","cids","returnQuestion","targetPid","targetPaperName","shortTargetPaperName","choosePaper","pid","isFinish","paperName","cancelPaper","searchPaperFromName","getElementById","paperCount","j","getAllPaper","newPaperName","isWholeWork","changeWholeWork","isOutOfOrder","changeOutOfOrder","isViewResolution","changeViewResolution","isJoinReport","changeJoinReport","workType","doneWorkAssignment","hours","minute","second","durationTime","currentTime","year","getFullYear","month","getMonth","day","getHours","minutes","getMinutes","seconds","getSeconds","displayTime","startime","endtime","workInfo","isMixed","isJoinStatistics","tname","itid","invite","getTeacherListByCid","isChecked","isShow","check","classTeacher","teacherList","b","ele","isOwner","create","splice","sort","a","teacherInfo","this","$parent","teacher","transfer","bool","leave","showAddPaper","limit","classNum","userNumber","createSid","isPumping","getClassQuestionBankConfig","prev","next","dataId","paperNamePrefix","totalAmount","amountConf","amountInfo","totalScore","totalDuration","timeHour","timeMinute","backupsTime","backupsConfig","singleselect","multiselect","judge","subjective","numberTotal","allNumber","isShowEdit","updateQuestionbankConfig","console","log","validatePrefix","validateSingle","numStatus","validateMultiselect","validateJudge","validateSubjective","validateHour","validateMinute","validateScore","preservationConfig","cancelConfig","showBoxOfAddPaper","getMyPaperList","cancelPaperBox","myPaperCount","myPaperList","newPaperList","Array","substr","localPaperList","localPid","addToTheLocal","paperNameShort","paperData","removeFromLocal","e","sureAddPaper","removeFromClassPaper","classPaperId","reName","reNumber","rePassword","addClass","tips","counter","modify","hasClass","rePass","idx","pArray","find","removeAttr","attr","removeClass","checkType","getGoodsData","getAssistData","goodslist","goodsList","assistList","cancelAssist","ids","confirmPaper","publish","flag","element","edit","ret","copycode","copyStatus","copyFalie","copyCode","map","gid","back","selectedClass","selectedCourse","tags","stageList","courses","tagList","goodName","goodsName","totalPrice","price","validityEndTime","someTagIds","tagId","stageId","gradeList","getPrice","evt","paperPrice","toFixed","deletePaper","chooseStage","chooseClass","clearChoosen","chooseCourse","tagIds","classificationId","postTags","deleteTags","goodsId","tagAdd","tagDelete","versionList","selectedGrade","selectedVersion","selectedPaperType","getStage","payQuestion","shareType","getFreeDate","myShare","freeQuestion","getMain","changeFreeType","changePayType","chooseGrade","chooseVersion","choosePaperType","paperDate","freeList","toggle","show","changePayShowType","payShowType","changeFreeShowType","freeShowType","size","getTagList","oldList","oldTagIds","oldIds","uploadArr","pname","getPublic","publicPage","publicTagList","publicMore","morePublic","getPrivate","privatePage","privateTagList","privateMore","morePrivate","newTag","addTagName","isPublic","tagType","tagName","addTag","deleteTag","openModal","tagModal","tempTagArr","chooseTag","selectedTagIds","selectedIds","hideModal","nextstep","publicPaperPage","privatePaperPage","publicQuestionPage","privateQuestionPage","publicPaperTagList","privatePaperTagList","publicQuestionTagList","privateQuestionTagList","getPaperPublic","publicPaperMore","morePaperPublic","getPaperPrivate","privatePaperMore","morePaperPrivate","newPaperTag","addPaperTagName","addPaperTag","deletePaperTag","getQuestionPublic","publicQuestionMore","moreQuestionPublic","getQuestionPrivate","privateQuestionMore","moreQuestionPrivate","newQuestionTag","addQuestionTagName","addQuestionTag","deleteQuestionTag","checkTagType","$compile","handleFileSelect","uploadProgress","lengthComputable","percentComplete","round","loaded","total","$apply","progress","loadedProgress","tip","f","files","formData","FormData","toastr","xhr","XMLHttpRequest","upload","addEventListener","send","onreadystatechange","readyState","wordUrl","responseText","paper","questions","questionObj","qDigest","mid","stem","stems","k","titList","paperStructJson","ans","toTop","animate","scrollTop","assist","assistModal","require","wordUpload","confirmAssist","applyExplain","resourcesName","resourcesUrl","getPaperData","$detail","$dt","dt_top","each","_top","height","showQrcode","hiddenQrcode","shareModal","myModal","obtainPaper","showShareBtn","childIndex","shareModalBox","goToShareList","shareQuestion","showShareBtnQid","cancelShare","confirmShare","noticeTime","sharingId","yesSure","goods","goodsStatus","sharingStatus","handle","disable","backUrl","doSomething","questionsNum","objNumber","subNumber","questionsScore","objScore","subScore","isQuestionBank","download","workId","workStatus","workstatus","searchObj","finishWork","workerStatus","showChooseTimeBox","chooseTimeShow","classlistOwn","classlistPublic","chooseClassId","revoke","isRevoke","noRevoke","classInfo","floor","deleteStudents","addStudents","setting","getCurrentTime","userCheck","isAll","getPaperList","getGoodPaperList","goodsPaperlist","searchPaper","pKeyup","keycode","event","history","go","getClassData","getClassApi","loadMore","searchClass","page","getMoreClass","cKeyup","checkedPaper","checked","unchecked","userUnchecked","classCheck","makeList","isall","isorder","isOrder","issee","isSee","isjoin","isJoin","correctService","baseInfo","paperQuestions","subjectiveQuestions","objectiveQuestions","currentQuestion","currentStudent","currentStudentIndex","corrected","uncorrected","composites","tixus","startCorrect","isShowQuestionInfo","finalScore","userinfo","messageType","studentSort","student","getStudentQidInfo","then","submitTime","answerDuration","correct","correctTime","isRight","correctType","createTime","updateTime","isDisplayText","textArr","getWorkBaseInfo","unlimited","preview","currentSubjectiveIndex","tixu","parentId","parentTixu","ques","findObjInArray","child","parent","getCorrectInfoByqid","isDefined","showTextarea","removeTextarea","tindex","submitAnswer","siblings","end","hide","playAudio","$target","audioPlayer","timeMonitor","play","duration","text","remain","uploadPic","form","createElement","setAttribute","uploadFileInput","append","on","file","fd","ajax","AcitveXObject","Error","teacherCorrectImg","ii","choices","teacherCorrectInfo","qOrder","correctedFlag","submitText","submitScore","maxscore","confirmScore","$confirmBtn","selectQuestion","showMiddle","$middle","changeMessageType","finishCorrect","popupBox","bodyWidth","width","bodyHeight","left","top","changeWorkStatus","getOneQuestionCorrectInfo","prevSub","sort_list","eq","nextSub","prevUser","nextUser","toggleQuestionInfo","selectUser","zoomImg","src","replace","overLay","degree","transform","-webkit-transform","-moz-transform","$interval","getInfo","editName","editNumber","numberModal","validate","editType","getPicCaptcha","validatePwd","setTimer","timer","getCaptcha","phoneCaptcha","newPhone","isRegister","newMail","confirmEdit","phonePwd","mailPwd","newAccount","getTeacherTag","teacherTags","courseTags","childList","editPhoto","modalGrade","gradeModal","choosenTagIds","chooseTagIds","parentTagId","tagIdx","parentIdx","modalCourse","choosenCourseIds","chooseCourseIds","CourseIdx","unique","tempArr","tempArrIdx","newPassword","oldPassword","md5oldPwd","md5newPwd","oldpassword","newpassword","myFilter","filter","isArray","result","isUndefined","delimiter","isString","str","arrEntities","lt","gt","nbsp","amp","quot","all","t","timeNum","time","date","sec","$sce","trustAsHtml","wordwise","max","tail","lastspace","lastIndexOf","myService","qrcode","render","correctLevel","sco","ownerTid","classes","showShareQuestionBox","imgArr","mContent","match","startIndex","endIndex","resolves","resolveToArray","qResolve","tools","getKeys","list","min","range","random","directive","restict","link","scope","attrs","update","userQuesList","questionList","scoreList","highcharts","exporting","enabled","chart","title","xAxis","categories","yAxis","tooltip","crosshairs","shared","plotOptions","series","color","allWorkList","template","$stat","keyList","isObjQues","options","selectNum","qAnswer","subtitle","crosshair","transclude","localWork","selectTag","paperInfo","localPaperName","localPaper","localStems","localTest","testTagList","selectedTestTagIds","selectTestTag","testTip","forward","$this","pinput","jumpOrder","innerHTML","$items","_this","qtype","word","msg","um","UM","getEditor","ready","setContent","uploader","plupload","Uploader","browse_button","file_data_name","filters","mime_types","extensions","prevent_duplicates","multipart","init","bind","start","percent","resp","doctype","is_exist","md5","restrict","api","correctPromise","q","studentList2","sendAll","property"],"mappings":"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","file":"app.min.js","sourcesContent":["// JavaScript Document\r\nvar app = angular.module('teacherApp', ['ngRoute', 'myServices', 'myFilter', 'ngCookies']);\r\n//\r\nvar api_url = \"http://115.29.177.200:8080\";\r\nvar withoutToken = {\r\n  // PUT: [api_url + '/teacher', api_url + '/login', api_url + '/user/activate/email'],\r\n  // GET: [api_url + '/captcha'],\r\n  // PATCH: [api_url + '/user/reset/password', api_url + '/user/activate']\r\n  POST: [api_url + '/login'],\r\n  GET: [api_url + '/image/code']\r\n};\r\n\r\n//\r\napp.config(['$filterProvider', '$routeProvider', '$httpProvider', '$sceDelegateProvider', function($filterProvider, $routeProvider, $httpProvider, $sceDelegateProvider) {\r\n  //\r\n  $routeProvider.when('/login', {\r\n    templateUrl: './views/login/login.html'\r\n  }); //\r\n  $routeProvider.when('/register', {\r\n    templateUrl: './views/register/register.html'\r\n  }); //\r\n  $routeProvider.when('/prompt', {\r\n    templateUrl: './views/validate/prompt.html'\r\n  });\r\n  $routeProvider.when('/validation', {\r\n    templateUrl: './views/validate/validation.html'\r\n  });\r\n  $routeProvider.when('/activate', {\r\n    templateUrl: './views/validate/activate.html'\r\n  }); //\r\n  $routeProvider.when('/sendmail', {\r\n    templateUrl: './views/forgot/sendMail.html'\r\n  }); //\r\n  $routeProvider.when('/tips', {\r\n    templateUrl: './views/forgot/tips.html'\r\n  });\r\n  $routeProvider.when('/repassword', {\r\n    templateUrl: './views/forgot/repassword.html'\r\n  }); //\r\n  $routeProvider.when('/validate', {\r\n    templateUrl: './views/forgot/validate.html'\r\n  }); //\r\n  $routeProvider.when('/index', {\r\n    templateUrl: './views/index/index.html'\r\n  }); //\r\n  $routeProvider.when('/class/list', {\r\n    templateUrl: './views/class/list.html'\r\n  }); //\r\n  $routeProvider.when('/class/public', {\r\n    templateUrl: './views/class/public.html'\r\n  }); //\r\n  $routeProvider.when('/class/live', {\r\n    templateUrl: './views/class/live.html'\r\n  }); //\r\n  $routeProvider.when('/class/create', {\r\n    templateUrl: './views/class/create.html'\r\n  }); //\r\n  $routeProvider.when('/class/createSuccess/:cid', {\r\n    templateUrl: './views/class/createSuccess.html'\r\n  }); //\r\n  $routeProvider.when('/class/members/:cid', {\r\n    templateUrl: './views/class/members.html'\r\n  }); //\r\n  $routeProvider.when('/class/blacklist/:cid', {\r\n    templateUrl: './views/class/blacklist.html'\r\n  }); //\r\n  $routeProvider.when('/class/represent/:cid', {\r\n    templateUrl: './views/class/represent.html'\r\n  }); //\r\n  $routeProvider.when('/class/record/:cid', {\r\n    templateUrl: './views/class/record.html'\r\n  }); //\r\n  $routeProvider.when('/class/result/:cid/:wid', {\r\n    templateUrl: './views/class/result.html'\r\n  }); //\r\n  $routeProvider.when('/class/modify/:cid', {\r\n    templateUrl: './views/class/modify.html'\r\n  }); //\r\n  $routeProvider.when('/class/permission/:cid', {\r\n    templateUrl: './views/class/permission.html'\r\n  }); //\r\n  $routeProvider.when('/class/questionbank/:cid', {\r\n    templateUrl: './views/class/questionbank.html'\r\n  }); //\r\n  $routeProvider.when('/class/personinfo/:cid/:uid', {\r\n    templateUrl: './views/class/personinfo.html'\r\n  }); //\r\n  $routeProvider.when('/paper/list/:type', {\r\n    templateUrl: './views/paper/list.html'\r\n  }); //\r\n  $routeProvider.when('/paper/public', {\r\n    templateUrl: './views/paper/public.html'\r\n  }); // \r\n  $routeProvider.when('/paper/publish/:pid/:gid', {\r\n    templateUrl: './views/paper/publish.html'\r\n  }); //\r\n  $routeProvider.when('/paper/name', {\r\n    templateUrl: './views/paper/name.html'\r\n  }); //\r\n  $routeProvider.when('/paper/tag', {\r\n    templateUrl: './views/paper/tag.html'\r\n  }); //\r\n  $routeProvider.when('/paper/name/:pid', {\r\n    templateUrl: './views/paper/name.html'\r\n  }); //\r\n  $routeProvider.when('/paper/input/:pid', {\r\n    templateUrl: './views/paper/input.html'\r\n  }); //\r\n  $routeProvider.when('/paper/edit/:pid', {\r\n    templateUrl: './views/paper/edit.html'\r\n  }); //\r\n  $routeProvider.when('/paper/editor/:pid', {\r\n    templateUrl: './views/paper/editor.html'\r\n  }); //\r\n  $routeProvider.when('/paper/preview/:pid', {\r\n    templateUrl: './views/paper/preview.html'\r\n  }); //\r\n  $routeProvider.when('/paper/wxpreview/:pid', {\r\n    templateUrl: './views/paper/wxPreview.html'\r\n  }); //\r\n  $routeProvider.when('/paper/goodspreview/:pid/:gid', {\r\n    templateUrl: './views/paper/goodsPreview.html'\r\n  }); //\r\n  $routeProvider.when('/paper/complete/:pid', {\r\n    templateUrl: './views/paper/complete.html'\r\n  }); //\r\n  $routeProvider.when('/paper/export/:pid', {\r\n    templateUrl: './views/paper/export.html'\r\n  });\r\n  $routeProvider.when('/work/list', {\r\n    templateUrl: './views/work/list.html'\r\n  }); //\r\n  $routeProvider.when('/work/arrange', {\r\n    templateUrl: './views/work/arrange.html'\r\n  }); //\r\n  $routeProvider.when('/work/arrange/:pid/:gid', {\r\n    templateUrl: './views/work/arrange.html'\r\n  }); //\r\n  $routeProvider.when('/work/detail/:wid', {\r\n    templateUrl: './views/work/detail.html'\r\n  }); //\r\n  $routeProvider.when('/work/correct/:workId', {\r\n    templateUrl: './views/work/correct.html'\r\n  }); //\r\n  $routeProvider.when('/setting', {\r\n    templateUrl: './views/setting/setting.html'\r\n  }); //\r\n  $routeProvider.when('/password', {\r\n    templateUrl: './views/setting/password.html'\r\n  }); //\r\n  $routeProvider.when('/account', {\r\n    templateUrl: './views/setting/account.html'\r\n  }); //\r\n  $routeProvider.otherwise({\r\n    redirectTo: '/index'\r\n      // templateUrl: './views/index/index.html'\r\n  });\r\n\r\n  //http\r\n  $httpProvider.interceptors.push('myInterceptor');\r\n  //http headers\r\n  // $httpProvider.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\r\n  //\r\n  $sceDelegateProvider.resourceUrlWhitelist(['self', '**']);\r\n}]);\r\n\r\n\r\n//  \r\napp.factory('myInterceptor', ['$rootScope', '$cookieStore', function($rootScope, $cookieStore) {\r\n  var interceptor = {\r\n    'request': function(req) {\r\n      if ($cookieStore.get(\"user\")) {\r\n        var token = $cookieStore.get(\"user\").token;\r\n      };\r\n      if (angular.isObject(req.url)) {\r\n        req.url = req.url.url;\r\n      }\r\n      var url = req.url.split('?');\r\n      if (req.url.indexOf(api_url) !== -1 && token) {\r\n        if (withoutToken[req.method]) {\r\n          var arr = withoutToken[req.method];\r\n          for (var i = 0; i < arr.length; i++) {\r\n            if (arr[i] != url[0]) {\r\n              if (req.url.indexOf(\"?token=\") == -1) {\r\n                if (url.length == 2) {\r\n                  req.url = req.url + '&token=' + token;\r\n                } else {\r\n                  req.url = req.url + '?token=' + token;\r\n                }\r\n              }\r\n            }\r\n          }\r\n        } else {\r\n          //  token\r\n          if (url.length == 2) {\r\n            req.url = req.url + '&token=' + token;\r\n          } else if (url.length == 1) {\r\n            req.url = req.url + '?token=' + token;\r\n          }\r\n        }\r\n\r\n      }\r\n\r\n      return req;\r\n    },\r\n    'requestError': function(reqErr) {\r\n      // console.log(reqErr)\r\n      return reqErr;\r\n    },\r\n    'response': function(response) {\r\n      if (angular.isObject(response.data)) {\r\n        var status = response.data.status;\r\n        if (status === 0) {\r\n          response.data = response.data.data;\r\n          response.data.status = status;\r\n        } else if(status === 2) {\r\n          response.data = response.data.data;\r\n          response.data.status = status;\r\n        } else {\r\n          alert(response.data.info);\r\n        }\r\n      }\r\n      return response;\r\n    },\r\n  };\r\n  return interceptor;\r\n}]);\r\n\r\n//\r\napp.run(['$rootScope', '$location', '$window', \"$cookieStore\", function($rootScope, $location, $window, $cookieStore) {\r\n  //DOM\r\n  $rootScope.$on('$viewContentLoaded', function() {\r\n    $rootScope.location = $location.path();\r\n  });\r\n  /*  stevensunqi */\r\n  $rootScope.$on(\"$routeChangeStart\", function() {\r\n    var user = $cookieStore.get(\"user\");\r\n    if (user == undefined || typeof user != \"object\") {\r\n      $location.path(\"/login\");\r\n    }\r\n  });\r\n\r\n}])\r\n\r\n//\r\napp.controller('login', ['$scope', '$http', '$location', '$rootScope', '$cookies', 'mxxServices', function($scope, $http, $location, $rootScope, $cookies, mxxServices) {\r\n  /*2016/03/07   sunqisteven */\r\n  /*!//zya!*/\r\n  $cookies.remove(\"user\");\r\n\r\n  //cookie   user\r\n  $scope.pass = $cookies.getObject(\"pass\");\r\n\r\n  $scope.refresh = function() {\r\n    $http.get(api_url + \"/image/code?w=100&h=40\")\r\n      .success(function(data) {\r\n        $scope.image = data.image;\r\n        $scope.key = data.codeKey;\r\n      })\r\n  };\r\n\r\n  //\r\n  $scope.refresh();\r\n\r\n  //\r\n  var url = \" https://open.weixin.qq.com/connect/qrconnect?appid=wxf305ea0876e9955e&redirect_uri=http%3A%2F%2Fwww.maixuexi.cn%2Fteacher%2F&response_type=code&scope=snsapi_login&state=WeChatScanCodeEntry#wechat_redirect\";\r\n  mxxServices.loginQrcode($(\"#wxQrcode\"), url);\r\n\r\n  //\r\n  // $scope.isRemember = true;\r\n  // $scope.remember = function() {\r\n  //   $scope.isRemember = !$scope.isRemember;\r\n  // };\r\n\r\n  // if ($scope.isRemember && $scope.pass) {\r\n  if ($scope.pass) {\r\n    $scope.email = $scope.pass.email;\r\n    $scope.password = $scope.pass.password;\r\n  };\r\n\r\n  //enter\r\n  // document.onkeydown = function(ev) {\r\n  //   var ev = ev || window.ev;\r\n  //   if (ev.keyCode && ev.which == 13) {\r\n  //     $scope.submit();\r\n  //   }\r\n  // };\r\n\r\n  //\r\n  var accountExp = /^[a-zA-Z]\\w+$/,\r\n    phoneExp = /^1[34578]\\d{9}$/,\r\n    mailExp = /^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$/;\r\n\r\n  $scope.submit = function() {\r\n    if (!$scope.email || !$scope.password || !$scope.captcha) {\r\n      alert(\"!\");\r\n      return;\r\n    }\r\n\r\n    //md5\r\n    $scope.md5Pwd = hex_md5($scope.password);\r\n    $scope.md5Pwd = $scope.md5Pwd.split('');\r\n    $scope.md5Pwd[5] = $scope.password.charAt(0);\r\n    $scope.md5Pwd[10] = $scope.password.charAt(1);\r\n    $scope.md5Pwd[15] = $scope.password.charAt(2);\r\n\r\n    var obj = {\r\n      \"clientType\": 1,\r\n      \"userType\": 1,\r\n      \"password\": $scope.md5Pwd.join(''),\r\n      \"code\": $scope.captcha,\r\n      \"codeKey\": $scope.key\r\n    };\r\n\r\n    if (mailExp.test($scope.email)) {\r\n      obj.email = $scope.email;\r\n    } else if (phoneExp.test($scope.email)) {\r\n      obj.phone = $scope.email;\r\n    } else if (accountExp.test($scope.email)) {\r\n      obj.account = $scope.email;\r\n    } else {\r\n      alert('!');\r\n      return;\r\n    }\r\n    $http.post(api_url + \"/login\", obj).success($scope.callback)\r\n  }\r\n\r\n  // \r\n  $scope.callback = function(data) {\r\n    if (data.status == 1) {\r\n      $(\"#email\").focus();\r\n      $scope.refresh();\r\n      return;\r\n    } else if (data.status == 2) {\r\n      $scope.captcha = '';\r\n      $(\"#captcha\").focus();\r\n      $scope.refresh();\r\n      return;\r\n    } else if (data.status == 0) {\r\n      $scope.tempToken = data.token;\r\n      $scope.uid = data.uid;\r\n      if (data.school && data.school.length == 1) {\r\n        $http.post(api_url + '/login/in', {\r\n          \"sid\": data.school[0].sid,\r\n          \"userType\": 1,\r\n          \"token\": data.token,\r\n          \"uid\": data.uid\r\n        }).success(function(res) {\r\n          if (!res.status) {\r\n            if (res.voucher) {\r\n              window.location.href = \"http://www.maixuexi.cn/completion.html?tid=\" + res.tid + \"&voucher=\" + res.voucher;\r\n            } else {\r\n              // document.onkeydown = null;\r\n              //\r\n              $scope.loginTime = new Date().getTime();\r\n              $cookies.put(\"loginTime\", $scope.loginTime);\r\n              var cookieDate = {};\r\n              cookieDate.sid = res.schoolId;\r\n              cookieDate.uid = res.uid;\r\n              cookieDate.tid = res.tid;\r\n              cookieDate.token = res.token;\r\n              cookieDate.email = res.email;\r\n              cookieDate.phone = res.phone;\r\n              cookieDate.account = res.account;\r\n              cookieDate.schoolName = res.schoolName;\r\n              cookieDate.photo = res.photo;\r\n\r\n              $cookies.putObject(\"user\", cookieDate);\r\n              if ($scope.isRemember) {\r\n                var expireDate = new Date();\r\n                expireDate.setDate(expireDate.getDate() + 30); //cookie30\r\n                $cookies.putObject(\"pass\", { 'email': $scope.email, 'password': $scope.password }, { 'expires': expireDate });\r\n              } else {\r\n                $cookies.remove(\"pass\");\r\n              }\r\n\r\n              //\r\n              $location.path(\"index\");\r\n            }\r\n          }\r\n        })\r\n      } else if (data.school && data.school.length > 1) {\r\n        $scope.schoolList = data.school;\r\n      }\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.selected = function(id) {\r\n    $scope.chooseSid = id;\r\n  }\r\n  $scope.confirm = function() {\r\n    if (!$scope.chooseSid) {\r\n      alert('!');\r\n      return;\r\n    }\r\n    $http.post(api_url + '/login/in', {\r\n      \"sid\": $scope.chooseSid,\r\n      \"userType\": 1,\r\n      \"token\": $scope.tempToken,\r\n      \"uid\": $scope.uid\r\n    }).success(function(res) {\r\n      if (!res.status) {\r\n        if (res.voucher) {\r\n          window.location.href = \"http://www.maixuexi.cn/completion.html?tid=\" + res.tid + \"&voucher=\" + res.voucher;\r\n        } else {\r\n          // document.onkeydown = null;\r\n          //\r\n          $scope.loginTime = new Date().getTime();\r\n          $cookies.put(\"loginTime\", $scope.loginTime);\r\n\r\n          var cookieDate = {};\r\n          cookieDate.sid = res.schoolId;\r\n          cookieDate.uid = res.uid;\r\n          cookieDate.tid = res.tid;\r\n          cookieDate.token = res.token;\r\n          cookieDate.email = res.email;\r\n          cookieDate.phone = res.phone;\r\n          cookieDate.account = res.account;\r\n          cookieDate.schoolName = res.schoolName;\r\n          cookieDate.teacherName = res.teacherName;\r\n          $cookies.putObject(\"user\", cookieDate);\r\n          if ($scope.isRemember) {\r\n            var expireDate = new Date();\r\n            expireDate.setDate(expireDate.getDate() + 30); //cookie30\r\n            $cookies.putObject(\"pass\", { 'email': $scope.email, 'password': $scope.password }, { 'expires': expireDate });\r\n          } else {\r\n            $cookies.remove(\"pass\");\r\n          }\r\n\r\n          //\r\n          $location.path(\"index\");\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n}]);\r\n\r\n//\r\napp.controller('index', ['$scope', '$http', '$location', '$rootScope', '$routeParams', '$filter', '$cookieStore', function($scope, $http, $location, $rootScope, $routeParams, $filter, $cookieStore) {\r\n  $scope.userInfo = $cookieStore.get(\"user\");\r\n  $scope.loginTime = $cookieStore.get(\"loginTime\");\r\n\r\n  if ($scope.userInfo.tid == 0) {\r\n    //\r\n    $rootScope.activateUid = $scope.userInfo.uid;\r\n    $rootScope.ishidden = 1;\r\n    $location.path(\"register\");\r\n  };\r\n\r\n  //url\r\n  $scope.currentPage = $location.search().currentPage;\r\n\r\n  if (!$scope.currentPage) {\r\n    $scope.currentPage = 1;\r\n  }\r\n\r\n  //\r\n  if ($scope.currentPage == 1) {\r\n    $(\".home\").css(\"display\", \"none\");\r\n  }\r\n\r\n  $http.get(api_url + \"/teacher/report\")\r\n    .success(function(data) {\r\n      if (!data.status) {\r\n        $scope.classesInfo = data.class;\r\n        $scope.worksInfo = data.work;\r\n        $scope.papersInfo = data.testPaper;\r\n      }\r\n    });\r\n\r\n  $scope.pageSize = 10; //\r\n  $scope.pageLength = 7; //7 \r\n  $scope.offset = ($scope.pageLength + 1) / 2;\r\n  $scope.getData = function() {\r\n    $http.get(api_url + \"/teacher/work/recently?page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          $scope.worklist = data.workList;\r\n\r\n          for (var i = 0; i < $scope.worklist.length; i++) {\r\n            if ($scope.worklist[i].avgScore) {\r\n              $scope.worklist[i].avgScore = $scope.worklist[i].avgScore.toString();\r\n              var index = $scope.worklist[i].avgScore.indexOf('.');\r\n              if (index != -1) {\r\n                $scope.worklist[i].avgScore = $scope.worklist[i].avgScore.substring(0, index + 3);\r\n              }\r\n            }\r\n          }\r\n\r\n          $scope.currentPage = Number($scope.currentPage);\r\n\r\n          $scope.count = data.count;\r\n          //  \r\n          $scope.num = Math.ceil($scope.count / $scope.pageSize);\r\n          //\r\n          if ($scope.currentPage == $scope.num) {\r\n            $(\".final\").css(\"display\", \"none\");\r\n          }\r\n\r\n          $scope.pageNums = [];\r\n\r\n          if ($scope.num > 1) { //\r\n            if ($scope.currentPage >= $scope.offset) {\r\n              if ($scope.currentPage + $scope.offset < $scope.num) {\r\n                for (var i = $scope.currentPage - $scope.offset + 1; i < $scope.currentPage + $scope.offset; i++) {\r\n                  $scope.pageNums.push(i);\r\n                }\r\n              } else if ($scope.num >= $scope.pageLength) {\r\n                for (var i = $scope.num - $scope.pageLength; i < $scope.num; i++) {\r\n                  $scope.pageNums.push(i);\r\n                }\r\n              } else {\r\n                for (var i = 0; i < $scope.num; i++) {\r\n                  $scope.pageNums.push(i);\r\n                }\r\n              }\r\n            } else {\r\n              if ($scope.num < $scope.pageLength) {\r\n                for (var i = 0; i < $scope.num; i++) {\r\n                  $scope.pageNums.push(i);\r\n                }\r\n              } else {\r\n                for (var i = 0; i < $scope.pageLength; i++) {\r\n                  $scope.pageNums.push(i);\r\n                }\r\n              }\r\n            }\r\n          } else {\r\n            $(\".final\").css(\"display\", \"none\");\r\n            $(\".home\").css(\"display\", \"none\");\r\n          }\r\n        }\r\n      });\r\n  };\r\n\r\n  $scope.getData();\r\n\r\n  //\r\n  $scope.skip = function($event) {\r\n    if ($event.target.className.indexOf(\"current\") != -1) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n}])\r\n\r\n//\r\napp.controller(\"classlist\", ['$rootScope', '$scope', '$location', '$http', '$cookieStore', '$timeout', 'mxxServices', function($rootScope, $scope, $location, $http, $cookieStore, $timeout, mxxServices) {\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 9; //\r\n  $scope.classTypeName = ['','','']\r\n\r\n  // $scope.getData = function() {\r\n  //   $http.get(api_url + \"/teacher/class/owner?tid=\" + $scope.tid + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n  //     .success(function(data) {\r\n  //       if (!data.status) {\r\n  //         $scope.count = data.count;\r\n  //         $scope.priviteClasses = data.classList;\r\n  //         if ($scope.count == 0) {\r\n  //           $scope.num = 1;\r\n  //         } else {\r\n  //           $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n  //         }\r\n  //       }\r\n\r\n  //     })\r\n  // };\r\n  $scope.getData = function() {\r\n    $http.get(api_url + \"/teacher/class/list?tid=\" + $scope.tid + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          $scope.count = data.count;\r\n          $scope.priviteClasses = data.classList;\r\n          // console.log($scope.priviteClasses);\r\n          for (var i=0; i<$scope.priviteClasses.length; i++){\r\n            if($scope.priviteClasses[i]['className'].length > 16){\r\n              $scope.priviteClasses[i]['shortClassName'] = $scope.priviteClasses[i]['className'].substring(0,16)+'...';\r\n            } else {\r\n              $scope.priviteClasses[i]['shortClassName'] = $scope.priviteClasses[i]['className']\r\n            }\r\n          }\r\n          // console.log($scope.priviteClasses);\r\n          if ($scope.count == 0) {\r\n            $scope.num = 1;\r\n          } else {\r\n            $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n          }\r\n        }\r\n\r\n      })\r\n  };\r\n  //\r\n  $scope.linkToClass = function(cid) {\r\n    //   \r\n    $location.path(\"class/members/\" + cid)\r\n  };\r\n\r\n  //\r\n  $scope.search = function() {\r\n    if (!$scope.className) {\r\n      return;\r\n    }\r\n    $scope.currentPage = 1;\r\n    $http.put(api_url + \"/teacher/class/search?page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize, {\r\n      \"className\": $scope.className,\r\n      \"type\": 2,\r\n      \"tid\": $scope.tid\r\n    }).success(function(data) {\r\n      $scope.className = '';\r\n      $scope.count = data.count;\r\n      if ($scope.count == 0) {\r\n        alert(\"\")\r\n      } else {\r\n        $scope.priviteClasses = data.classList;\r\n        $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n      }\r\n    })\r\n  };\r\n\r\n  document.onkeydown = function(ev) {\r\n    var ev = ev || window.ev;\r\n    if (ev.keyCode && ev.which == 13) {\r\n      $scope.search();\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.mouse = {\r\n    mouseover: function() {\r\n      $(\".handle-menu\").css(\"display\", \"block\")\r\n    },\r\n    mouseout: function() {\r\n      $(\".handle-menu\").css(\"display\", \"none\")\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.isAllVisible = false; //\r\n  $scope.visible = {};\r\n  $scope.allCheck = function() {\r\n    if (!$scope.isAllVisible) {\r\n      $scope.isAllVisible = true;\r\n      // $scope.visible\r\n      angular.forEach($scope.classlist, function(value, key, array) {\r\n        $scope.visible[value.cid] = true;\r\n      })\r\n    } else {\r\n      $scope.isAllVisible = false;\r\n      $scope.visible = {};\r\n    }\r\n  };\r\n\r\n  $scope.oneCheck = function(cid) {\r\n    if ($scope.visible[cid]) {\r\n      delete $scope.visible[cid];\r\n      $scope.isAllVisible = false;\r\n    } else {\r\n      $scope.visible[cid] = true;\r\n      var count = 0;\r\n      for (key in $scope.visible) {\r\n        count++;\r\n      }\r\n      if (count == $scope.classlist.length) {\r\n        $scope.isAllVisible = true;\r\n      }\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.delete = function() {\r\n    var arr = [];\r\n    for (key in $scope.visible) {\r\n      arr.push(key)\r\n    }\r\n    if (arr.length == 0) {\r\n      alert(\"!\");\r\n      return;\r\n    } else {\r\n      var config = {\r\n        method: \"DELETE\",\r\n        url: api_url + '/class',\r\n        data: { \"cid\": arr },\r\n        headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n      };\r\n      $http(config).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.getData();\r\n          alert(\"!\")\r\n        }\r\n      })\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.change = function() {\r\n    var arr = [];\r\n    for (key in $scope.visible) {\r\n      arr.push(key)\r\n    }\r\n    if (arr.length != 1) {\r\n      alert(\"!\");\r\n      return;\r\n    } else {\r\n      $location.path(\"class/modify/\" + arr[0])\r\n    }\r\n  }\r\n\r\n}]);\r\n\r\n//\r\napp.controller('publicClass', ['$scope', '$http', 'mxxServices', '$cookieStore', '$location', function($scope, $http, mxxServices, $cookieStore, $location) {\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  //\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 6; //\r\n\r\n  // $scope.getData = function() {\r\n  //   $http.get(api_url + \"/teacher/class/public?tid=\" + $scope.tid + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n  //     .success(function(data) {\r\n  //       if (!data.status) {\r\n  //         $scope.count = data.count;\r\n  //         $scope.publicClasses = data.classList;\r\n  //         if ($scope.count == 0) {\r\n  //           $scope.num = 1;\r\n  //           $(\".body\").html('<p class=\"tips\">~~~</p>');\r\n  //         } else {\r\n  //           $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n  //         }\r\n  //       }\r\n\r\n  //     })\r\n  // };\r\n  $scope.getData = function() {\r\n    $http.get(api_url + \"/teacher/class/pending?tid=\" + $scope.tid + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          $scope.count = data.count;\r\n          $scope.publicClasses = data.classList;\r\n          if ($scope.count == 0) {\r\n            $scope.num = 1;\r\n            $(\".body\").html('<p class=\"tips\">~~~</p>');\r\n          } else {\r\n            $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n          }\r\n        }\r\n\r\n      })\r\n  };\r\n\r\n  //\r\n  $scope.isAgree = function(cid, $event) {\r\n    ($event.target.className) == \"agree\" ? ($scope.isagree = 1) : ($scope.isagree = 2);\r\n    $http.put(api_url + \"/class/teacher/reply\", {\r\n      \"tid\": parseInt($scope.tid),\r\n      \"cid\": parseInt(cid),\r\n      \"isAgree\": $scope.isagree\r\n    }).success(function(data) {\r\n      //\r\n      if ($scope.isagree == 1) {\r\n        $location.path(\"class/permission/\" + cid)\r\n      }\r\n      if ($scope.isagree == 2) {\r\n        //\r\n        $($event.target).parents(\".box\").remove();\r\n      }\r\n    })\r\n  }\r\n\r\n  //\r\n  $scope.linkToClass = function(cid, isAgree) {\r\n    if (isAgree === 1) {\r\n      //   \r\n      $location.path(\"class/permission/\" + cid)\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.changeCourse = function(isAgree, $event) {\r\n    if (isAgree === 1) {\r\n      $event.target.style.cursor = \"pointer\";\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.search = function($event) {\r\n    if (!$scope.className) {\r\n      return;\r\n    }\r\n    if ($event.keyCode && $event.which == 13) {\r\n      $scope.currentPage = 1;\r\n      $http.put(api_url + \"/teacher/class/search?page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize, {\r\n        \"className\": $scope.className,\r\n        \"type\": 1,\r\n        \"tid\": $scope.tid\r\n      }).success(function(data) {\r\n        $scope.className = '';\r\n        $scope.count = data.count;\r\n        if ($scope.count == 0) {\r\n          alert(\"\")\r\n        } else {\r\n          $scope.priviteClasses = data.classList;\r\n          $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n        }\r\n      })\r\n    }\r\n  };\r\n\r\n}]);\r\n\r\n\r\n// \r\napp.controller(\"classlive\",['$scope', '$http', 'mxxServices', '$cookieStore', '$location', function($scope, $http, mxxServices, $cookieStore, $location) {\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.token = $cookieStore.get(\"user\").token;\r\n  $scope.teacherName = $cookieStore.get(\"user\").teacherName;\r\n  // console.log($scope.token,$scope.teacherName);\r\n  // console.log($scope.token,$scope.teacherName);\r\n  //\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 10; //\r\n  // \r\n  // \r\n  $scope.liveStatusName = ['','','']\r\n  $scope.nowTime = Date.parse(new Date()) / 1000;\r\n  // console.log($scope.nowTime);\r\n  // \r\n  $scope.startTime = \"2017-01-01 00:00:00\";\r\n  $scope.endTime = \"2100-10-25 23:00:00\";\r\n  // \r\n  $scope.getData = function() {\r\n    $http.get(api_url + \"/teacher/class/live/time/list?startTime=\" + $scope.startTime + \"&endTime=\" + $scope.endTime + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          $scope.count = data.count;\r\n          $scope.liveTimeList = data.liveRoomList;\r\n          // 0-1-2-\r\n          for(var i=0; i < $scope.liveTimeList.length; i++){\r\n            $scope.startTimeOne = Date.parse($scope.liveTimeList[i]['startTime']) / 1000;\r\n            $scope.endTimeOne = Date.parse($scope.liveTimeList[i]['endTime']) / 1000;\r\n            if(($scope.nowTime>$scope.startTimeOne||$scope.nowTime==$scope.startTimeOne)&&($scope.nowTime < $scope.endTimeOne||$scope.nowTime == $scope.endTimeOne)){\r\n              $scope.liveTimeList[i]['liveStatus'] = 1;\r\n            } else if ($scope.nowTime<$scope.startTimeOne) {\r\n              $scope.liveTimeList[i]['liveStatus'] = 0;\r\n            } else if ($scope.nowTime > $scope.endTimeOne){\r\n              $scope.liveTimeList[i]['liveStatus'] = 2;\r\n            }\r\n          }\r\n          // console.log($scope.startTimeOne);\r\n          // console.log($scope.liveTimeList);\r\n          if ($scope.count == 0) {\r\n            $scope.num = 1;\r\n            $(\".body\").html('<p class=\"tips\">~~~</p>');\r\n          } else {\r\n            $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n          }\r\n        }\r\n\r\n      })\r\n  };\r\n\r\n  // \r\n  $scope.search = function() {\r\n    //\r\n    $scope.startTime = $(\"#startTime\").val();\r\n    //\r\n    $scope.endTime = $(\"#endTime\").val();\r\n\r\n    // console.log($scope.startTime);\r\n    // console.log($scope.endTime);\r\n    if ($scope.startTime&&$scope.endTime) {\r\n      $scope.currentPage = 1;\r\n      $scope.getData();\r\n    } else {\r\n      // $scope.getData();\r\n      alert('');\r\n      return;\r\n    }\r\n  };\r\n  // \r\n  $scope.configResource = function(timeId) {\r\n    alert('');\r\n  }\r\n\r\n  // \r\n  $scope.goToLive = function(roomId,liveStatus) {\r\n    // $scope.nickname = \"\";\r\n    if (!$scope.teacherName){\r\n      $scope.teacherName = \"Mike\";\r\n    }\r\n    if(liveStatus==1){\r\n      var teacherUrl = encodeURI('http://live.buka.tv/v4/'+roomId+'?room_id='+roomId+'&role=1&nickname='+$scope.teacherName+'&login_id='+$scope.tid+'&token='+$scope.token+'&client=1');\r\n      // console.log(teacherUrl);\r\n      window.open(teacherUrl);\r\n    } else {\r\n      alert('')\r\n    }\r\n  }\r\n\r\n}])\r\n\r\n\r\n//\r\napp.controller(\"createClass\", ['$scope', '$http', '$location', '$cookieStore', 'toolServices', function($scope, $http, $location, $cookieStore, toolServices) {\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.sid = $cookieStore.get(\"user\").sid;\r\n\r\n  //\r\n  $(\".create-password\").click(function() {\r\n    //\r\n    // $scope.password = Math.floor(Math.random() * 899999 + 100000).toString();\r\n    $scope.password = toolServices.getRandomNum(100000, 99999999) + ''; //\r\n    $(\".form-control.password\").val($scope.password);\r\n  });\r\n\r\n\r\n\r\n  //\r\n  $scope.validateOne = function() {\r\n    //200\r\n    if ($scope.classNumber > 200) {\r\n      alert(\"200!\");\r\n      return;\r\n    };\r\n    if ($scope.classNumber < 1) {\r\n      alert(\"1!\");\r\n      return;\r\n    };\r\n    if (isNaN($scope.classNumber - 1)) {\r\n      alert(\"!\");\r\n      return;\r\n    };\r\n  }\r\n  $scope.validateTwo = function() {\r\n    if ($scope.password) {\r\n      var reg = /^\\d{6,8}$/;\r\n      if (!reg.test($scope.password)) {\r\n        alert(\"6-8!\");\r\n        return;\r\n      }\r\n    };\r\n  }\r\n  //required\r\n  $scope.submit = function() {\r\n    //200\r\n    if ($scope.classNumber > 200) {\r\n      alert(\"200!\");\r\n      return;\r\n    };\r\n    if ($scope.classNumber < 1) {\r\n      alert(\"1!\");\r\n      return;\r\n    };\r\n    if (isNaN($scope.classNumber - 1)) {\r\n      alert(\"!\");\r\n      return;\r\n    };\r\n    if ($scope.password) {\r\n      var reg = /^\\d{6,8}$/;\r\n      if (!reg.test($scope.password)) {\r\n        alert(\"6-8!\");\r\n        return;\r\n      }\r\n    };\r\n    //140\r\n    if ($scope.classAnnounce && $scope.classAnnounce.length > 140) {\r\n      alert(\"140!\");\r\n      return;\r\n    }\r\n    var data = {\r\n      \"createTid\": parseInt($scope.tid),\r\n      \"className\": $scope.className,\r\n      \"maxNumber\": parseInt($scope.classNumber),\r\n      \"password\": $scope.password,\r\n      \"remarkName\": $scope.classAnnounce\r\n    };\r\n    data = JSON.stringify(data);\r\n    $http.post(api_url + '/class', data)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          alert(\"\")\r\n          $scope.cid = data.cid;\r\n          $location.path(\"/class/createSuccess/\" + $scope.cid)\r\n        }\r\n      })\r\n  }\r\n}])\r\n\r\n//\r\napp.controller(\"members\", ['$scope', '$rootScope', '$http', '$routeParams', '$cookieStore', \"$location\", 'mxxServices', function($scope, $rootScope, $http, $routeParams, $cookieStore, $location, mxxServices) {\r\n  $scope.cid = $routeParams.cid;\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 10; //\r\n  $scope.sid = $cookieStore.get(\"user\").sid;\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  //\r\n  mxxServices.getClassInfo($scope);\r\n\r\n  $scope.getData = function() {\r\n    $http.get(api_url + \"/class/student/list?cid=\" + $scope.cid + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          $scope.count = data.count;\r\n          $scope.userlist = data.studentList;\r\n          if ($scope.count == 0) {\r\n            $scope.num = 1;\r\n            $(\".student-list-body\").html('<p clasas=\"tips\" style=\"padding-top:40px;text-align:center;font-size:20px; color:#666;background-color:#ececec;\">!</p>')\r\n          } else {\r\n            $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n          }\r\n        }\r\n      })\r\n  };\r\n\r\n  //\r\n  mxxServices.showClass2WM($scope);\r\n\r\n  //\r\n  $scope.search = function() {\r\n    $scope.currentPage = 1;\r\n    $http.put(api_url + \"/class/student/search?page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize, {\r\n      \"studentName\": $scope.username,\r\n      \"cid\": parseInt($scope.cid)\r\n    }).success(function(data) {\r\n      if (!data.status) {\r\n        $scope.count = data.count;\r\n        if ($scope.count == 0) {\r\n          alert(\"\")\r\n        } else {\r\n          $scope.userlist = data.studentList;\r\n          $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n        }\r\n      }\r\n    })\r\n  };\r\n  //\r\n  $scope.alert = function(studentId) {\r\n    $(\".dialog_wrp\").css(\"display\", \"block\");\r\n    $(\".mask\").css(\"display\", \"block\")\r\n    $scope.confirm = function() {\r\n      if (!$scope.nickname) {\r\n        alert(\"!\");\r\n        return;\r\n      } else if ($scope.nickname.trim().length > 12) {\r\n        alert(\"12\")\r\n        return;\r\n      } else {\r\n        $http.put(api_url + \"/class/student\", {\r\n          \"cid\": parseInt($scope.cid),\r\n          \"studentId\": studentId,\r\n          \"remarkName\": $scope.nickname\r\n        }).success(function(data) {\r\n          $scope.nickname = ''; //\r\n          $(\".dialog_wrp\").css(\"display\", \"none\");\r\n          $(\".mask\").css(\"display\", \"none\")\r\n          $scope.getData();\r\n        })\r\n      }\r\n    }\r\n  };\r\n\r\n  $scope.cancel = function() {\r\n    $(\".dialog_wrp\").css(\"display\", \"none\");\r\n    $(\".mask\").css(\"display\", \"none\");\r\n\r\n  };\r\n\r\n  //\r\n  $scope.delete = function(studentId) {\r\n    $http.put(api_url + \"/class/student/blackList\", {\r\n      \"cid\": parseInt($scope.cid),\r\n      \"studentId\": studentId,\r\n      \"dataStatus\": -1 //-1:1:2:\r\n    }).success(function(data) {\r\n      alert(\"!\");\r\n      $scope.getData();\r\n    })\r\n\r\n  }\r\n\r\n  //\r\n  $scope.remove = function(studentId) {\r\n    $http.put(api_url + \"/class/student/blackList\", {\r\n      \"cid\": parseInt($scope.cid),\r\n      \"studentId\": studentId,\r\n      \"dataStatus\": 2\r\n    }).success(function(data) {\r\n      alert(\"!\");\r\n      $scope.getData();\r\n    })\r\n  };\r\n\r\n}])\r\n\r\n//\r\napp.controller('blacklist', ['$scope', '$http', '$location', '$routeParams', '$cookieStore', 'mxxServices', function($scope, $http, $location, $routeParams, $cookieStore, mxxServices) {\r\n  $scope.cid = $routeParams.cid;\r\n  $scope.sid = $cookieStore.get(\"user\").sid;\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 10; //\r\n\r\n  //\r\n  mxxServices.getClassInfo($scope);\r\n\r\n  $scope.getData = function() {\r\n    //\r\n    $http.get(api_url + \"/class/student/blackList?cid=\" + $scope.cid + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        $scope.count = data.count;\r\n        $scope.userlist = data.studentList;\r\n        if ($scope.count == 0) {\r\n          $scope.num = 1;\r\n        } else {\r\n          $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n        }\r\n      })\r\n  };\r\n  $scope.getData();\r\n\r\n  //\r\n  mxxServices.showClass2WM($scope);\r\n\r\n  //\r\n  $scope.remove = function(studentId) {\r\n    $http.put(api_url + \"/class/student/blackList\", {\r\n      \"cid\": parseInt($scope.cid),\r\n      \"studentId\": studentId,\r\n      \"dataStatus\": -1 //!\r\n    }).success(function(data) {\r\n      alert(\"!\");\r\n      $scope.getData();\r\n    })\r\n  };\r\n\r\n  $scope.alert = function(studentId) {\r\n    $(\".dialog_wrp\").css(\"display\", \"block\");\r\n    $scope.confirm = function() {\r\n      if (!$scope.nickname) {\r\n        alert(\"!\");\r\n        return;\r\n      } else {\r\n        $http.put(api_url + \"/class/student\", {\r\n          \"cid\": parseInt($scope.cid),\r\n          \"studentId\": studentId,\r\n          \"remarkName\": $scope.nickname\r\n        }).success(function(data) {\r\n          $scope.nickname = ''; //\r\n          alert(\"!\");\r\n          $(\".dialog_wrp\").css(\"display\", \"none\");\r\n          $scope.getData();\r\n        })\r\n      }\r\n    }\r\n  };\r\n  $scope.cancel = function() {\r\n    $(\".dialog_wrp\").css(\"display\", \"none\");\r\n  }\r\n}])\r\n\r\n\r\n//\r\napp.controller(\"createSuccess\", ['$scope', '$http', '$routeParams', '$cookieStore', 'mxxServices', function($scope, $http, $routeParams, $cookieStore, mxxServices) {\r\n  //\r\n  $scope.cid = $routeParams.cid;\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.sid = $cookieStore.get(\"user\").sid;\r\n  $http.get(api_url + \"/class/info?cid=\" + $scope.cid)\r\n    .success(function(data) {\r\n      $scope.className = data.className;\r\n      $scope.description = data.remarkName;\r\n      $scope.password = data.password;\r\n      $scope.classNumber = data.maxNumber;\r\n\r\n      mxxServices.showClass2WM($scope);\r\n      //\r\n      var imgCode = $(\"#imgCode\");\r\n      mxxServices.qrCode(imgCode, $scope.url);\r\n    })\r\n}])\r\n\r\n//\r\napp.controller(\"represent\", ['$scope', '$http', '$routeParams', '$cookieStore', '$timeout', 'mxxServices', function($scope, $http, $routeParams, $cookieStore, $timeout, mxxServices) {\r\n  $scope.cid = $routeParams.cid;\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n\r\n  //\r\n  mxxServices.showClass2WM($scope);\r\n\r\n  mxxServices.getClassInfo($scope);\r\n\r\n  //\r\n  $scope.getList = function() {\r\n    $http.get(api_url + \"/class/teacher/tutor?cid=\" + $scope.cid + \"&tid=\" + $scope.tid)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          $scope.monitorlist = data.tutorList;\r\n          if (data.count) {\r\n            $timeout(function() {\r\n              for (var i = 0; i < $scope.monitorlist.length; i++) {\r\n                var url = \"http://www.maixuexi.cn/student/#/my/tutor/\" + $scope.monitorlist[i].tutorId;\r\n                imgCode = $($(\".imgcode\")[i]);\r\n                if (imgCode.children()) {\r\n                  imgCode.empty();\r\n                }\r\n\r\n                mxxServices.qrCode(imgCode, url);\r\n              };\r\n            }, 500)\r\n          }\r\n        }\r\n\r\n      });\r\n  }\r\n  $scope.getList();\r\n\r\n  //\r\n  $scope.monitorCode = function() {\r\n    var rimgCode = $(\".imgcode\")\r\n    var len = rimgCode.length;\r\n    if (len >= 6) {\r\n      alert(\"!\");\r\n      return;\r\n    }\r\n    $http.post(api_url + \"/class/tutor\", {\r\n      \"cid\": parseInt($scope.cid)\r\n    }).success(function(res) {\r\n      $scope.getList();\r\n    })\r\n  };\r\n\r\n  //\r\n  $scope.unbindRepresent = function(tutorId, i) {\r\n    $http.put(api_url + \"/class/tutor/remove\", {\r\n      \"tutorId\": [tutorId]\r\n    }).success(function(data) {\r\n      if (!data.status) {\r\n        alert(\"!\");\r\n        $scope.getList();\r\n      }\r\n    })\r\n  }\r\n\r\n  //\r\n  $scope.deleteQrCode = function(tutorId, i) {\r\n    $http({\r\n      method: \"delete\",\r\n      url: api_url + '/class/tutor',\r\n      data: { \"tutorId\": [tutorId] },\r\n      headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n    }).success(function(data) {\r\n      if (!data.status) {\r\n        alert(\"!\");\r\n        $scope.getList();\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n}])\r\n\r\n//\r\n// \r\napp.controller(\"record\", ['$scope', '$http', '$routeParams', 'mxxServices', '$cookieStore', function($scope, $http, $routeParams, mxxServices, $cookieStore) {\r\n  $scope.cid = $routeParams.cid;\r\n  $scope.sid = $cookieStore.get(\"user\").sid;\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 10; //\r\n  mxxServices.getClassInfo($scope);\r\n  $scope.getData = function() {\r\n    if (!$scope.serachSuccess) {\r\n      $http.get(api_url + \"/work/class/list?cid=\" + $scope.cid + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n        .success(function(data) {\r\n          if (!data.status) {\r\n            $scope.count = data.count;\r\n            $scope.num = Math.ceil($scope.count / $scope.pageSize);\r\n            if ($scope.num == 0) {\r\n              $scope.num = 1;\r\n              $(\".student-list-body\").html('<p clasas=\"tips\" style=\"padding-top:40px;text-align:center;font-size:18px; color:#666;background-color:#ececec;\"><a href=\"#/work/arrange\" style=\"color:#000;font-size:20px;\"></a></p>')\r\n            }\r\n            $scope.worklist = data.workList;\r\n          }\r\n        })\r\n    } else {\r\n      $scope.searchData();\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.searchWork = function() {\r\n    if ($scope.searchName) {\r\n      $scope.currentPage = 1;\r\n      $scope.searchData();\r\n    }\r\n  }\r\n  $scope.searchData = function() {\r\n    $http.put(api_url + '/work/teacher/name?page=' + $scope.currentPage + \"&size=\" + $scope.pageSize, {\r\n      \"cid\": $scope.cid,\r\n      \"workName\": $scope.searchName\r\n    }).success(function(data) {\r\n      if (!data.status) {\r\n        $scope.serachSuccess = true;\r\n        $scope.count = data.count;\r\n        $scope.num = Math.ceil($scope.count / $scope.pageSize);\r\n        if ($scope.num == 0) {\r\n          $scope.num = 1;\r\n          $(\".student-list-body\").html('<p clasas=\"tips\" style=\"padding-top:40px;text-align:center;font-size:18px; color:#666;background-color:#ececec;\"></p>')\r\n        }\r\n        $scope.worklist = data.workList;\r\n      }\r\n    })\r\n  }\r\n\r\n  //\r\n  mxxServices.showClass2WM($scope);\r\n\r\n}])\r\n\r\n//\r\napp.controller(\"result\", ['$scope', '$http', '$routeParams', 'mxxServices', '$cookieStore', function($scope, $http, $routeParams, mxxServices, $cookieStore) {\r\n  $scope.cid = $routeParams.cid;\r\n  $scope.wid = $routeParams.wid; //id\r\n  $scope.sid = $cookieStore.get(\"user\").sid;\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 1000; //\r\n  mxxServices.getClassInfo($scope);\r\n  //\r\n  mxxServices.showClass2WM($scope);\r\n\r\n  $scope.showSingleTable = true;\r\n  $scope.load = false;\r\n  $scope.showStat = true;\r\n  $scope.showQuestionBox = false;\r\n  $scope.assignmentNow = false;\r\n\r\n  // \r\n  $scope.showSingleCountTable = function(type){\r\n    // console.log(type,$scope.showSingleTable);\r\n    if(type===1){\r\n      if(!$scope.showSingleTable){\r\n        return;\r\n      } else {\r\n        $scope.showSingleTable = false;\r\n        $scope.load = true;\r\n      }\r\n    } else if (type === 2){\r\n      if($scope.showSingleTable){\r\n        return;\r\n      } else {\r\n        $scope.showSingleTable = true;\r\n        $scope.load = false;\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  //\r\n  $http.get(api_url + \"/work/statistics?workId=\" + $scope.wid)\r\n    .success(function(data) {\r\n      $scope.wname = data.workName;\r\n      $scope.submitNum = data.submitNumber;\r\n      $scope.ansSeenTime = data.showAnswerType;\r\n      $scope.endTime = data.endTime;\r\n      $scope.maxScore = data.maxScore;\r\n      $scope.avgScore = data.avgScore;\r\n    });\r\n  //\r\n\r\n  //\r\n  //$scope.ranks=[{type:1,name:''},{type:2,name:''}];\r\n  $scope.typeList = [{ type: 1, name: '' }, { type: 2, name: '' }]\r\n  $scope.type = 1;\r\n  $scope.selected = function(type) {\r\n    $http.get(api_url + \"/work/rank?workId=\" + $scope.wid + \"&type=\" + $scope.type + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          $scope.userlist = data.rankList;\r\n        }\r\n      })\r\n  };\r\n\r\n  $scope.selected($scope.type);\r\n  // \r\n  $scope.questionTypeName = ['','',''];\r\n  // \r\n  $scope.questionAnswerName = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N'];\r\n  $scope.changeShowStatus = function(){\r\n    $scope.showStat = !$scope.showStat;\r\n    if(!$scope.showStat){\r\n      $http.get(api_url + \"/work/question/answer?workId=\" + $scope.wid)\r\n        .success(function(data) {\r\n          if (!data.status) {\r\n            $scope.worklist = data.workList;\r\n          } else{\r\n            alert(data.info);\r\n          }\r\n      }) \r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.checkStatus = ['',''];\r\n  // \r\n  $scope.showQuestion = function(qid,qType,qNumber){\r\n    $scope.showQuestionBox = true;\r\n    $scope.questionType = qType;\r\n    $scope.questionNumber = qNumber;\r\n    $scope.wrongStudentList = [];\r\n    // \r\n    $http.get(api_url + \"/work/question/student/situation?workId=\" + $scope.wid + \"&qid=\" + qid)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          $scope.studentList = data.studentList;\r\n          // console.log($scope.studentList);\r\n          $scope.questionScore = data.qScore;\r\n          if ($scope.questionType==1){\r\n            $scope.questionAnswer = data.answer; \r\n          }\r\n          // \r\n          // if ($scope.questionType == 1) {\r\n          //   for(var m = 0; m < $scope.questionAnswer.length; m++){\r\n          //     $scope.questionAnswer[m]\r\n          //     $scope.questionAnswerName[$scope.questionAnswer[m]]\r\n          //   }\r\n          // }\r\n          for(var i=0; i < $scope.studentList.length; i++ ){\r\n            var userScore = $scope.studentList[i].score;\r\n            var percentage = (userScore / $scope.questionScore)*100;\r\n            $scope.studentList[i]['percentage'] = percentage;\r\n            if($scope.studentList[i]['percentage'] < 80){\r\n              $scope.wrongStudentList = $scope.wrongStudentList.concat($scope.studentList[i]);\r\n            }\r\n          }\r\n          // console.log($scope.studentList);\r\n          // console.log($scope.wrongStudentList);\r\n          if($scope.wrongStudentList.length == 0){\r\n            $scope.showNoneStudent = true;\r\n          }\r\n        } else{\r\n          alert(data.info);\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  // \r\n  $scope.closeStudentBox = function(){\r\n    $scope.showQuestionBox = false;\r\n    $scope.assignmentNow = false;\r\n  }\r\n  // \r\n  $scope.assignmentWork = function(){\r\n    if($scope.showNoneStudent){\r\n      alert('');\r\n      return;\r\n    }\r\n    $scope.assignmentNow = true;\r\n    //\r\n    $http.get(api_url + \"/test/paper/teacher?page=1&size=99999\")\r\n      .success(function(data) {\r\n        if(!data.status){\r\n          $scope.paperlist = data.paperList;\r\n          // console.log($scope.paperlist);\r\n          for(var n = 0 ; n < $scope.paperlist.length; n++){\r\n            if($scope.paperlist[n]['paperName'].length > 14){\r\n              $scope.paperlist[n]['shortPaperName'] = $scope.paperlist[n]['paperName'].substring(0,14)+'...';\r\n            }\r\n          }\r\n          // console.log($scope.paperlist);\r\n        } else{\r\n          alert(data.info)\r\n        }\r\n      });\r\n\r\n    // \r\n    // $scope.classInfo = {};\r\n    // $scope.classInfo['cid'] = $scope.cid;\r\n    // $scope.classInfo['students'] = [];\r\n    $scope.students = [];\r\n    // \r\n    $http.get(api_url + \"/class/student/list?cid=\" + $scope.cid + \"&page=1&size=1000\")\r\n      .success(function(data) {\r\n        if(!data.status){\r\n          $scope.classStudent = data.studentList;\r\n          // console.log('2',$scope.classStudent);\r\n          for (var i=0; i < $scope.classStudent.length; i++){\r\n            var sourceStudent = $scope.classStudent[i]\r\n            var sourceStudentId = sourceStudent.studentId;\r\n            for(var y=0; y < $scope.wrongStudentList.length; y++){\r\n              var wrongStudent = $scope.wrongStudentList[y];\r\n              var wrongStudentId = wrongStudent.studentId;\r\n              if (sourceStudentId == wrongStudentId){\r\n                sourceStudent['isMake'] = 1;\r\n              } else {\r\n                sourceStudent['isMake'] = 0;\r\n              }\r\n              $scope.students.push(\r\n                {\r\n                  \"studentId\": sourceStudent.studentId,\r\n                  \"isMake\": sourceStudent.isMake\r\n                }\r\n              )\r\n            }\r\n          }\r\n        }else {\r\n          alert(data.info);\r\n        }\r\n      })\r\n\r\n    // console.log($scope.classStudent);\r\n    // console.log($scope.students);\r\n    // \r\n    $scope.cids = [\r\n      {\r\n        \"cid\": $scope.cid,\r\n        \"students\": $scope.students\r\n      }\r\n    ]\r\n    \r\n  }\r\n  // \r\n  $scope.returnQuestion = function() {\r\n    $scope.assignmentNow = false;\r\n    $scope.targetPid = \"\";\r\n    $scope.targetPaperName = \"\";\r\n    $scope.shortTargetPaperName = \"\";\r\n    $scope.cids = [];\r\n  }\r\n\r\n  // \r\n  $scope.choosePaper = function(pid,isFinish){\r\n    if ($scope.targetPid==pid || isFinish!=1){\r\n      return;\r\n    } else {\r\n      $scope.targetPid = pid;\r\n      $scope.targetPaperName = \"\";\r\n      $scope.shortTargetPaperName = \"\";\r\n      $http.get(api_url + \"/test/paper?pid=\" + $scope.targetPid)\r\n        .success(function(data) {\r\n          if(!data.status){\r\n            $scope.targetPaperName = data.paperName;\r\n            if ($scope.targetPaperName.length >14){\r\n              $scope.shortTargetPaperName = $scope.targetPaperName.substring(0,14)+'...';\r\n            }\r\n          } else{\r\n            alert(data.info);\r\n          }\r\n        }\r\n      );\r\n    }\r\n  }\r\n  // \r\n  $scope.cancelPaper = function(){\r\n    $scope.targetPid = \"\";\r\n    $scope.targetPaperName = \"\";\r\n    $scope.shortTargetPaperName = \"\";\r\n  }\r\n\r\n  // \r\n  $scope.searchPaperFromName = function(){\r\n    $scope.paperName = document.getElementById(\"newPaperName\").value;\r\n    if(!$scope.paperName){\r\n      alert('')\r\n    } else {\r\n      $http.put(api_url + \"/test/paper/search?page=1&size=1000\", {\r\n        \"paperName\": $scope.paperName\r\n      }).success(function(data) {\r\n        if (!data.status) { //\r\n          $scope.paperlist = data.paperList;\r\n          $scope.paperCount = data.count;\r\n          for(var j = 0 ; j < $scope.paperlist.length; j++){\r\n            if($scope.paperlist[j]['paperName'].length > 14){\r\n              $scope.paperlist[j]['shortPaperName'] = $scope.paperlist[j]['paperName'].substring(0,14)+'...';\r\n            }\r\n          }\r\n        } else {\r\n          alert(data.info);\r\n        }\r\n      })\r\n    }\r\n    // console.log($scope.paperName);\r\n  }\r\n\r\n  // \r\n  $scope.getAllPaper = function(){\r\n    $scope.newPaperName = \"\";\r\n    //\r\n    $http.get(api_url + \"/test/paper/teacher?page=1&size=99999\")\r\n      .success(function(data) {\r\n        if(!data.status){\r\n          $scope.paperlist = data.paperList;\r\n          // console.log($scope.paperlist);\r\n          for(var n = 0 ; n < $scope.paperlist.length; n++){\r\n            if($scope.paperlist[n]['paperName'].length > 14){\r\n              $scope.paperlist[n]['shortPaperName'] = $scope.paperlist[n]['paperName'].substring(0,14)+'...';\r\n            }\r\n          }\r\n          // console.log($scope.paperlist);\r\n        } else{\r\n          alert(data.info)\r\n        }\r\n      });\r\n  }\r\n\r\n  // \r\n  $scope.isWholeWork = 0;\r\n  $scope.changeWholeWork = function(){\r\n    if ($scope.isWholeWork==1){\r\n      $scope.isWholeWork = 0;\r\n    } else {\r\n      $scope.isWholeWork = 1;\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.isOutOfOrder = 0;\r\n  $scope.changeOutOfOrder = function(){\r\n    if ($scope.isOutOfOrder==1){\r\n      $scope.isOutOfOrder = 0;\r\n    } else {\r\n      $scope.isOutOfOrder = 1;\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.isViewResolution = 1;\r\n  $scope.changeViewResolution = function(){\r\n    if ($scope.isViewResolution==1){\r\n      $scope.isViewResolution = 2;\r\n    } else {\r\n      $scope.isViewResolution = 1;\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.isJoinReport = 1;\r\n  $scope.changeJoinReport = function(){\r\n    if ($scope.isJoinReport==1){\r\n      $scope.isJoinReport = 0;\r\n    } else {\r\n      $scope.isJoinReport = 1;\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.workType = 1;\r\n  \r\n  \r\n  // \r\n  $scope.doneWorkAssignment = function () {\r\n    // \r\n    if(!$scope.targetPid){\r\n      alert('');\r\n      return;\r\n    }\r\n    // \r\n    \r\n    //0\r\n    $scope.hours = 0;\r\n    $scope.minute = 0;\r\n    $scope.second = 0;\r\n\r\n    //\r\n    $scope.durationTime = parseInt($scope.hours * 60 * 60) + parseInt($scope.minute * 60) + parseInt($scope.second);\r\n\r\n    //\r\n    if ($scope.durationTime != 0 && $scope.durationTime < 60) {\r\n      alert(\"1!\");\r\n      return;\r\n    };\r\n\r\n    //\r\n    var currentTime = new Date();\r\n    var year = currentTime.getFullYear();\r\n    var month = currentTime.getMonth() + 1;\r\n    var day = currentTime.getDate();\r\n    var hours = currentTime.getHours();\r\n    var minutes = currentTime.getMinutes();\r\n    var seconds = currentTime.getSeconds();\r\n    //10\"0\";\r\n    if (month < 10) { month = \"0\" + month; }\r\n    if (day < 10) { day = \"0\" + day }\r\n    if (hours < 10) { hours = \"0\" + hours }\r\n    if (minutes < 10) { minutes = \"0\" + minutes }\r\n    if (seconds < 10) { seconds = \"0\" + seconds }\r\n    $scope.currentTime = year + \"-\" + month + \"-\" + day + \" \" + hours + \":\" + minutes + \":\" + seconds;\r\n\r\n    //\r\n    if (!$(\".beginTime\").val()) {\r\n      $scope.startTime = $scope.currentTime;\r\n    } else {\r\n      $scope.startTime = $(\".beginTime\").val();\r\n    }\r\n\r\n    //\r\n    if (!$(\".endTime\").val()) {\r\n      $scope.endTime = null;\r\n      $scope.showAnswerType = 1;\r\n    } else if (Date.parse(new Date($(\".endTime\").val())) < Date.parse(new Date($scope.startTime))) {\r\n      alert('!');\r\n      return;\r\n    } else {\r\n      $scope.endTime = $(\".endTime\").val();\r\n    }\r\n\r\n    //\r\n    if (!$(\".noticeTime\").val()) {\r\n      $scope.displayTime = $scope.currentTime;\r\n    } else if (Date.parse(new Date($(\".noticeTime\").val())) < Date.parse(new Date($scope.currentTime))) {\r\n      alert('!');\r\n      return;\r\n    } else if (Date.parse(new Date($(\".noticeTime\").val())) > Date.parse(new Date($scope.startTime))) {\r\n      alert('!');\r\n      return;\r\n    } else {\r\n      $scope.displayTime = $(\".noticeTime\").val();\r\n    }\r\n\r\n    //\r\n    var startime = new Date($(\".beginTime\").val()).getTime();\r\n    if ($(\".endTime\").val()) { //\r\n      var endtime = new Date($(\".endTime\").val()).getTime();\r\n      if ((endtime - startime) / 1000 < $scope.durationTime) {\r\n        alert(\"!\");\r\n        return;\r\n      }\r\n    }\r\n     \r\n    $scope.workName = document.getElementById('workName').value;\r\n    // console.log($scope.workName);\r\n    // \r\n    if(!$scope.workName){\r\n      $scope.workName = $scope.targetPaperName;\r\n    }\r\n    \r\n    // \r\n    var workInfo = {\r\n      \"pid\": parseInt($scope.targetPid),\r\n      \"workName\": $scope.workName,\r\n      \"displayTime\": $scope.displayTime,\r\n      \"startTime\": $scope.startTime,\r\n      \"endTime\": $scope.endTime,\r\n      \"showAnswerType\": parseInt($scope.isViewResolution),\r\n      \"durationTime\": parseInt($scope.durationTime),\r\n      \"isMixed\": parseInt($scope.isOutOfOrder),\r\n      \"isWholeWork\": parseInt($scope.isWholeWork),\r\n      \"isJoinStatistics\": parseInt($scope.isJoinReport),\r\n      \"cids\": $scope.cids,\r\n      \"workType\": $scope.workType\r\n    }\r\n\r\n    // console.log(workInfo);\r\n\r\n    // json\r\n    workInfo = JSON.stringify(workInfo);\r\n    $http.post(api_url + \"/work\", workInfo)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          alert(\"!\");\r\n          // \r\n          $scope.assignmentNow = false;\r\n          $scope.targetPid = \"\";\r\n          $scope.targetPaperName = \"\";\r\n          $scope.workName = \"\";\r\n          $scope.shortTargetPaperName = \"\";\r\n          $scope.cids = [];\r\n          // \r\n          $scope.showQuestionBox = false;\r\n          $scope.assignmentNow = false;\r\n        } else {\r\n          alert(data.info);\r\n        }\r\n      })\r\n    \r\n    \r\n  }\r\n\r\n}]);\r\n\r\n//\r\napp.controller('permission', ['$scope', '$http', '$routeParams', 'mxxServices', '$cookieStore', '$location', function($scope, $http, $routeParams, mxxServices, $cookieStore, $location) {\r\n  $scope.cid = Number($routeParams.cid);\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n\r\n  mxxServices.getClassInfo($scope);\r\n  //\r\n  mxxServices.showClass2WM($scope);\r\n// console.log($scope.cid,typeof($scope.cid));\r\n\r\n  //\r\n  var accountExp = /^[a-zA-Z]\\w+$/,\r\n    phoneExp = /^1[34578]\\d{9}$/,\r\n    mailExp = /^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$/;\r\n\r\n  //XX\r\n  $scope.search = function() {\r\n    if ($scope.account) {\r\n      var obj = {};\r\n      if (mailExp.test($scope.account)) {\r\n        obj.email = $scope.account;\r\n      } else if (phoneExp.test($scope.account)) {\r\n        obj.phone = $scope.account;\r\n      } else if (accountExp.test($scope.account)) {\r\n        obj.account = $scope.account;\r\n      } else {\r\n        alert('!');\r\n        return;\r\n      }\r\n      $http.put(api_url + \"/teacher/info\", obj)\r\n        .success(function(data) {\r\n          if (!data.status) {\r\n            //\r\n            $scope.email = data.email;\r\n            $scope.itid = data.tid; //tid\r\n            // $scope.isAgree = data.isAgree;\r\n            $scope.tname = data.teacherName;\r\n            // console.log('');\r\n            // console.log($scope.itid,$scope.tname);\r\n            // if ($scope.isAgree == 3 || $scope.isAgree == 2) { //\r\n            //   // $scope.isAgree==2\r\n            //   $scope.result = 1;\r\n            // } else {\r\n            //   $scope.result = 2;\r\n            // }\r\n          } else {\r\n            $scope.tname = \"\";\r\n            // $scope.result = 0;\r\n          }\r\n        })\r\n    }\r\n  }\r\n\r\n  $scope.invite = function() {\r\n    //\r\n    //  \r\n    // console.log($scope.cid,$scope.itid)\r\n    // alert('');\r\n    // console.log($scope.cid,$scope.itid)\r\n    // if ($scope.email) {\r\n      // if ($scope.result == 1) {\r\n      $http.put(api_url + \"/class/teacher/invite\", {\r\n          \"cid\": parseInt($scope.cid),\r\n          \"tid\": parseInt($scope.itid)\r\n        }).success(function(data) {\r\n          if (!data.status) {\r\n            // $scope.invite = null;\r\n            alert(\"!\");\r\n            $scope.tname = \"\";\r\n            $scope.account = \"\";\r\n            $scope.getTeacherListByCid();\r\n          }\r\n        })\r\n        // } else if ($scope.result == 2) {\r\n        // alert($scope.tname + \"\")\r\n        // }\r\n    // }\r\n  };\r\n\r\n  //?\r\n  $scope.isChecked = function() {\r\n    $http.put(api_url + \"/class/teacher/set\", {\r\n      \"cid\": parseInt($scope.cid),\r\n      \"isShow\": Number($scope.check)\r\n    }).success(function(data) {\r\n      // console.log(data)\r\n    })\r\n  }\r\n\r\n  //\r\n  $scope.getTeacherListByCid = function() {\r\n    $http.get(api_url + \"/class/teacher/list?cid=\" + $scope.cid)\r\n      .success(function(data) {\r\n        $scope.classTeacher = data.teacherList;\r\n        $scope.b = data.teacherList[0];\r\n        //\r\n        /*for (var i = 0; i < $scope.classTeacher.length; i++) {\r\n          if ($scope.classTeacher[i].isOwner === 1) {\r\n            $scope.creator = $scope.classTeacher.splice(i, 1)[0];\r\n            break; //\r\n          }\r\n        }*/\r\n        if ($scope.classTeacher.length) {\r\n          angular.forEach($scope.classTeacher, function(ele, index) {\r\n            if (ele.tid == $scope.tid) {\r\n              if (ele.isShow == 1) {\r\n                $scope.check = true;\r\n              } else {\r\n                $scope.check = false;\r\n              }\r\n            }\r\n            if (ele.isOwner == 1) {\r\n              $scope.create = ele;\r\n              $scope.classTeacher.splice(index, 1);\r\n            }\r\n          })\r\n        }\r\n        //  isagree\r\n        $scope.classTeacher.sort(function(a, b) {\r\n          return b.isAgree - a.isAgree;\r\n        })\r\n\r\n      })\r\n  };\r\n\r\n  $scope.getTeacherListByCid();\r\n\r\n// \r\n  $scope.changeCourse = function($event) {\r\n    // console.log('123')\r\n    $scope.teacherInfo = this.$parent.teacher;\r\n    if ($scope.teacherInfo.isAgree == 1) {\r\n      $event.target.style.cursor = \"pointer\";\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.transfer = function($event, tid) {\r\n    //\r\n    //\r\n    //tidtid\r\n    //\r\n    $scope.teacherInfo = this.$parent.teacher;\r\n    if ($scope.teacherInfo.classTeacher.isagree === 1) {\r\n      //\r\n      var bool = window.confirm(\"?\");\r\n      if (bool) {\r\n        $http.put(api_url + \"/class/teacher/owner\", {\r\n          \"tid\": tid,\r\n          \"cid\": parseInt($scope.cid)\r\n        }).success(function(data) {\r\n          // console.log('...')\r\n          $scope.getTeacherListByCid();\r\n        })\r\n      } else {\r\n        // console.log('...')\r\n      }\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.delete = function($event, tid) {\r\n    //\r\n    // $http.patch(api_url + \"/class2teacher\", {\r\n    var bool = window.confirm(\"?\");\r\n    if (bool) {\r\n      $http({\r\n        method: \"delete\",\r\n        url: api_url + '/class/teacher/delete',\r\n        data: { \"cid\": $scope.cid, \"tid\": tid },\r\n        headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n      }).success(function(data) {\r\n        $($event.target).parents(\"tr\").remove()\r\n      })\r\n    }\r\n\r\n  }\r\n\r\n  //\r\n  $scope.leave = function(tid) {\r\n    if (tid == $scope.tid) {\r\n      $http.put(api_url + \"/class/teacher/reply\", {\r\n        \"cid\": parseInt($scope.cid),\r\n        \"isAgree\": 2\r\n      }).success(function(data) {\r\n        $location.path(\"class/list\")\r\n      })\r\n    }\r\n  }\r\n\r\n}]);\r\n\r\n//\r\napp.controller('questionbank', ['$scope', '$http', '$routeParams', 'mxxServices', '$cookieStore', '$location', function($scope, $http, $routeParams, mxxServices, $cookieStore, $location) {\r\n  $scope.cid = Number($routeParams.cid);\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 10;\r\n  $scope.showAddPaper = false;\r\n  // console.log($scope.cid);\r\n  // \r\n  // mxxServices.getClassInfo($scope);\r\n  //\r\n  mxxServices.showClass2WM($scope);\r\n  // \r\n  $http.get(api_url + \"/class/info?cid=\" + $scope.cid)\r\n  .success(function(data){\r\n    $scope.className = data.className;\r\n    $scope.password = data.password;\r\n    $scope.limit = data.maxNumber;\r\n    $scope.classNum = data.userNumber;\r\n    $scope.createSid = data.sid;\r\n    $scope.isPumping = data.isPumping;\r\n    if(!$scope.isPumping){\r\n      $scope.check = false;\r\n    } else {\r\n      $scope.check = true;\r\n      // \r\n      $scope.getClassQuestionBankConfig();\r\n    }\r\n    // console.log($scope.check);\r\n  });\r\n\r\n  // \r\n  $scope.getData = function(){\r\n    $http.get(api_url + '/class/paper/list?cid=' + $scope.cid + '&page='+ $scope.currentPage + '&size=' + $scope.pageSize)\r\n    .success(function(data){\r\n      $scope.count = data.count;\r\n      if ($scope.count == 0) { //\r\n        $scope.num = 1;\r\n      } else {\r\n        $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n        $scope.paperList = data.paperList;\r\n      }\r\n    })\r\n  }\r\n  // $scope.getData();\r\n\r\n  // \r\n  $scope.prev = function(){               \r\n    if ($scope.currentPage > 1) {\r\n      $scope.currentPage--;\r\n      $scope.getData();\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.next = function(){\r\n    if ($scope.currentPage < $scope.num) {\r\n      $scope.currentPage++;\r\n      $scope.getData();\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.isChecked = function(){\r\n    var isPumping;\r\n    if(!$scope.isPumping){\r\n      isPumping = 1;\r\n    } else {\r\n      isPumping = 0;\r\n    }\r\n    // console.log(isPumping);    \r\n    $http.post(api_url + '/class/question/bank/config',{\r\n      \"cid\":$scope.cid,\r\n      \"isPumping\":isPumping\r\n    })\r\n    .success(function(data){\r\n      if(isPumping===1){\r\n        $scope.check = true;\r\n        $scope.isPumping = 1;\r\n        // \r\n        $scope.getClassQuestionBankConfig();\r\n      } else {\r\n        $scope.check = false;\r\n        $scope.isPumping = 0;\r\n      }\r\n    })\r\n  }\r\n\r\n  // \r\n  $scope.getClassQuestionBankConfig = function(){\r\n    $http.get(api_url + '/class/question/bank/config?cid=' + $scope.cid)\r\n    .success(function(data){\r\n      $scope.dataId = data.dataId;\r\n      $scope.paperNamePrefix = data.paperNamePrefix;\r\n      $scope.totalAmount = data.totalAmount;\r\n      $scope.amountConf = data.amountConf;\r\n      $scope.amountInfo = data.amountInfo;\r\n      $scope.totalScore = data.totalScore;\r\n      $scope.totalDuration = Number(data.totalDuration)\r\n      if($scope.totalDuration){\r\n        if($scope.totalDuration<60){\r\n          $scope.durationTime = $scope.totalDuration + '';\r\n          $scope.timeHour = 0;\r\n          $scope.timeMinute = $scope.totalDuration;\r\n        } else {\r\n          var hours = parseInt($scope.totalDuration/60); //\r\n          var minute = $scope.totalDuration%60; //\r\n          // console.log(hours,minute)\r\n          $scope.timeHour = hours;\r\n          if(minute===0){\r\n            $scope.durationTime = hours + '';\r\n            $scope.timeMinute = 0;\r\n          } else {\r\n            $scope.durationTime = hours + '' + minute + '';\r\n            $scope.timeMinute = minute;\r\n          }\r\n        }\r\n        $scope.backupsTime = {\r\n          \"timeHour\": $scope.timeHour,\r\n          \"timeMinute\":$scope.timeMinute\r\n        }\r\n      } else {\r\n        $scope.durationTime = 0;\r\n      }\r\n      $scope.backupsConfig = {\r\n        \"dataId\":$scope.dataId,\r\n        \"paperNamePrefix\":$scope.paperNamePrefix,\r\n        \"totalAmount\":$scope.totalAmount,\r\n        \"amountInfo\":$scope.amountInfo,\r\n        \"totalDuration\":$scope.totalDuration,\r\n        \"totalScore\":$scope.totalScore\r\n      }\r\n      if(!$scope.amountConf){\r\n        $scope.backupsConfig['amountConf'] = [[1,2,3,4],[0,0,0,0]];\r\n        $scope.amountConf = $scope.backupsConfig['amountConf'];\r\n        $scope.numberTotal = 0;\r\n      } else {\r\n        $scope.singleselect = $scope.amountConf[1][0];\r\n        $scope.multiselect = $scope.amountConf[1][1];\r\n        $scope.judge = $scope.amountConf[1][2];\r\n        $scope.subjective = $scope.amountConf[1][3];\r\n        $scope.numberTotal = $scope.singleselect + $scope.multiselect +$scope.judge +$scope.subjective;\r\n      }\r\n      if(!$scope.amountInfo){\r\n        $scope.backupsConfig['amountInfo'] = [[1,2,3,4],[0,0,0,0]];\r\n        $scope.amountInfo = $scope.backupsConfig['amountInfo'];\r\n        $scope.allNumber = 0;\r\n      } else {\r\n        $scope.allNumber = $scope.amountInfo[1][0] + $scope.amountInfo[1][1] +$scope.amountInfo[1][2] +$scope.amountInfo[1][3];\r\n      }\r\n      $scope.isShowEdit = false;\r\n      // console.log($scope.backupsConfig)\r\n    })\r\n  }\r\n\r\n  // updateQuestionbankConfig()\r\n  $scope.updateQuestionbankConfig = function(){\r\n    if(!$scope.allNumber){\r\n      alert('');\r\n      return;\r\n    }\r\n    $scope.isShowEdit = true;\r\n    console.log($scope.timeMinute)\r\n  }\r\n\r\n  // \r\n  $scope.validatePrefix = function(){\r\n    if($scope.paperNamePrefix){\r\n      if($scope.paperNamePrefix.length>10){\r\n        alert('10');\r\n        $scope.paperNamePrefix = $scope.backupsConfig['paperNamePrefix'];\r\n        return;\r\n      }\r\n    } else {\r\n      alert('');\r\n      return;\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.validateSingle = function(){\r\n    if($scope.singleselect){\r\n      $scope.singleselect = Number($scope.singleselect);\r\n      var numStatus = isNaN($scope.singleselect);\r\n      if(!numStatus){\r\n        // \r\n        if($scope.amountInfo[1][0]==0){\r\n          alert('');\r\n          return;\r\n        } else if($scope.singleselect<0){\r\n          alert('');\r\n          $scope.singleselect = $scope.backupsConfig['amountConf'][1][0];\r\n          return;\r\n        } else if($scope.amountInfo[1][0]<$scope.singleselect){\r\n          alert('')\r\n          $scope.singleselect = $scope.backupsConfig['amountConf'][1][0];\r\n          return;\r\n        } else {\r\n          $scope.numberTotal = $scope.singleselect+$scope.multiselect+$scope.judge+$scope.subjective;\r\n        }\r\n      } else {\r\n        // \r\n        alert('');\r\n        $scope.singleselect = $scope.backupsConfig['amountConf'][1][0];\r\n        return;\r\n      }\r\n    }\r\n  }\r\n  // \r\n  $scope.validateMultiselect = function(){\r\n    if($scope.multiselect){\r\n      $scope.multiselect = Number($scope.multiselect);\r\n      var numStatus = isNaN($scope.multiselect);\r\n      if(!numStatus){\r\n        // \r\n        if($scope.amountInfo[1][1]==0){\r\n          alert('');\r\n          return;\r\n        } else if($scope.multiselect<0){\r\n          alert('');\r\n          $scope.multiselect = $scope.backupsConfig['amountConf'][1][1];\r\n          return;\r\n        } else if($scope.amountInfo[1][1]<$scope.multiselect){\r\n          alert('')\r\n          $scope.multiselect = $scope.backupsConfig['amountConf'][1][1];\r\n          return;\r\n        } else {\r\n          $scope.numberTotal = $scope.singleselect+$scope.multiselect+$scope.judge+$scope.subjective;\r\n        }\r\n      } else {\r\n        // \r\n        alert('');\r\n        $scope.multiselect = $scope.backupsConfig['amountConf'][1][1];\r\n        return;\r\n      }\r\n    }\r\n  }\r\n  // \r\n  $scope.validateJudge = function(){\r\n    if($scope.judge){\r\n      $scope.judge = Number($scope.judge);\r\n      var numStatus = isNaN($scope.judge);\r\n      if(!numStatus){\r\n        if($scope.amountInfo[1][2]==0){\r\n          alert('');\r\n          return;\r\n        } else if($scope.judge<0){\r\n          alert('');\r\n          $scope.judge = $scope.backupsConfig['amountConf'][1][2];\r\n          return;\r\n        } else if($scope.amountInfo[1][2]<$scope.judge) {\r\n          alert('')\r\n          $scope.judge = $scope.backupsConfig['amountConf'][1][2];\r\n          return;\r\n        } else {\r\n          $scope.numberTotal = $scope.singleselect+$scope.multiselect+$scope.judge+$scope.subjective;\r\n        }\r\n      } else {\r\n        // \r\n        alert('');\r\n        $scope.judge = $scope.backupsConfig['amountConf'][1][2];\r\n        return;\r\n      }\r\n    }\r\n  }\r\n  // \r\n  $scope.validateSubjective = function(){\r\n    if($scope.subjective){\r\n      $scope.subjective = Number($scope.subjective);\r\n      var numStatus = isNaN($scope.subjective);\r\n      if(!numStatus){\r\n        // \r\n        if($scope.amountInfo[1][3]==0){\r\n          alert('');\r\n          return;\r\n        } else if($scope.subjective<0){\r\n          alert('');\r\n          $scope.subjective = $scope.backupsConfig['amountConf'][1][3];\r\n          return;\r\n        } else if($scope.amountInfo[1][3]<$scope.subjective){\r\n          alert('');\r\n          $scope.subjective = $scope.backupsConfig['amountConf'][1][3];\r\n          return;\r\n        } else {\r\n          $scope.numberTotal = $scope.singleselect+$scope.multiselect+$scope.judge+$scope.subjective;\r\n        }\r\n      } else {\r\n        // \r\n        alert('');\r\n        $scope.subjective = $scope.backupsConfig['amountConf'][1][3];\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.validateHour = function(){\r\n    if($scope.timeHour){\r\n      var numStatus = isNaN($scope.timeHour);\r\n      if(!numStatus){\r\n        // \r\n        if($scope.timeHour<0){\r\n          alert('');\r\n          $scope.timeHour = $scope.backupsTime['timeHour'];\r\n          return;\r\n        }\r\n      } else {\r\n        // \r\n        alert('');\r\n        $scope.timeHour = $scope.backupsTime['timeHour'];\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.validateMinute = function(){\r\n    if($scope.timeMinute){\r\n      var numStatus = isNaN($scope.timeMinute);\r\n      if(!numStatus){\r\n        // \r\n        if($scope.timeMinute<60){\r\n          if($scope.timeMinute < 0){\r\n            alert('');\r\n            $scope.timeMinute = $scope.backupsTime['timeMinute'];\r\n            return;\r\n          }\r\n        } else {\r\n          alert('60')\r\n          $scope.timeMinute = $scope.backupsTime['timeMinute'];\r\n          return;\r\n        }\r\n      } else {\r\n        // \r\n        alert('');\r\n        $scope.timeMinute = $scope.backupsTime['timeMinute'];\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.validateScore = function(){\r\n    if($scope.totalScore){\r\n      var numStatus = isNaN($scope.totalScore);\r\n      if(!numStatus){\r\n        // \r\n        if($scope.totalScore<0){\r\n          alert('');\r\n          $scope.totalScore = $scope.backupsConfig['totalScore'];\r\n          return;\r\n        }\r\n      } else {\r\n        // \r\n        alert('');\r\n        $scope.totalScore = $scope.backupsConfig['totalScore'];\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.preservationConfig = function(){\r\n    // \r\n    if(!$scope.paperNamePrefix||!$scope.totalAmount){\r\n      alert('')\r\n      return;\r\n    }\r\n    // \r\n    $scope.numberTotal = $scope.singleselect+$scope.multiselect+$scope.judge+$scope.subjective;\r\n    if($scope.numberTotal < 1){\r\n      alert('');\r\n      return;\r\n    } else {\r\n      $scope.amountConf = [[1,2,3,4],[$scope.singleselect,$scope.multiselect,$scope.judge,$scope.subjective]] \r\n    }\r\n    // \r\n    var obj = {\r\n      \"dataId\": $scope.dataId,\r\n      \"paperNamePrefix\": $scope.paperNamePrefix,\r\n      \"totalAmount\": $scope.numberTotal,\r\n      \"amountConf\": $scope.amountConf\r\n    }\r\n    if($scope.timeHour||$scope.timeMinute){\r\n      if($scope.timeHour&&!$scope.timeMinute){\r\n        $scope.totalDuration = $scope.timeHour*60;\r\n      } else if(!$scope.timeHour&&$scope.timeMinute){\r\n        $scope.totalDuration = $scope.timeMinute;\r\n      } else if($scope.timeHour&&$scope.timeMinute){\r\n        $scope.totalDuration = $scope.timeHour*60+$scope.timeMinute;\r\n      }\r\n      obj['totalDuration'] = $scope.totalDuration;\r\n    }\r\n    if($scope.totalScore){\r\n      obj['totalScore'] = $scope.totalScore;\r\n    }\r\n    // \r\n    $http.put(api_url + '/class/question/bank/config',obj).success(function(data){\r\n      $scope.isShowEdit = false;\r\n      // \r\n      $scope.getClassQuestionBankConfig();\r\n    });\r\n  }\r\n\r\n  // \r\n  $scope.cancelConfig = function(){\r\n    $scope.isShowEdit = false;\r\n    $scope.paperNamePrefix = $scope.backupsConfig['paperNamePrefix'];\r\n    $scope.totalAmount = $scope.backupsConfig['totalAmount'];\r\n    // $scope.amountConf = $scope.backupsConfig['amountConf'];\r\n    $scope.totalDuration = $scope.backupsConfig['totalDuration'];\r\n    $scope.totalScore = $scope.backupsConfig['totalScore'];\r\n  }\r\n\r\n  // \r\n  $scope.showBoxOfAddPaper = function(){\r\n    $scope.showAddPaper = true;\r\n    // console.log($scope.showAddPaper);\r\n    $scope.getMyPaperList();\r\n  }\r\n  // \r\n  $scope.cancelPaperBox = function(){\r\n    $scope.showAddPaper = false;\r\n  }\r\n\r\n  // \r\n  $scope.getMyPaperList = function(){\r\n    $http.get(api_url + '/test/paper/teacher?page=1&size=1000').success(function(data){\r\n      $scope.myPaperCount = data.count;\r\n      $scope.myPaperList = data.paperList;\r\n      $scope.newPaperList = new Array();\r\n      // \r\n      for(var i=0; i<$scope.myPaperList.length; i++){\r\n        if($scope.myPaperList[i]['isFinish'] === 1){\r\n          $scope.newPaperList.push($scope.myPaperList[i]);\r\n        }\r\n      }\r\n      // console.log($scope.newPaperList);\r\n      // \r\n      for(var n=0; n<$scope.newPaperList.length;n++){\r\n        if($scope.newPaperList[n]['paperName'].length>15){\r\n          $scope.newPaperList[n]['paperNameShort'] = $scope.newPaperList[n]['paperName'].substr(0,15)+'...';\r\n        } else {\r\n          $scope.newPaperList[n]['paperNameShort'] = $scope.newPaperList[n]['paperName'];\r\n        }\r\n      }\r\n      // console.log($scope.newPaperList);\r\n    })\r\n    // \r\n    $scope.localPaperList = [];\r\n  }\r\n\r\n  var localPid = [] \r\n  // \r\n  $scope.addToTheLocal = function(paperNameShort,paperName,pid,index){\r\n    var paperData = {\r\n      \"pid\":pid,\r\n      \"paperName\":paperName,\r\n      \"paperNameShort\":paperNameShort\r\n    }\r\n    localPid.push(pid);\r\n    $scope.localPaperList.push(paperData);\r\n    $scope.newPaperList[index]['showStatus'] = true;\r\n  }\r\n  // \r\n  $scope.removeFromLocal = function(index){\r\n    var pid = $scope.localPaperList[index]['pid'];\r\n    for(var e=0;e<$scope.newPaperList.length;e++){\r\n      if(pid == $scope.newPaperList[e]['pid']){\r\n        $scope.newPaperList[e]['showStatus'] = false;\r\n        $scope.localPaperList.splice(index,1);\r\n        localPid.splice(index,1);\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.sureAddPaper = function(){\r\n    if($scope.localPaperList.length>0){\r\n      console.log(localPid);\r\n      $http.post(api_url + '/class/paper',{\r\n        \"cid\":$scope.cid,\r\n        \"pid\":localPid\r\n      }).success(function(data){\r\n        $scope.showAddPaper = false;\r\n        localPid = [];\r\n        // \r\n        $scope.getData();\r\n        // \r\n        $scope.getClassQuestionBankConfig();\r\n      })\r\n    } else {\r\n      alert('');\r\n      return;\r\n    }\r\n  }\r\n  // \r\n  $scope.removeFromClassPaper = function(classPaperId){\r\n    // console.log(classPaperId)\r\n    $http({\r\n      method: \"DELETE\",\r\n      url: api_url + '/class/paper',\r\n      data: { \"classPaperId\": [classPaperId] },\r\n      headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n    }).success(function(data) {\r\n      if (!data.status) {\r\n      // console.log('')\r\n      // \r\n      $scope.getData();\r\n      // \r\n      $scope.getClassQuestionBankConfig();\r\n      }\r\n    })\r\n  }\r\n  // console.log($scope.isPumping)\r\n  // $scope.getClassInfo();\r\n}]);\r\n//\r\napp.controller(\"modify\", ['$scope', '$http', '$routeParams', '$location', '$cookieStore', 'mxxServices', function($scope, $http, $routeParams, $location, $cookieStore, mxxServices) {\r\n  $scope.cid = $routeParams.cid;\r\n\r\n  $scope.sid = $cookieStore.get(\"user\").sid;\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n\r\n  mxxServices.getClassInfo($scope);\r\n\r\n  //\r\n  mxxServices.showClass2WM($scope);\r\n\r\n  //\r\n  $http.get(api_url + \"/class/info?cid=\" + $scope.cid)\r\n    .success(function(data) {\r\n      $scope.className = data.className;\r\n      $scope.limit = data.maxNumber;\r\n      $scope.password = data.password;\r\n      //\r\n      $scope.reName = data.className;\r\n      $scope.reNumber = data.maxNumber;\r\n      $scope.rePassword = data.password;\r\n      $scope.classAnnounce = data.remarkName || '';\r\n      $scope.createSid = data.createTid;\r\n      //\r\n      if ($scope.tid !== $scope.createSid) {\r\n        $(\".class-modify\").addClass(\"return\");\r\n      }\r\n    });\r\n\r\n  //140\r\n  $scope.tips = 140;\r\n\r\n  $scope.counter = function() {\r\n    if ($scope.classAnnounce.trim().length == 0) {\r\n      $(\".tips\").css(\"display\", \"none\");\r\n      $(\".error\").css(\"display\", \"none\");\r\n    }\r\n    if (0 < $scope.classAnnounce.trim().length <= 140) {\r\n      $(\".tips\").css(\"display\", \"block\");\r\n      $(\".error\").css(\"display\", \"none\");\r\n      $scope.tips = 140 - $scope.classAnnounce.trim().length;\r\n    }\r\n    if ($scope.classAnnounce.trim().length > 140) {\r\n      $(\".tips\").css(\"display\", \"none\");\r\n      $(\".error\").css(\"display\", \"block\");\r\n      $scope.tips = $scope.classAnnounce.trim().length - 140;\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.modify = function() {\r\n    if ($(\".class-modify\").hasClass(\"return\")) {\r\n      alert(\"\")\r\n      return;\r\n    }\r\n    //140\r\n    //140\r\n    if ($scope.classAnnounce && $scope.classAnnounce.trim().length > 140) {\r\n      return;\r\n    };\r\n    //200\r\n    if (isNaN($scope.reNumber - 1)) {\r\n      alert(\"!\");\r\n      return;\r\n    };\r\n    if ($scope.reNumber > 200) {\r\n      alert(\"200!\");\r\n      return;\r\n    };\r\n\r\n    if ($scope.reNumber < $scope.classNum) {\r\n      alert(\"\");\r\n      return;\r\n    }\r\n\r\n    if ($scope.rePass) {\r\n      var reg = /^\\d{6,8}$/;\r\n      if (!reg.test($scope.rePass)) {\r\n        alert(\"6-8!\");\r\n        return;\r\n      }\r\n    };\r\n\r\n    var data = {\r\n      \"cid\": parseInt($scope.cid), //\r\n      \"className\": $scope.reName,\r\n      \"maxNumber\": parseInt($scope.reNumber),\r\n      \"password\": $scope.rePassword,\r\n      \"remarkName\": $scope.classAnnounce\r\n    };\r\n    //JSON\r\n    data = JSON.stringify(data);\r\n    $http.put(api_url + \"/class\", data).success(function(data) {\r\n      alert(\"!\");\r\n      $location.path(\"/class/list\");\r\n    })\r\n  };\r\n\r\n}])\r\n\r\n//\r\napp.controller(\"personInfo\", ['$scope', '$http', '$cookieStore', '$routeParams', 'mxxServices', function($scope, $http, $cookieStore, $routeParams, mxxServices) {\r\n  $scope.cid = $routeParams.cid;\r\n  $scope.uid = $routeParams.uid;\r\n  $scope.sid = $cookieStore.get(\"user\").sid;\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n\r\n  mxxServices.getClassInfo($scope);\r\n  mxxServices.showClass2WM($scope);\r\n\r\n  //\r\n  $http.get(api_url + \"/student/class/report?studentId=\" + $scope.uid + \"&cid=\" + $scope.cid)\r\n    .success(function(data) {\r\n      if (!data.status) {\r\n        $scope.user = data;\r\n      }\r\n    })\r\n}])\r\n\r\n//\r\napp.controller(\"paperlist\", ['$scope', '$http', '$cookieStore', '$location', '$window', '$routeParams', function($scope, $http, $cookieStore, $location, $window, $routeParams) {\r\n  $scope.type = Number($routeParams.type); //0--;1--;2--\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 10;\r\n\r\n  //\r\n  $scope.isAllVisible = false; //\r\n  $scope.visible = {};\r\n  $scope.allCheck = function() {\r\n    if (!$scope.isAllVisible) {\r\n      $scope.isAllVisible = true;\r\n      angular.forEach($scope.paperlist, function(value, key, array) {\r\n        $scope.visible[value.pid] = true;\r\n      })\r\n    } else {\r\n      $scope.isAllVisible = false;\r\n      $scope.visible = {};\r\n    }\r\n  };\r\n\r\n  $scope.oneCheck = function(pid, idx) {\r\n    if ($scope.visible[pid]) {\r\n      delete $scope.visible[pid];\r\n      $scope.isAllVisible = false;\r\n      //\r\n    } else {\r\n      $scope.visible[pid] = true;\r\n      var count = 0;\r\n      for (key in $scope.visible) {\r\n        count++;\r\n      }\r\n      if (count == $scope.paperlist.length) {\r\n        $scope.isAllVisible = true;\r\n      }\r\n\r\n    }\r\n\r\n    //\r\n    var pArray = [];\r\n    for (key in $scope.visible) {\r\n      pArray.push(key);\r\n    }\r\n\r\n    if (pArray.length != 1) {\r\n      $(\".handle-menu\").find(\"a\").removeAttr(\"href\");\r\n      if (!$(\".export-paper\").hasClass(\"disabled\")) {\r\n        $(\".export-paper\").addClass(\"disabled\")\r\n      }\r\n    } else {\r\n      //isedit:   ( 1 ->  ; 2 ->  ; )'isfinish':   0-1-\r\n      if ($scope.paperlist[idx].isFinish == 1) {\r\n        $(\".handle-menu\").find(\"a\").attr(\"href\", \"#/paper/export/\" + pArray[0]);\r\n        $(\".export-paper\").removeClass(\"disabled\")\r\n      } else {\r\n        $(\".handle-menu\").find(\"a\").removeAttr(\"href\");\r\n        if (!$(\".export-paper\").hasClass(\"disabled\")) {\r\n          $(\".export-paper\").addClass(\"disabled\")\r\n        }\r\n      }\r\n      /*$http.get(api_url + \"/test/paper?pid=\" + pArray[0])\r\n        .success(function(data) {\r\n          if (data.isFinish == 0) {\r\n            $(\".handle-menu\").find(\"a\").removeAttr(\"href\");\r\n            if (!$(\".export-paper\").hasClass(\"disabled\")) {\r\n              $(\".export-paper\").addClass(\"disabled\")\r\n            }\r\n          } else if (data.isFinish == 1) {\r\n            $(\".handle-menu\").find(\"a\").attr(\"href\", \"#/paper/export/\" + pArray[0]);\r\n            $(\".export-paper\").removeClass(\"disabled\")\r\n          }\r\n        })*/\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.mouse = {\r\n    mouseover: function() {\r\n      $(\".handle-menu\").css(\"display\", \"block\")\r\n    },\r\n    mouseout: function() {\r\n      $(\".handle-menu\").css(\"display\", \"none\")\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.checkType = function(type) {\r\n    $scope.type = type;\r\n    $scope.currentPage = 1;\r\n    $scope.isAllVisible = false; //\r\n    $scope.visible = {};\r\n    if ($scope.type == 0) {\r\n      $scope.getData();\r\n    } else if ($scope.type == 1) {\r\n      $scope.getGoodsData();\r\n    } else if ($scope.type == 2) {\r\n      $scope.getAssistData();\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.next = function() { //\r\n    if ($scope.currentPage < $scope.num) {\r\n      $scope.currentPage++;\r\n      if ($scope.type == 0 && !$scope.paperName) {\r\n        $scope.getData();\r\n      } else if ($scope.type == 1) {\r\n        $scope.getGoodsData();\r\n      } else if ($scope.type == 2) {\r\n        $scope.getAssistData();\r\n      } else if ($scope.paperName) {\r\n        $scope.searchData();\r\n      }\r\n    }\r\n  };\r\n  $scope.prev = function() { //                 \r\n    if ($scope.currentPage > 1) {\r\n      $scope.currentPage--;\r\n      if ($scope.type == 0 && !$scope.paperName) {\r\n        $scope.getData();\r\n      } else if ($scope.type == 1) {\r\n        $scope.getGoodsData();\r\n      } else if ($scope.type == 2) {\r\n        $scope.getAssistData();\r\n      } else if ($scope.paperName) {\r\n        $scope.searchData();\r\n      }\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.getData = function() {\r\n    $http.get(api_url + \"/test/paper/teacher?page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        $scope.count = data.count;\r\n        if ($scope.count == 0) { //\r\n          $scope.num = 1;\r\n        } else {\r\n          $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n          $scope.paperlist = data.paperList;\r\n        }\r\n      })\r\n  };\r\n\r\n  //\r\n  $scope.getGoodsData = function() {\r\n    $http.get(api_url + \"/goods/paper/teacher/relation?page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        $scope.count = data.count;\r\n        if ($scope.count == 0) { //\r\n          $scope.num = 1;\r\n        } else {\r\n          $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n          $scope.goodslist = data.goodsList;\r\n        }\r\n      })\r\n  };\r\n\r\n  //\r\n  $scope.getAssistData = function() {\r\n    $http.get(api_url + \"/assist/test/paper/input/teacher/list?page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        $scope.count = data.count;\r\n        if ($scope.count == 0) { //\r\n          $scope.num = 1;\r\n        } else {\r\n          $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n          $scope.assistList = data.assistList;\r\n        }\r\n      })\r\n  }\r\n\r\n  //\r\n  if ($scope.type == 0) {\r\n    $scope.getData();\r\n  } else if ($scope.type == 1) {\r\n    $scope.getGoodsData();\r\n  } else if ($scope.type == 2) {\r\n    $scope.getAssistData();\r\n  }\r\n\r\n  //\r\n  $scope.cancelAssist = function(id) {\r\n    $http({\r\n      method: \"DELETE\",\r\n      url: api_url + '/assist/test/paper/input',\r\n      data: { \"ids\": [id] },\r\n      headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n    }).success(function(data) {\r\n      if (!data.status) {\r\n        $scope.getAssistData();\r\n      }\r\n    })\r\n  }\r\n\r\n  //\r\n  $scope.delete = function() {\r\n    var arr = [];\r\n    for (key in $scope.visible) {\r\n      arr.push(Number(key))\r\n    }\r\n    if (arr.length == 0) {\r\n      alert(\"!\");\r\n      return;\r\n    } else {\r\n      var bool = window.confirm(\"?\");\r\n      /*var querry = \"pid=\";\r\n      querry = querry + arr.join(\",\");*/\r\n      //console.log(querry);\r\n      if (bool) {\r\n        // var querry = arr.join(\",\");\r\n        $http({\r\n          method: \"DELETE\",\r\n          url: api_url + '/test/paper',\r\n          data: { \"pid\": arr },\r\n          headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n        }).success(function(data) {\r\n          //return;\r\n          if (!data.status) {\r\n            $scope.getData();\r\n            // \r\n            $scope.isAllVisible = false; //\r\n            $scope.visible = {};\r\n          }\r\n        })\r\n      } else {\r\n        $scope.visible = {};\r\n      }\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.confirmPaper = function() {\r\n    var arr = [];\r\n    for (key in $scope.visible) {\r\n      arr.push(Number(key));\r\n    };\r\n    if (arr.length == 0) {\r\n      alert(\"!\");\r\n      return;\r\n    } else {\r\n      // console.log(arr)\r\n      $http.post(api_url + \"/test/paper/confirm\", {\r\n        \"pid\": arr\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.getData();\r\n          $scope.visible = {};\r\n        }\r\n      })\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.publish = function() {\r\n    var arr = [];\r\n    var flag = true;\r\n    for (key in $scope.visible) {\r\n      arr.push(Number(key));\r\n    };\r\n    if (arr.length == 0) {\r\n      alert(\"!\");\r\n      return;\r\n    } else {\r\n      angular.forEach($scope.paperlist, function(ele) {\r\n        angular.forEach(arr, function(element) {\r\n          if (element == ele.pid && ele.isFinish != 1) {\r\n            alert(\"!\");\r\n            flag = false;\r\n          }\r\n        })\r\n      })\r\n      if (flag) {\r\n        $location.path('paper/publish/' + arr.join(',') + '/0');\r\n      }\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.edit = function() {\r\n    var arr = [];\r\n    for (key in $scope.visible) {\r\n      arr.push(Number(key))\r\n    };\r\n    if (arr.length == 0) {\r\n      alert(\"!\");\r\n      return;\r\n    } else {\r\n      $http.post(api_url + \"/test/paper/edit\", {\r\n        \"pid\": arr\r\n      }).success(function(data) {\r\n        if (!data.ret) {\r\n          $scope.getData();\r\n          $scope.visible = {};\r\n        }\r\n      })\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.searchData = function() {\r\n    $http.put(api_url + \"/test/paper/search?page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize, {\r\n      \"paperName\": $scope.paperName\r\n    }).success(function(data) {\r\n      $scope.count = data.count;\r\n      if ($scope.count == 0) { //\r\n        $scope.num = 1;\r\n        $scope.paperName = \"\";\r\n        $scope.getData();\r\n        alert(\"!\");\r\n      } else {\r\n        $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n        $scope.paperlist = data.paperList;\r\n      }\r\n    })\r\n  }\r\n\r\n  $scope.search = function() {\r\n    if (!$scope.paperName) {\r\n      $scope.getData();\r\n      return;\r\n    }\r\n    $scope.currentPage = 1;\r\n    $scope.searchData();\r\n  };\r\n\r\n  document.onkeydown = function(ev) {\r\n    var ev = ev || window.ev;\r\n    if (ev.keyCode && ev.which == 13) {\r\n      $scope.search();\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.load = function() {\r\n    $(\".dialog_wrp\").css(\"display\", \"block\");\r\n    $(\".mask\").css(\"display\", \"block\");\r\n    $scope.copycode = '';\r\n    $scope.captcha = '';\r\n\r\n    //\r\n    $scope.refresh();\r\n  };\r\n\r\n  $scope.refresh = function() {\r\n    $http.get(api_url + \"/image/code?w=100&h=40\")\r\n      .success(function(data) {\r\n        $scope.image = data.image;\r\n        $scope.key = data.codeKey;\r\n      })\r\n  };\r\n\r\n\r\n  $scope.cancel = function() {\r\n    $(\".dialog_wrp\").css(\"display\", \"none\");\r\n    $(\".mask\").css(\"display\", \"none\")\r\n  };\r\n\r\n  //\r\n  $scope.confirm = function() {\r\n    $scope.copyStatus = true;\r\n    $scope.copyFalie = \"\";\r\n    if (!$scope.copycode) {\r\n      alert(\"!\")\r\n      return;\r\n    };\r\n\r\n    if (!$scope.captcha) {\r\n      alert(\"!\")\r\n      return;\r\n    };\r\n    // alert('');\r\n    $http.post(api_url + \"/test/paper/copy\", {\r\n      \"codeKey\": $scope.key,\r\n      \"code\": $scope.captcha,\r\n      \"copyCode\": $scope.copycode\r\n    }).success(function(data) {\r\n      // alert('');\r\n      // console.log(data.status);\r\n      if (!data.status) {\r\n        $scope.copyStatus = false;\r\n        $scope.copyFalie = \"\";\r\n        alert(\"!\");\r\n        $(\".dialog_wrp\").css(\"display\", \"none\");\r\n        $(\".mask\").css(\"display\", \"none\")\r\n        $scope.getData();\r\n      } else {\r\n        $scope.copyStatus = false;\r\n        $scope.copyFalie = \"\";\r\n        $scope.refresh();\r\n        $scope.captcha = '';\r\n      }\r\n    })\r\n  };\r\n\r\n  //word\r\n  $scope.export = function($event) {\r\n    if ($(\".export-paper\").hasClass(\"disabled\")) {\r\n      $(\".handle-menu\").find(\"a\").removeAttr(\"href\");\r\n      return;\r\n    }\r\n    var arr = [];\r\n    for (key in $scope.visible) {\r\n      arr.push(key)\r\n    };\r\n    //keypid\r\n    if (arr.length !== 1) {\r\n      alert(\"!\");\r\n      return false;\r\n    }\r\n    //\r\n    $(\".export-paper\").addClass(\"disabled\");\r\n    $scope.visible = {};\r\n  }\r\n\r\n}]);\r\n\r\n//\r\napp.controller(\"paperPublish\", ['$scope', '$http', '$cookieStore', '$location', '$routeParams', function($scope, $http, $cookieStore, $location, $routeParams) {\r\n  $scope.pid = $routeParams.pid.split(',').map(function(a) {\r\n    return +a\r\n  });\r\n  $scope.gid = Number($routeParams.gid);\r\n\r\n  $scope.back = function() {\r\n    if ($scope.gid == 0) {\r\n      $location.path('paper/list');\r\n    } else {\r\n      $location.path('paper/public');\r\n    }\r\n  }\r\n\r\n  $scope.selectedClass = [];\r\n  $scope.selectedCourse = [];\r\n  if ($scope.gid == 0) {\r\n    //\r\n    //\r\n    $http.put(api_url + '/paper/info/get', { \"pid\": $scope.pid })\r\n      .success(function(data) {\r\n        $scope.paperList = data.paperList;\r\n        //\r\n        angular.forEach($scope.paperList, function(ele) {\r\n          ele['paperPrice'] = '';\r\n        })\r\n      })\r\n\r\n    //\r\n    //\r\n    $http.get(api_url + '/tag/public/stage/grade')\r\n      .success(function(data) {\r\n        $scope.tags = data.stageList;\r\n      })\r\n\r\n    //\r\n    $http.get(api_url + '/tag?isPublic=1&tagType=3&isUse=1&page=1&size=1000')\r\n      .success(function(data) {\r\n        $scope.courses = data.tagList;\r\n      })\r\n\r\n  } else {\r\n    //\r\n    $http.get(api_url + '/goods/paper?goodsId=' + $scope.gid)\r\n      .success(function(data) {\r\n        $scope.goodName = data.goodsName;\r\n        $scope.totalPrice = data.price;\r\n        $scope.paperList = data.paperList;\r\n        $scope.endTime = data.validityEndTime;\r\n        $scope.someTagIds = [];\r\n        angular.forEach(data.tagList, function(ele) {\r\n            $scope.someTagIds.push(ele.tagId)\r\n          })\r\n          //\r\n        $http.get(api_url + '/tag/public/stage/grade')\r\n          .success(function(data) {\r\n            $scope.tags = data.stageList;\r\n            angular.forEach($scope.tags, function(ele) {\r\n              if ($scope.someTagIds.indexOf(ele.tagId) != -1) {\r\n                //\r\n                $scope.stageId = ele.tagId;\r\n                //\r\n                $scope.tagList = ele.gradeList;\r\n                $(\"#stage\").attr(\"disabled\", true)\r\n              }\r\n            })\r\n            angular.forEach($scope.tagList, function(ele) {\r\n              if ($scope.someTagIds.indexOf(ele.tagId) != -1) {\r\n                $scope.selectedClass.push(ele.tagId);\r\n              }\r\n            })\r\n          })\r\n\r\n        //\r\n        $http.get(api_url + '/tag?isPublic=1&tagType=3&isUse=1&page=1&size=1000')\r\n          .success(function(data) {\r\n            $scope.courses = data.tagList;\r\n            angular.forEach($scope.courses, function(ele) {\r\n              if ($scope.someTagIds.indexOf(ele.tagId) != -1) {\r\n                $scope.selectedCourse.push(ele.tagId);\r\n              }\r\n            })\r\n          })\r\n\r\n      })\r\n  }\r\n\r\n  //\r\n  $scope.getPrice = function(index, evt) {\r\n    if (isNaN(Number(evt.target.value))) {\r\n      evt.target.value = '0.00'\r\n      $scope.paperList[index].paperPrice = \"0.00\";\r\n    } else {\r\n      /*if (Number(evt.target.value) > 5) {\r\n        alert(\"!\")\r\n        evt.target.value = '0.00'\r\n        $scope.paperList[index].paperPrice = \"0.00\";\r\n      }*/\r\n      $scope.paperList[index].paperPrice = Number(Number(evt.target.value).toFixed(2));\r\n    }\r\n    $scope.totalPrice = 0.00;\r\n    $scope.paperList.map(function(i) {\r\n      $scope.totalPrice += Number(i.paperPrice)\r\n    })\r\n  }\r\n\r\n  //pid\r\n  $scope.deletePaper = function(idx) {\r\n    $scope.paperList.splice(idx, 1)\r\n      //\r\n    $scope.totalPrice = 0.00;\r\n    $scope.paperList.map(function(i) {\r\n      $scope.totalPrice += Number(i.paperPrice)\r\n    })\r\n  }\r\n\r\n  //\r\n  $scope.chooseStage = function() {\r\n    angular.forEach($scope.tags, function(ele) {\r\n      if (ele.tagId == $scope.stageId) {\r\n        $scope.tagList = ele.gradeList;\r\n      }\r\n    })\r\n  }\r\n\r\n  //,\r\n  $scope.chooseClass = function(id) {\r\n    var idx = $scope.selectedClass.indexOf(id);\r\n    if (idx == -1) {\r\n      $scope.selectedClass.push(id)\r\n    } else {\r\n      $scope.selectedClass.splice(idx, 1)\r\n    }\r\n    if ($scope.selectedClass.length) {\r\n      $(\"#stage\").attr(\"disabled\", true)\r\n    } else {\r\n      $(\"#stage\").removeAttr((\"disabled\"))\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.clearChoosen = function() {\r\n    $scope.selectedClass = [];\r\n    $(\"#stage\").removeAttr((\"disabled\"))\r\n  }\r\n\r\n  //\r\n  $scope.chooseCourse = function(id) {\r\n    var idx = $scope.selectedCourse.indexOf(id);\r\n    if (idx == -1) {\r\n      $scope.selectedCourse.push(id)\r\n    } else {\r\n      $scope.selectedCourse.splice(idx, 1)\r\n    }\r\n  }\r\n\r\n  $scope.confirm = function() {\r\n    if (!$scope.goodName || !$('.end-date').val()) {\r\n      alert(\"!\")\r\n      return\r\n    }\r\n    $scope.tagIds = [];\r\n    $scope.tagIds = $scope.tagIds.concat($scope.stageId).concat($scope.selectedClass).concat($scope.selectedCourse);\r\n    if ($scope.gid == 0) { //\r\n      var obj = {\r\n        \"goodsName\": $scope.goodName,\r\n        \"price\": $scope.totalPrice,\r\n        \"classificationId\": 100000, //!\r\n        \"validityEndTime\": $('.end-date').val(),\r\n        \"tagId\": $scope.tagIds,\r\n        \"paperList\": $scope.paperList\r\n      }\r\n      $http.post(api_url + '/goods', obj)\r\n        .success(function(data) {\r\n          if (!data.status) {\r\n            alert(\"!\");\r\n            $location.path('paper/public');\r\n          }\r\n        })\r\n    } else { //\r\n      //\r\n      $scope.postTags = [];\r\n      angular.forEach($scope.tagIds, function(ele) {\r\n        if ($scope.someTagIds.indexOf(ele) == -1) {\r\n          $scope.postTags.push(ele);\r\n        }\r\n      })\r\n\r\n      //\r\n      $scope.deleteTags = [];\r\n      angular.forEach($scope.someTagIds, function(ele) {\r\n        if ($scope.tagIds.indexOf(ele) == -1) {\r\n          $scope.deleteTags.push(ele);\r\n        }\r\n      })\r\n\r\n      var obj = {\r\n        \"goodsId\": $scope.gid,\r\n        \"goodsName\": $scope.goodName,\r\n        \"price\": $scope.totalPrice,\r\n        \"validityEndTime\": $('.end-date').val(),\r\n        \"tagAdd\": $scope.postTags,\r\n        \"tagDelete\": $scope.deleteTags,\r\n        \"paperList\": $scope.paperList\r\n      }\r\n      $http.put(api_url + '/goods', obj)\r\n        .success(function(data) {\r\n          if (!data.status) {\r\n            alert(\"!\");\r\n            $location.path('paper/public');\r\n          }\r\n        })\r\n\r\n    }\r\n  }\r\n\r\n}])\r\n\r\n\r\n//\r\napp.controller(\"paperPublic\", ['$scope', '$http', '$cookieStore', '$location', function($scope, $http, $cookieStore, $location) {\r\n  // $scope.type = Number($routeParams.type); //0--;1--;2--\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 10;\r\n\r\n  //\r\n  //\r\n  $http.get(api_url + '/tag/public/stage/grade')\r\n    .success(function(data) {\r\n      $scope.tags = data.stageList;\r\n      //\r\n      angular.forEach($scope.tags, function(ele) {\r\n        if (ele.tagId == 100002) {\r\n          $scope.gradeList = ele.gradeList;\r\n        }\r\n      })\r\n    })\r\n\r\n  //\r\n  $http.get(api_url + '/tag?isPublic=1&tagType=3&isUse=1&page=1&size=1000')\r\n    .success(function(data) {\r\n      $scope.courses = data.tagList;\r\n    })\r\n\r\n  //\r\n  $http.get(api_url + '/tag?isPublic=1&tagType=7&isUse=1&page=1&size=1000')\r\n    .success(function(data) {\r\n      $scope.versionList = data.tagList;\r\n    })\r\n\r\n  //\r\n  $http.get(api_url + '/tag?isPublic=1&tagType=8&isUse=1&page=1&size=1000')\r\n    .success(function(data) {\r\n      $scope.typeList = data.tagList;\r\n    })  \r\n\r\n  //\r\n  $scope.selectedGrade = [];\r\n  $scope.selectedCourse = []; //,\r\n  $scope.selectedVersion = [];\r\n  $scope.selectedPaperType = []\r\n  $scope.stageId = 100002;\r\n\r\n  //\r\n  $scope.getStage = function(id,type) {\r\n    $scope.payQuestion = type;\r\n    // alert('1'+ $scope.payQuestion);\r\n    if ($scope.stageId == id) return;\r\n    $scope.stageId = id;\r\n    $scope.gradeList = [];\r\n    $scope.selectedGrade = []\r\n    $scope.shareType = false;\r\n    $scope.tagIds = [];\r\n    $scope.tagIds = $scope.tagIds.concat($scope.selectedCourse).concat($scope.stageId);\r\n    $scope.currentPage = 1;\r\n    //\r\n    if ($scope.payQuestion){\r\n      $scope.getGoodsData();\r\n    } else {\r\n      $scope.getFreeDate();\r\n    }\r\n    angular.forEach($scope.tags, function(ele) {\r\n      if (ele.tagId == id) {\r\n        $scope.gradeList = ele.gradeList;\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  //\r\n  // $scope.shareType = true;\r\n  $scope.myShare = false;\r\n  $scope.freeQuestion = true;\r\n  $scope.payQuestion = false;\r\n\r\n  $scope.getMain = function() {\r\n    $scope.gradeList = [];\r\n    $scope.selectedCourse = [];\r\n    $scope.selectedGrade = [];\r\n    $scope.stageId = '';\r\n    $scope.currentPage = 1;\r\n    $scope.getData();\r\n    $scope.myShare = true;\r\n    $scope.freeQuestion = false;\r\n    $scope.payQuestion = false;\r\n  }\r\n\r\n  //\r\n  $scope.changeFreeType = function() {\r\n    $scope.myShare = false;\r\n    $scope.freeQuestion = true;\r\n    $scope.payQuestion = false;\r\n    \r\n    //\r\n    $scope.stageId = 100002;\r\n    $scope.gradeList = [];\r\n    $scope.selectedGrade = [];\r\n    $scope.shareType = false;\r\n    $scope.tagIds = [];\r\n    $scope.tagIds = $scope.tagIds.concat($scope.selectedCourse).concat($scope.stageId);\r\n    $scope.currentPage = 1;\r\n    $scope.getFreeDate();\r\n    angular.forEach($scope.tags, function(ele) {\r\n      if (ele.tagId == 100002) {\r\n        $scope.gradeList = ele.gradeList;\r\n      }\r\n    })\r\n  }\r\n  //\r\n  $scope.changePayType = function() {\r\n    $scope.myShare = false;\r\n    $scope.freeQuestion = false;\r\n    $scope.payQuestion = true;\r\n\r\n    //\r\n    $scope.stageId = 100002;\r\n    $scope.gradeList = [];\r\n    $scope.selectedGrade = [];\r\n    $scope.shareType = false;\r\n    $scope.tagIds = [];\r\n    $scope.tagIds = $scope.tagIds.concat($scope.selectedCourse).concat($scope.stageId);\r\n    $scope.currentPage = 1;\r\n    $scope.getGoodsData();\r\n    angular.forEach($scope.tags, function(ele) {\r\n      if (ele.tagId == 100002) {\r\n        $scope.gradeList = ele.gradeList;\r\n      }\r\n    })\r\n  }\r\n\r\n  //\r\n  $scope.chooseGrade = function(id,type) {\r\n    $scope.payQuestion = type;\r\n    var idx = $scope.selectedGrade.indexOf(id);\r\n    // alert(idx);\r\n    if (idx == -1) {\r\n      $scope.selectedGrade.push(id)\r\n    } else {\r\n      $scope.selectedGrade.splice(idx, 1)\r\n    }\r\n    $scope.tagIds = [];\r\n    $scope.tagIds = $scope.tagIds.concat($scope.selectedPaperType).concat($scope.selectedVersion).concat($scope.selectedCourse).concat($scope.selectedGrade).concat($scope.stageId);\r\n    $scope.currentPage = 1;\r\n    //\r\n    if ($scope.payQuestion){\r\n      $scope.getGoodsData();\r\n    } else {\r\n      $scope.getFreeDate();\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.chooseCourse = function(id,type) {\r\n    $scope.payQuestion = type;\r\n    var idx = $scope.selectedCourse.indexOf(id);\r\n    if (idx == -1) {\r\n      $scope.selectedCourse.push(id)\r\n    } else {\r\n      $scope.selectedCourse.splice(idx, 1)\r\n    }\r\n    $scope.tagIds = [];\r\n    $scope.tagIds = $scope.tagIds.concat($scope.selectedPaperType).concat($scope.selectedVersion).concat($scope.selectedCourse).concat($scope.selectedGrade).concat($scope.stageId);\r\n    $scope.currentPage = 1;\r\n    //\r\n    if ($scope.payQuestion){\r\n      $scope.getGoodsData();\r\n    } else {\r\n      $scope.getFreeDate();\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.chooseVersion = function(id,type){\r\n    $scope.payQuestion = type;\r\n    var idx = $scope.selectedVersion.indexOf(id);\r\n    // alert(idx);\r\n    if (idx == -1) {\r\n      $scope.selectedVersion.push(id)\r\n    } else {\r\n      $scope.selectedVersion.splice(idx, 1)\r\n    }\r\n    $scope.tagIds = [];\r\n    $scope.tagIds = $scope.tagIds.concat($scope.selectedPaperType).concat($scope.selectedVersion).concat($scope.selectedCourse).concat($scope.selectedGrade).concat($scope.stageId);\r\n    $scope.currentPage = 1;\r\n    //\r\n    if ($scope.payQuestion){\r\n      $scope.getGoodsData();\r\n    } else {\r\n      $scope.getFreeDate();\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.choosePaperType = function(id,type){\r\n    $scope.payQuestion = type;\r\n    var idx = $scope.selectedPaperType.indexOf(id);\r\n    if (idx == -1) {\r\n      $scope.selectedPaperType.push(id)\r\n    } else {\r\n      $scope.selectedPaperType.splice(idx, 1)\r\n    }\r\n    $scope.tagIds = [];\r\n    $scope.tagIds = $scope.tagIds.concat($scope.selectedPaperType).concat($scope.selectedVersion).concat($scope.selectedCourse).concat($scope.selectedGrade).concat($scope.stageId);\r\n    $scope.currentPage = 1;\r\n    //\r\n    if ($scope.payQuestion){\r\n      $scope.getGoodsData();\r\n    } else {\r\n      $scope.getFreeDate();\r\n    }\r\n  }\r\n\r\n\r\n  //\r\n  $scope.next = function(type) { //\r\n    $scope.payQuestion = type;\r\n    if ($scope.currentPage < $scope.num) {\r\n      $scope.currentPage++;\r\n      if ($scope.shareType) {\r\n        $scope.getData();\r\n      } else if ($scope.payQuestion){\r\n        $scope.getGoodsData();\r\n      } else if (!$scope.payQuestion){\r\n        $scope.getFreeDate();\r\n      }\r\n    }\r\n  };\r\n  $scope.prev = function(type) { //  \r\n    $scope.payQuestion = type;             \r\n    if ($scope.currentPage > 1) {\r\n      $scope.currentPage--;\r\n      if ($scope.shareType) {\r\n        $scope.getData();\r\n      } else if ($scope.payQuestion){\r\n        $scope.getGoodsData();\r\n      } else if (!$scope.payQuestion){\r\n        $scope.getFreeDate();\r\n      }\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.getData = function() {\r\n    $http.get(api_url + \"/goods/paper/teacher?type=0&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        $scope.count = data.count;\r\n        if ($scope.count == 0) { //\r\n          $scope.num = 1;\r\n          $scope.goodslist = [];\r\n        } else {\r\n          $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n          $scope.goodslist = data.goodsList;\r\n          angular.forEach($scope.goodslist, function(ele) {\r\n            ele[\"show\"] = false;\r\n            // ele[\"showDesc\"] = false;\r\n          })\r\n        }\r\n      })\r\n  }\r\n\r\n  //\r\n  $scope.getGoodsData = function() {\r\n    $http.get(api_url + \"/goods/paper/shop?tagId=[\" + $scope.tagIds + \"]&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          $scope.count = data.count;\r\n          if ($scope.count == 0) { //\r\n            $scope.num = 1;\r\n            $scope.goodslist = [];\r\n            $scope.paperDate = true;\r\n          } else {\r\n            $scope.paperDate = false;\r\n            $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n            $scope.goodslist = data.goodsList;\r\n            angular.forEach($scope.goodslist, function(ele) {\r\n              ele[\"show\"] = false;\r\n              // ele[\"showDesc\"] = false;\r\n            })\r\n          }\r\n        } else {\r\n          $scope.num = 1;\r\n          $scope.goodslist = [];\r\n          $scope.paperDate = true;\r\n        }\r\n      })\r\n  }\r\n\r\n  //\r\n  $scope.paperDate = false;\r\n  //\r\n  $scope.tagIds = [100002];\r\n  $scope.getFreeDate = function(){\r\n    $http.get(api_url + \"/question/bank/paper/list?tagId=[\" + $scope.tagIds + \"]&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        $scope.dataStatus = data.status;\r\n        if ($scope.dataStatus == 0) {\r\n          $scope.paperDate = false;\r\n          $scope.count = data.count;\r\n          if ($scope.count == 0) { //\r\n            $scope.num = 1;\r\n            $scope.freeList = [];\r\n          } else {\r\n            $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n            $scope.freeList = data.paperList;\r\n            angular.forEach($scope.freeList, function(ele) {\r\n              ele[\"show\"] = false;\r\n              // ele[\"showDesc\"] = false;\r\n            })\r\n          }\r\n        } else {\r\n          $scope.num = 1;\r\n          $scope.freeList = [];\r\n          $scope.paperDate = true;\r\n        }\r\n      })\r\n  }\r\n  //\r\n  $scope.getFreeDate();\r\n\r\n  //\r\n  $scope.toggle = function(id, index) {\r\n    if ($scope.goodslist[index].show) {\r\n      $scope.goodslist[index].show = false\r\n    } else {\r\n      angular.forEach($scope.goodslist, function(ele) {\r\n        ele[\"show\"] = false;\r\n      })\r\n      $scope.goodslist[index].show = true;\r\n    }\r\n    $http.get(api_url + \"/goods/paper/list?goodsId=\" + id)\r\n      .success(function(data) {\r\n        $scope.paperlist = data.paperList;\r\n      })\r\n  }\r\n\r\n  //()\r\n  $scope.changePayShowType = function(){\r\n    $scope.payShowType = !$scope.payShowType;\r\n  }\r\n  //\r\n  $scope.changeFreeShowType = function(){\r\n    $scope.freeShowType = !$scope.freeShowType;\r\n  }\r\n\r\n}]);\r\n\r\n\r\n//\r\napp.controller(\"paperName\", ['$scope', '$http', '$cookieStore', '$location', '$routeParams', function($scope, $http, $cookieStore, $location, $routeParams) {\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.size = 12;\r\n  $scope.tagList = []; //tag\r\n\r\n  //()\r\n  $scope.getTagList = function() {\r\n    $http.get(api_url + \"/tag/test/paper/achieve?pid=\" + $routeParams.pid + \"&page=1&size=9999\")\r\n      .success(function(data) {\r\n        $scope.oldList = data.tagList;\r\n        $scope.tagList = $scope.tagList.concat($scope.oldList)\r\n\r\n        $scope.oldTagIds = []; //tagId\r\n        $scope.oldIds = []; //id()\r\n        angular.forEach($scope.oldList, function(ele) {\r\n          $scope.oldTagIds.push(ele.tagId);\r\n          $scope.oldIds.push(ele.id);\r\n        })\r\n\r\n        $scope.uploadArr();\r\n      })\r\n  }\r\n\r\n  if ($routeParams.pid) {\r\n    //\r\n    $http.get(api_url + \"/test/paper?pid=\" + $routeParams.pid)\r\n      .success(function(data) {\r\n        $scope.pname = data.paperName;\r\n      })\r\n\r\n    $scope.getTagList();\r\n  };\r\n\r\n\r\n  //\r\n  $scope.getPublic = function() {\r\n    $http.get(api_url + \"/tag?isPublic=1&tagType=5&page=\" + $scope.publicPage + \"&size=\" + $scope.size)\r\n      .success(function(data) {\r\n        $scope.publicTagList = $scope.publicTagList.concat(data.tagList);\r\n        if ($scope.publicPage * $scope.size < data.count) {\r\n          $scope.publicMore = true;\r\n        } else {\r\n          $scope.publicMore = false;\r\n        }\r\n      })\r\n  }\r\n\r\n  $scope.morePublic = function() {\r\n    $scope.publicPage++;\r\n    $scope.getPublic();\r\n  }\r\n\r\n  //\r\n  $scope.getPrivate = function() {\r\n    $http.get(api_url + \"/tag?isPublic=0&tagType=5&page=\" + $scope.privatePage + \"&size=\" + $scope.size)\r\n      .success(function(data) {\r\n        $scope.privateTagList = $scope.privateTagList.concat(data.tagList);\r\n        if ($scope.privatePage * $scope.size < data.count) {\r\n          $scope.privateMore = true;\r\n        } else {\r\n          $scope.privateMore = false;\r\n        }\r\n      })\r\n  }\r\n\r\n  $scope.morePrivate = function() {\r\n    $scope.privatePage++;\r\n    $scope.getPrivate();\r\n  }\r\n\r\n  $scope.newTag = function() {\r\n    if ($scope.addTagName) {\r\n      if ($scope.addTagName.length > 8) {\r\n        alert(\"!\")\r\n        return;\r\n      }\r\n      $http.post(api_url + '/tag', {\r\n        \"isPublic\": 0,\r\n        \"tagType\": 5,\r\n        \"tagName\": $scope.addTagName,\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.privatePage = 1;\r\n          $scope.privateTagList = [];\r\n          $scope.getPrivate();\r\n        }\r\n      })\r\n    }\r\n    $scope.addTag = false;\r\n    $scope.addTagName = \"\";\r\n  }\r\n\r\n  //\r\n  $scope.deleteTag = function(index) {\r\n    $scope.tagList.splice(index, 1);\r\n    $scope.uploadArr();\r\n  }\r\n\r\n  $scope.openModal = function() {\r\n    $scope.tagModal = true;\r\n\r\n    $scope.publicPage = 1;\r\n    $scope.privatePage = 1;\r\n\r\n    $scope.publicTagList = [];\r\n    $scope.privateTagList = [];\r\n\r\n    $scope.getPublic();\r\n    $scope.getPrivate();\r\n\r\n    $scope.tempTagArr = [];\r\n    $scope.tempTagArr = $scope.tempTagArr.concat($scope.tagList)\r\n\r\n    $scope.uploadArr();\r\n  }\r\n\r\n  $scope.chooseTag = function(obj) {\r\n    var index = $scope.selectedTagIds.indexOf(obj.tagId)\r\n    if (index == -1) {\r\n      $scope.tempTagArr.push(obj);\r\n      $scope.selectedTagIds.push(obj.tagId);\r\n    } else {\r\n      $scope.tempTagArr.splice(index, 1)\r\n      $scope.selectedTagIds.splice(index, 1)\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.uploadArr = function() {\r\n    $scope.selectedTagIds = []; //tagId\r\n    $scope.selectedIds = []; //id()\r\n    angular.forEach($scope.tagList, function(ele) {\r\n      $scope.selectedTagIds.push(ele.tagId);\r\n      $scope.selectedIds.push(ele.id);\r\n    })\r\n  }\r\n\r\n  $scope.hideModal = function() {\r\n    $scope.tagModal = false;\r\n    $scope.uploadArr();\r\n  }\r\n\r\n  $scope.confirm = function() {\r\n    $scope.tagModal = false;\r\n    $scope.tagList = $scope.tempTagArr;\r\n    $scope.uploadArr();\r\n  }\r\n\r\n  //\r\n  $scope.nextstep = function() {\r\n    if (!$scope.pname) {\r\n      alert(\"!\");\r\n      return;\r\n    } else if ($scope.pname.length > 50) {\r\n      alert(\"50\");\r\n      return;\r\n    } else {\r\n      $scope.pname = $scope.pname.trim();\r\n    }\r\n\r\n    if (!$routeParams.pid) {\r\n      //\r\n      $http.post(api_url + \"/test/paper\", {\r\n        \"paperName\": $scope.pname,\r\n        \"tagId\": $scope.selectedTagIds\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $location.path(\"/paper/input/\" + data.pid);\r\n        }\r\n      })\r\n\r\n    } else {\r\n      //\r\n      $scope.postTags = [];\r\n      angular.forEach($scope.selectedTagIds, function(ele) {\r\n        if ($scope.oldTagIds.indexOf(ele) == -1) {\r\n          $scope.postTags.push(ele);\r\n        }\r\n      })\r\n\r\n      //\r\n      $scope.deleteTags = [];\r\n      angular.forEach($scope.oldIds, function(ele) {\r\n        if ($scope.selectedIds.indexOf(ele) == -1) {\r\n          $scope.deleteTags.push(ele);\r\n        }\r\n      })\r\n\r\n      //\r\n      $http.put(api_url + \"/test/paper\", {\r\n        \"pid\": parseInt($routeParams.pid),\r\n        \"paperName\": $scope.pname\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          //\r\n          if ($scope.postTags.length && $scope.deleteTags.length) {\r\n            $http.post(api_url + \"/tag/test/paper\", {\r\n              \"pid\": parseInt($routeParams.pid),\r\n              \"tagId\": $scope.postTags\r\n            }).success(function(data) {\r\n              if (!data.status) {\r\n                $http({\r\n                  method: \"DELETE\",\r\n                  url: api_url + '/tag/test/paper',\r\n                  data: { \"id\": $scope.deleteTags },\r\n                  headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n                }).success(function(data) {\r\n                  if (!data.status) {\r\n                    $location.path(\"/paper/input/\" + $routeParams.pid);\r\n                  }\r\n                })\r\n              }\r\n            })\r\n          } else if ($scope.postTags.length && !$scope.deleteTags.length) {\r\n            $http.post(api_url + \"/tag/test/paper\", {\r\n              \"pid\": parseInt($routeParams.pid),\r\n              \"tagId\": $scope.postTags\r\n            }).success(function(data) {\r\n              if (!data.status) {\r\n                $location.path(\"/paper/input/\" + $routeParams.pid);\r\n              }\r\n            })\r\n          } else if (!$scope.postTags.length && $scope.deleteTags.length) {\r\n            $http({\r\n              method: \"DELETE\",\r\n              url: api_url + '/tag/test/paper',\r\n              data: { \"id\": $scope.deleteTags },\r\n              headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n            }).success(function(data) {\r\n              if (!data.status) {\r\n                $location.path(\"/paper/input/\" + $routeParams.pid);\r\n              }\r\n            })\r\n          } else {\r\n            $location.path(\"/paper/input/\" + $routeParams.pid);\r\n          }\r\n\r\n        }\r\n      })\r\n\r\n    }\r\n  };\r\n\r\n}])\r\n\r\n\r\n//\r\napp.controller(\"paperTag\", ['$scope', '$http', function($scope, $http) {\r\n  $scope.publicPaperPage = 1;\r\n  $scope.privatePaperPage = 1;\r\n  $scope.publicQuestionPage = 1;\r\n  $scope.privateQuestionPage = 1;\r\n  $scope.size = 12;\r\n\r\n  $scope.publicPaperTagList = [];\r\n  $scope.privatePaperTagList = [];\r\n  $scope.publicQuestionTagList = [];\r\n  $scope.privateQuestionTagList = [];\r\n\r\n  $scope.tagType = 1;\r\n\r\n  //\r\n  $scope.getPaperPublic = function() {\r\n    $http.get(api_url + \"/tag?isPublic=1&tagType=5&page=\" + $scope.publicPaperPage + \"&size=\" + $scope.size)\r\n      .success(function(data) {\r\n        $scope.publicPaperTagList = $scope.publicPaperTagList.concat(data.tagList);\r\n        if ($scope.publicPaperPage * $scope.size < data.count) {\r\n          $scope.publicPaperMore = true;\r\n        } else {\r\n          $scope.publicPaperMore = false;\r\n        }\r\n      })\r\n  }\r\n  $scope.getPaperPublic();\r\n\r\n  $scope.morePaperPublic = function() {\r\n    $scope.publicPaperPage++;\r\n    $scope.getPaperPublic();\r\n  }\r\n\r\n  //\r\n  $scope.getPaperPrivate = function() {\r\n    $http.get(api_url + \"/tag?isPublic=0&tagType=5&page=\" + $scope.privatePaperPage + \"&size=\" + $scope.size)\r\n      .success(function(data) {\r\n        $scope.privatePaperTagList = $scope.privatePaperTagList.concat(data.tagList);\r\n        if ($scope.privatePaperPage * $scope.size < data.count) {\r\n          $scope.privatePaperMore = true;\r\n        } else {\r\n          $scope.privatePaperMore = false;\r\n        }\r\n      })\r\n  }\r\n  $scope.getPaperPrivate();\r\n\r\n  $scope.morePaperPrivate = function() {\r\n    $scope.privatePaperPage++;\r\n    $scope.getPaperPrivate();\r\n  }\r\n\r\n  $scope.newPaperTag = function() {\r\n    // alert('12');\r\n    if ($scope.addPaperTagName) {\r\n      if ($scope.addPaperTagName.length > 8) {\r\n        alert(\"!\")\r\n        return;\r\n      }\r\n      $http.post(api_url + '/tag', {\r\n        \"isPublic\": 0,\r\n        \"tagType\": 5,\r\n        \"tagName\": $scope.addPaperTagName,\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.privatePaperPage = 1;\r\n          $scope.privatePaperTagList = [];\r\n          $scope.getPaperPrivate();\r\n        }\r\n      })\r\n    }\r\n    $scope.addPaperTag = false;\r\n    $scope.addPaperTagName = \"\";\r\n  }\r\n\r\n  $scope.deletePaperTag = function(id) {\r\n    $http({\r\n      method: \"DELETE\",\r\n      url: api_url + '/tag',\r\n      data: { \"tagId\": [id] },\r\n      headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n    }).success(function(data) {\r\n      if (!data.status) {\r\n        $scope.privatePaperPage = 1;\r\n        $scope.privatePaperTagList = [];\r\n        $scope.getPaperPrivate();\r\n      }\r\n    })\r\n  }\r\n\r\n//\r\n  //\r\n  $scope.getQuestionPublic = function() {\r\n    $http.get(api_url + \"/tag?isPublic=1&tagType=6&page=\" + $scope.publicQuestionPage + \"&size=\" + $scope.size)\r\n      .success(function(data) {\r\n        $scope.publicQuestionTagList = $scope.publicQuestionTagList.concat(data.tagList);\r\n        if ($scope.publicQuestionPage * $scope.size < data.count) {\r\n          $scope.publicQuestionMore = true;\r\n        } else {\r\n          $scope.publicQuestionMore = false;\r\n        }\r\n      })\r\n  }\r\n  $scope.getQuestionPublic();\r\n\r\n  $scope.moreQuestionPublic = function() {\r\n    $scope.publicQuestionPage++;\r\n    $scope.getQuestionPublic();\r\n  }\r\n\r\n  //\r\n  $scope.getQuestionPrivate = function() {\r\n    $http.get(api_url + \"/tag?isPublic=0&tagType=6&page=\" + $scope.privateQuestionPage + \"&size=\" + $scope.size)\r\n      .success(function(data) {\r\n        $scope.privateQuestionTagList = $scope.privateQuestionTagList.concat(data.tagList);\r\n        if ($scope.privateQuestionPage * $scope.size < data.count) {\r\n          $scope.privateQuestionMore = true;\r\n        } else {\r\n          $scope.privateQuestionMore = false;\r\n        }\r\n      })\r\n  }\r\n  $scope.getQuestionPrivate();\r\n\r\n  $scope.moreQuestionPrivate = function() {\r\n    $scope.privateQuestionPage++;\r\n    $scope.getQuestionPrivate();\r\n  }\r\n\r\n  $scope.newQuestionTag = function() {\r\n    // console.log($scope.addQuestionTagName);\r\n    if ($scope.addQuestionTagName) {\r\n      if ($scope.addQuestionTagName.length > 8) {\r\n        alert(\"!\")\r\n        return;\r\n      }\r\n      var obj = {\r\n        \"isPublic\": 0,\r\n        \"tagType\": 6,\r\n        \"tagName\": $scope.addQuestionTagName\r\n      }\r\n      // console.log(obj);\r\n      $http.post(api_url + '/tag', obj).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.privateQuestionPage = 1;\r\n          $scope.privateQuestionTagList = [];\r\n          $scope.getQuestionPrivate();\r\n        }\r\n      })\r\n    }\r\n    $scope.addQuestionTag = false;\r\n    $scope.addQuestionTagName = \"\";\r\n  }\r\n\r\n  $scope.deleteQuestionTag = function(id) {\r\n    $http({\r\n      method: \"DELETE\",\r\n      url: api_url + '/tag',\r\n      data: { \"tagId\": [id] },\r\n      headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n    }).success(function(data) {\r\n      if (!data.status) {\r\n        $scope.privateQuestionPage = 1;\r\n        $scope.privateQuestionTagList = [];\r\n        $scope.getQuestionPrivate();\r\n      }\r\n    })\r\n  }\r\n//\r\n  $scope.checkTagType = function(type){\r\n    // alert(''+ type);\r\n    $scope.tagType = type;\r\n  }\r\n\r\n}])\r\n\r\n\r\n//\r\napp.controller(\"paperInput\", ['$scope', '$http', '$cookieStore', '$location', '$routeParams', '$compile', function($scope, $http, $cookieStore, $location, $routeParams, $compile) {\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.token = $cookieStore.get(\"user\").token;\r\n  $scope.pid = $routeParams.pid;\r\n  //\r\n  $http.get(api_url + \"/test/paper/preview?pid=\" + $scope.pid)\r\n    .success(function(data) {\r\n      if (!data.status) {\r\n        $scope.paper = data.paper;\r\n        $scope.pname = data.paper.paperName;\r\n        $scope.questions = data.questions;\r\n        // mid\r\n        // console.log($scope.questions);\r\n        if($scope.questions){\r\n          for(var b=0; b < $scope.questions.length; b++){\r\n            var questionObj = $scope.questions[b];\r\n            if(questionObj.qDigest){\r\n              delete questionObj.mid;\r\n            }\r\n          }\r\n        }\r\n        // console.log($scope.questions);\r\n        if (data.stem) {\r\n          $scope.stems = data.stem;\r\n        };\r\n\r\n        //\r\n        $http.get(api_url + \"/tag/test/question/achieve/paper?pid=\" + $scope.pid)\r\n          .success(function(res) {\r\n            if (!res.status) {\r\n              angular.forEach(res.questions, function(ele) {\r\n                angular.forEach($scope.questions, function(element) {\r\n                  if (ele.qid && element.qid && ele.qid === element.qid) {\r\n                    element['tagList'] = ele.tagList;\r\n                  }\r\n                })\r\n              })\r\n              if (res.stem) {\r\n                for (var k in res.stem) {\r\n                  angular.forEach($scope.stems[k], function(ele) {\r\n                    angular.forEach(res.stem[k], function(element) {\r\n                      if (ele.qid == element.qid) {\r\n                        ele['tagList'] = element.tagList;\r\n                      }\r\n                    })\r\n                  })\r\n                }\r\n              };\r\n\r\n            }\r\n          })\r\n\r\n        $scope.titList = [];\r\n        $scope.totalScore = 0;\r\n        var len = 0; //\r\n        //paperquestion\r\n        if ($scope.paper.paperStructJson && $scope.paper.paperStructJson.length != 0) {\r\n          //\r\n          $scope.ans = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"];\r\n          for (var i = 0; i < $scope.paper.paperStructJson.length; i++) {\r\n            /*if ($scope.questions[i]) { //\r\n              $scope.questions[i].isComposite = $scope.paper.paperStructJson[i].isComposite;\r\n            }*/\r\n\r\n            //\r\n            // if ($scope.paper.paperStructJson[i].isComposite == 1) { //\r\n            if ($scope.paper.paperStructJson[i].mid) { //\r\n              for (var j = 0; j < $scope.paper.paperStructJson[i].stem.length; j++) {\r\n                //$scope.titList.push(i+)\r\n                $scope.titList[len] = {};\r\n                var mid = $scope.paper.paperStructJson[i].mid;\r\n                $scope.titList[len]['list'] = (i + 1) + '-' + (j + 1);\r\n                if (!$scope.stems[mid][j].qScore) {\r\n                  $scope.titList[len]['qScore'] = 0;\r\n                } else {\r\n                  $scope.titList[len]['qScore'] = Number($scope.stems[mid][j].qScore);\r\n                }\r\n                $scope.totalScore += $scope.titList[len]['qScore'];\r\n                len++;\r\n              }\r\n            } else {\r\n              $scope.titList[len] = {};\r\n              $scope.titList[len]['list'] = i + 1;\r\n              // if (!$scope.questions[i].score) {\r\n\r\n              if ($scope.questions[i]['qScore'] && $scope.questions[i]['qScore'] != 0) {\r\n                $scope.titList[len]['qScore'] = Number($scope.questions[i].qScore);\r\n              } else {\r\n                $scope.titList[len]['qScore'] = 0;\r\n              }\r\n              $scope.totalScore += $scope.titList[len]['qScore'];\r\n              len++;\r\n            }\r\n\r\n          };\r\n        } else {\r\n          // \r\n          $(\".add-new-common\").click();\r\n        }\r\n      }\r\n\r\n    });\r\n  //\r\n  $scope.toTop = function() {\r\n    $(\"body,html\").animate({ scrollTop: 0 });\r\n  };\r\n\r\n  //\r\n  $http.get(api_url + \"/tag?isPublic=1&tagType=6&page=1&size=9999999\")\r\n    .success(function(data) {\r\n      $scope.publicTagList = data.tagList;\r\n    })\r\n\r\n  //\r\n  $http.get(api_url + \"/tag?isPublic=0&tagType=6&page=1&size=9999999\")\r\n    .success(function(data) {\r\n      $scope.privateTagList = data.tagList;\r\n    })\r\n\r\n  $scope.assist = function() {\r\n    $scope.assistModal = true;\r\n    $scope.tip = \"\";\r\n    $scope.require = '';\r\n    $scope.wordUrl = '';\r\n    angular.element(\"#file\").val('');\r\n  }\r\n\r\n  $scope.wordUpload = function() {\r\n    angular.element(\"#file\").click();\r\n  }\r\n\r\n  function handleFileSelect(evt) {\r\n    var files = evt.target.files,\r\n      f = files[0];\r\n\r\n    if (f.name.indexOf('.doc') == -1) {\r\n      alert(\"word!\");\r\n      return;\r\n    }\r\n\r\n    $(\"#redactor_modal_overlay\").css(\"display\", \"block\");\r\n\r\n    var formData = new FormData($(\"#uploadPicForm\")[0]);\r\n    if (!files.length) {\r\n      toastr.info(\"\");\r\n      return;\r\n    }\r\n\r\n    //\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.upload.addEventListener(\"progress\", uploadProgress, false);\r\n    xhr.upload.addEventListener(\"load\", loadedProgress, false);\r\n    xhr.open(\"POST\", api_url + \"/upload?type=3&token=\" + $scope.token);\r\n    //\r\n    function uploadProgress(evt) {\r\n      if (evt.lengthComputable) {\r\n        var percentComplete = Math.round(evt.loaded * 100 / evt.total);\r\n\r\n        $scope.$apply(function() {\r\n          $scope.progress = percentComplete.toString() + '%';\r\n        })\r\n\r\n      }\r\n    }\r\n    //\r\n    function loadedProgress(evt) {\r\n      $(\"#redactor_modal_overlay\").css(\"display\", \"none\");\r\n      $scope.$apply(function() {\r\n        $scope.tip = f.name;\r\n      })\r\n    }\r\n\r\n    xhr.send(formData);\r\n\r\n    xhr.onreadystatechange = function() {\r\n      if (xhr.readyState == 4) {\r\n        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304) {\r\n          $scope.wordUrl = JSON.parse(xhr.responseText).data.url;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  document.getElementById('file').addEventListener('change', handleFileSelect, false);\r\n\r\n  $scope.confirmAssist = function() {\r\n    if ($scope.wordUrl && $scope.require) {\r\n      $http.post(api_url + '/assist/test/paper/input', {\r\n        \"applyExplain\": $scope.require,\r\n        \"resourcesName\": $scope.tip,\r\n        \"resourcesUrl\": $scope.wordUrl\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.assistModal = false;\r\n        }\r\n      })\r\n    } else {\r\n      alert(\"!\")\r\n    }\r\n  }\r\n\r\n}])\r\n\r\n\r\n//\r\napp.controller(\"paperPreview\", ['$scope', '$http', '$cookieStore', '$routeParams', '$location', 'mxxServices', function($scope, $http, $cookieStore, $routeParams, $location, mxxServices) {\r\n  $scope.pid = $routeParams.pid;\r\n  $scope.back = function() {\r\n    $location.path(\"/paper/input/\" + $scope.pid);\r\n  };\r\n\r\n  //\r\n  mxxServices.getPaperData($scope);\r\n\r\n  //\r\n  $scope.goto = function(index) {\r\n    var $detail = $('.paper-preview-detail');\r\n    var $dt = $detail.find(\"dt:lt(\" + index + \")\");\r\n\r\n    //\r\n    var dt_top = 0;\r\n    if ($dt.size()) {\r\n      $.each($dt, function(k) {\r\n        var _top = ($(this).height()) + 20;\r\n        dt_top = dt_top + _top;\r\n      });\r\n    };\r\n    $detail.animate({ scrollTop: dt_top });\r\n  }\r\n\r\n  //,\r\n  $scope.confirm = function() {\r\n    $(\"#redactor_modal_overlay\").css(\"display\", \"block\");\r\n    $http.post(api_url + \"/test/paper/confirm\", {\r\n      \"pid\": [Number($scope.pid)]\r\n    }).success(function(data) {\r\n      $(\"#redactor_modal_overlay\").css(\"display\", \"none\");\r\n      if (!data.status) {\r\n        $location.path(\"/paper/complete/\" + $scope.pid)\r\n      }\r\n    })\r\n  }\r\n}])\r\n\r\n//\r\napp.controller(\"wxPreview\", ['$scope', '$http', '$cookieStore', '$routeParams', '$location', 'mxxServices', function($scope, $http, $cookieStore, $routeParams, $location, mxxServices) {\r\n  $scope.pid = Number($routeParams.pid);\r\n  $scope.back = function() {\r\n    $location.path(\"/paper/list/0\");\r\n  };\r\n\r\n  mxxServices.getPaperData($scope);\r\n\r\n  //\r\n  $scope.goto = function(index) {\r\n    var $detail = $('.paper-preview-detail');\r\n    var $dt = $detail.find(\"dt:lt(\" + index + \")\");\r\n\r\n    //\r\n    var dt_top = 0;\r\n    if ($dt.size()) {\r\n      $.each($dt, function(k) {\r\n        var _top = ($(this).height()) + 20;\r\n        dt_top = dt_top + _top;\r\n      });\r\n    };\r\n    $detail.animate({ scrollTop: dt_top });\r\n  };\r\n\r\n  //\r\n  /*$http.get(api_url + \"/test/paper?pid=\" + $scope.pid)\r\n    .success(function(data) {\r\n      $scope.paperInfo = data;\r\n    });*/\r\n\r\n  //\r\n  var url = \"http://www.maixuexi.cn/phone/#/preview/\" + $scope.pid;\r\n\r\n  //\r\n  mxxServices.qrCode($(\".wxQrcode\"), url);\r\n\r\n\r\n\r\n\r\n  //\r\n  $scope.showQrcode = function() {\r\n    $(\".view-code\").css(\"display\", \"block\")\r\n  };\r\n  $scope.hiddenQrcode = function() {\r\n    $(\".view-code\").css(\"display\", \"none\")\r\n  };\r\n\r\n  //\r\n  $scope.shareModal = function() {\r\n    $scope.myModal = true;\r\n    $scope.teacherName = \"\";\r\n    $scope.searchName = \"\";\r\n  }\r\n\r\n  //\r\n  $scope.obtainPaper = function(id) {\r\n    $scope.pid = id;\r\n    // alert('pid'+ $scope.pid);\r\n    $http.post(api_url + \"/question/bank/paper/get\", {\r\n        \"pid\": [$scope.pid]\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.myModal = false;\r\n          $location.path(\"/paper/list/0\");\r\n        }\r\n      })\r\n  }\r\n\r\n  //\r\n  var accountExp = /^[a-zA-Z]\\w+$/,\r\n    phoneExp = /^1[34578]\\d{9}$/,\r\n    mailExp = /^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$/;\r\n\r\n  //XX\r\n  $scope.search = function() {\r\n    if ($scope.searchName) {\r\n      var obj = {};\r\n      if (mailExp.test($scope.searchName)) {\r\n        obj.email = $scope.searchName;\r\n      } else if (phoneExp.test($scope.searchName)) {\r\n        obj.phone = $scope.searchName;\r\n      } else if (accountExp.test($scope.searchName)) {\r\n        obj.account = $scope.searchName;\r\n      } else {\r\n        alert('!');\r\n        return;\r\n      }\r\n      $http.put(api_url + \"/teacher/info\", obj)\r\n        .success(function(data) {\r\n          if (!data.status) {\r\n            $scope.tid = data.tid;\r\n            $scope.teacherName = data.teacherName;\r\n          } else {\r\n            $scope.teacherName = \"\";\r\n          }\r\n        })\r\n    }\r\n  }\r\n\r\n  $scope.confirm = function() {\r\n    if ($scope.teacherName) {\r\n      $http.post(api_url + \"/test/paper/share\", {\r\n        \"pid\": $scope.pid,\r\n        \"tid\": $scope.tid\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.myModal = false;\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  // \r\n  $scope.showShareBtn = false;\r\n  // console.log($scope.showShareBtn);\r\n  $scope.qid;\r\n  $scope.mid;\r\n  $scope.index;\r\n  $scope.childIndex;\r\n//   {\r\n//     \"pid\":1,\r\n//     \"qid\":1,\r\n//     \"mid\":1,\r\n//     \"endTime\":\"2018-01-04 12:00:00\",\r\n//     \"answerShowTime\":\"2018-01-04 12:00:00\"\r\n// }\r\n  // \r\n  $scope.shareModalBox = false;\r\n  $scope.goToShareList = false;\r\n  // \r\n  $scope.shareQuestion = function(qid,mid,index,childIndex) {\r\n    // alert('')\r\n    // \r\n    $scope.showShareBtnQid = qid;\r\n    $scope.showShareBtn = true;\r\n\r\n    $scope.goToShareList = false;\r\n    // console.log(qid,mid,index,childIndex);\r\n    $scope.qid = qid;\r\n    if(mid){\r\n      $scope.mid = mid;\r\n    }\r\n    $scope.index = index;\r\n    if(childIndex){\r\n      // \r\n      $scope.childIndex = childIndex;\r\n    }\r\n    $scope.index = index;\r\n    $scope.shareModalBox = true;\r\n  }\r\n\r\n  // console.log($scope.noticeTime)\r\n\r\n  $scope.cancelShare = function(){\r\n    $scope.showShareBtn = false;\r\n  }\r\n\r\n  $scope.confirmShare = function(){\r\n    // $scope.showShareBtn = false;\r\n    //\r\n    if (!$(\".noticeTime\").val()) {\r\n      $scope.noticeTime = \"\";\r\n    } else {\r\n      $scope.noticeTime = $(\".noticeTime\").val();\r\n    }\r\n    // console.log($scope.noticeTime)\r\n    var obj = {};\r\n    obj['qid'] = $scope.qid;\r\n    obj['pid'] = $scope.pid;\r\n    if($scope.mid){\r\n      obj['mid'] = $scope.mid;\r\n    }\r\n    if($scope.noticeTime){\r\n      obj['answerShowTime'] = $scope.noticeTime;\r\n    }\r\n    // console.log(obj);\r\n    // \r\n\r\n    // ceshi \r\n      // $scope.shareModalBox = false;\r\n      // $scope.goToShareList = true;\r\n      // // \r\n      // //\r\n      // var shareUrl = \"http://www.maixuexi.cn/student/#/extend/question/share/\" + 100000+ \"?state=QuestionCenter\";\r\n      // //\r\n      // console.log(shareUrl)\r\n      // mxxServices.qrCode($(\".shareQrcode\"), shareUrl);\r\n      // \r\n\r\n    $http.post(api_url + \"/publish/share/question\",obj).success(function(data) {\r\n      $scope.sharingId = data.sharingId;\r\n      // console.log($scope.sharingId);\r\n      // \r\n      $scope.shareModalBox = false;\r\n      $scope.goToShareList = true;\r\n      // \r\n      // \r\n      //\r\n      var url = \"http://www.maixuexi.cn/student/#/extend/question/share/\" + $scope.sharingId+ \"?state=QuestionCenter\";\r\n      //\r\n      mxxServices.qrCode($(\".shareQrcode\"), url);\r\n\r\n    })\r\n\r\n  }\r\n\r\n  $scope.yesSure = function(){\r\n    $scope.goToShareList = false;\r\n    $scope.showShareBtn = false;\r\n  }\r\n\r\n}])\r\n\r\n//\r\napp.controller(\"goodsPreview\", ['$scope', '$http', '$cookieStore', '$routeParams', '$location', 'mxxServices', function($scope, $http, $cookieStore, $routeParams, $location, mxxServices) {\r\n  $scope.pid = $routeParams.pid;\r\n  $scope.gid = $routeParams.gid;\r\n\r\n  mxxServices.getPaperData($scope);\r\n\r\n  //\r\n  $scope.goto = function(index) {\r\n    var $detail = $('.paper-preview-detail');\r\n    var $dt = $detail.find(\"dt:lt(\" + index + \")\");\r\n\r\n    //\r\n    var dt_top = 0;\r\n    if ($dt.size()) {\r\n      $.each($dt, function(k) {\r\n        var _top = ($(this).height()) + 20;\r\n        dt_top = dt_top + _top;\r\n      });\r\n    };\r\n    $detail.animate({ scrollTop: dt_top });\r\n  };\r\n\r\n  //\r\n  var url = \"http://www.maixuexi.cn/phone/#/preview/\" + $scope.pid;\r\n\r\n  //\r\n  mxxServices.qrCode($(\".wxQrcode\"), url);\r\n\r\n  //\r\n  $scope.showQrcode = function() {\r\n    $(\".view-code\").css(\"display\", \"block\")\r\n  };\r\n  $scope.hiddenQrcode = function() {\r\n    $(\".view-code\").css(\"display\", \"none\")\r\n  };\r\n\r\n  //\r\n  $http.get(api_url + \"/goods/paper/preview?goodsId=\" + $scope.gid + \"&pid=\" + $scope.pid)\r\n    .success(function(data) {\r\n      if (!data.status) {\r\n        $scope.goods = data;\r\n        $scope.tagList = data.tagList;\r\n        $scope.status = data.goodsStatus;\r\n        $scope.shareType = data.sharingStatus;\r\n        if ($scope.shareType == 3) { //\r\n          if ($scope.status == 1 || $scope.status == 4 || $scope.status == 5) {\r\n            $scope.handle = \"\"\r\n          } else if ($scope.status == 3) {\r\n            $scope.handle = \"\"\r\n          } else if ($scope.status == 2) {\r\n            $scope.handle = \"\" //disable\r\n            $scope.disable = true;\r\n          }\r\n          $scope.backUrl = \"#/paper/public\" //\r\n        } else { //\r\n          if ($scope.shareType == 1 && $scope.status == 3) {\r\n            $scope.handle = \"\" //\r\n            $scope.backUrl = \"#/paper/list/1\" //,\r\n          } else if ($scope.shareType == 2 && $scope.status == 3) {\r\n            $scope.handle = \"\" //\"\"\r\n            $scope.backUrl = \"#/paper/public\" //\r\n          }\r\n        }\r\n      }\r\n    })\r\n\r\n  $scope.doSomething = function() {\r\n    if ($scope.disable) return;\r\n    if ($scope.shareType == 3) {\r\n      if ($scope.status == 3) {\r\n        $location.path(\"/work/arrange/\" + $scope.pid + \"/\" + $scope.gid);\r\n      } else {\r\n        $location.path(\"/paper/publish/0/\" + $scope.gid)\r\n      }\r\n    } else {\r\n      if ($scope.shareType == 1 && $scope.status == 3) {\r\n        $location.path(\"/work/arrange/\" + $scope.pid + \"/\" + $scope.gid);\r\n      } else if ($scope.shareType == 2 && $scope.status == 3) {\r\n        $http.post(api_url + \"/goods/paper/obtain\", { \"goodsId\": $scope.gid, \"pid\": $scope.pid })\r\n          .success(function(data) {\r\n            if (!data.status) {\r\n              $scope.handle = \"\";\r\n              $scope.shareType = 1;\r\n            }\r\n          })\r\n      }\r\n    }\r\n  }\r\n\r\n}]);\r\n\r\n\r\n//\r\napp.controller(\"paperComplete\", ['$scope', '$http', '$cookieStore', '$routeParams', function($scope, $http, $cookieStore, $routeParams) {\r\n  $scope.pid = $routeParams.pid;\r\n  //,\r\n  $http.get(api_url + \"/test/paper/preview?pid=\" + $scope.pid)\r\n    .success(function(data) {\r\n      if (!data.status) {\r\n        $scope.pname = data.paper.paperName;\r\n        $scope.questionsNum = data.paper.objNumber + data.paper.subNumber;\r\n        $scope.questionsScore = data.paper.objScore + data.paper.subScore;\r\n        $scope.isQuestionBank = data.paper.isQuestionBank;\r\n      }\r\n    })\r\n}]);\r\n\r\n//word\r\napp.controller('paperExport', ['$scope', '$http', '$routeParams', 'mxxServices', function($scope, $http, $routeParams, mxxServices) {\r\n  $scope.pid = $routeParams.pid;\r\n\r\n  //\r\n  var url = \"http://www.maixuexi.cn/teacher/#/paper/\" + $scope.pid;\r\n\r\n  //\r\n  mxxServices.qrCode($(\".qrcode\"), url);\r\n\r\n  mxxServices.getPaperData($scope);\r\n\r\n  $scope.download = function() {\r\n    $http.get(api_url + \"/test/paper/teacher/word?pid=\" + $scope.pid)\r\n      .success(function(data) {\r\n        window.location.href = data.url;\r\n      })\r\n  }\r\n\r\n}]);\r\n\r\n\r\n//\r\napp.controller(\"worklist\", ['$scope', '$http', '$cookieStore', function($scope, $http, $cookieStore) {\r\n  // $scope.tid = 1;\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 10; //\r\n\r\n\r\n  //\r\n  // $scope.currentTime = new Date();\r\n\r\n  //\r\n  $scope.isAllVisible = false; //\r\n  $scope.visible = {};\r\n  $scope.allCheck = function() {\r\n    if (!$scope.isAllVisible) {\r\n      $scope.isAllVisible = true;\r\n      // $scope.visible\r\n      angular.forEach($scope.worklist, function(value, key, array) {\r\n        $scope.visible[value.workId] = true;\r\n      })\r\n    } else {\r\n      $scope.isAllVisible = false;\r\n      $scope.visible = {};\r\n    }\r\n  };\r\n\r\n  $scope.oneCheck = function(wid) {\r\n    if ($scope.visible[wid]) {\r\n      delete $scope.visible[wid];\r\n      $scope.isAllVisible = false;\r\n    } else {\r\n      //this.work  object\r\n      $scope.visible[wid] = this.work.workStatus;\r\n      var count = 0;\r\n      for (key in $scope.visible) {\r\n        count++;\r\n      }\r\n      if (count == $scope.worklist.length) {\r\n        $scope.isAllVisible = true;\r\n      }\r\n\r\n    }\r\n    var workstatus = [];\r\n    for (key in $scope.visible) {\r\n      workstatus.push($scope.visible[key])\r\n    }\r\n    //6,7  \r\n    if (workstatus.indexOf(6) != -1 || workstatus.indexOf(7) != -1) {\r\n      $(\".revoke-exam\").addClass(\"disabled\")\r\n    } else {\r\n      $(\".revoke-exam\").removeClass(\"disabled\")\r\n    }\r\n    if (workstatus.indexOf(6) != -1) {\r\n      $(\".no-revoke-exam\").removeClass(\"disabled\")\r\n    } else {\r\n      $(\".no-revoke-exam\").addClass(\"disabled\")\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.getData = function() {\r\n    $scope.searchObj = {};\r\n      // if($scope.paperName){\r\n      //   $scope.searchObj['workName'] = $scope.paperName;\r\n      // }\r\n      // if($scope.cid&&$scope.cid!=0){\r\n      //   $scope.searchObj['cid'] = $scope.cid;\r\n      // }\r\n      // if($scope.startTime){\r\n      //   $scope.searchObj['startTime'] = $scope.startTime;\r\n      // }\r\n      // if($scope.endTime){\r\n      //   $scope.searchObj['endTime'] = $scope.endTime;\r\n      // }\r\n      // console.log($scope.startTime1);\r\n      $http.put(api_url + \"/work/teacher/name?page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize, $scope.searchObj\r\n      ).success(function(data) {\r\n        $scope.count = data.count;\r\n        if ($scope.count == 0) { //\r\n          $scope.num = 1;\r\n        } else {\r\n          $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n          $scope.worklist = data.workList;\r\n          angular.forEach($scope.worklist, function(ele, index) {\r\n            /*if (ele.endTime && new Date(ele.endTime) < $scope.currentTime) {\r\n              ele.finishWork = true;\r\n            } else {\r\n              ele.finishWork = false;\r\n            }*/\r\n            if (ele.workStatus == 3 || ele.workStatus == 5 || ele.workStatus == 6 || ele.workStatus == 7) {\r\n              ele.finishWork = true;\r\n            } else {\r\n              ele.finishWork = false;\r\n            }\r\n          })\r\n        }\r\n      }) \r\n  };\r\n  $scope.getData();\r\n\r\n  //\r\n  $scope.workerStatus = ['', '', '', '', '', '', '', ''];\r\n\r\n  // tid\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  // \r\n  $scope.showChooseTimeBox = false;\r\n  // \r\n  $scope.chooseTimeShow = function(){\r\n    $scope.showChooseTimeBox = true;\r\n  }\r\n  //\r\n  $http.get(api_url + \"/teacher/class/owner?tid=\" + $scope.tid + \"&page=1&size=9999\")\r\n    .success(function(data) {\r\n      $scope.classlistOwn = data.classList;\r\n    });\r\n  $http.get(api_url + \"/teacher/class/public?tid=\" + $scope.tid + \"&page=1&size=9999\")\r\n    .success(function(res) {\r\n      $scope.classlistPublic = res.classList;\r\n  });\r\n  // cid=0\r\n  // $scope.cid = 0;\r\n  $scope.cid = document.getElementById(\"selectCid\").value;\r\n  // \r\n  $scope.chooseClassId = function(){\r\n    // console.log($scope.classlistOwn);\r\n    // console.log($scope.classlistPublic);\r\n    $scope.cid = document.getElementById(\"selectCid\").value;\r\n    // console.log('2',$scope.cid);\r\n    // 0\r\n    $scope.currentPage = 1;\r\n  }\r\n  //\r\n  $scope.search = function() {\r\n    //\r\n    $scope.startTime = $(\".startTime\").val();\r\n    //\r\n    $scope.endTime = $(\".endTime\").val();\r\n\r\n    // console.log($scope.startTime);\r\n    // console.log($scope.endTime);\r\n    if ($scope.paperName||$scope.cid||($scope.startTime&&$scope.endTime)) {\r\n\r\n      // \r\n      $scope.searchObj = {};\r\n      if($scope.paperName){\r\n        $scope.searchObj['workName'] = $scope.paperName;\r\n      }\r\n      if($scope.cid&&$scope.cid!=0){\r\n        $scope.searchObj['cid'] = $scope.cid;\r\n      }\r\n      if($scope.startTime){\r\n        $scope.searchObj['startTime'] = $scope.startTime;\r\n      }\r\n      if($scope.endTime){\r\n        $scope.searchObj['endTime'] = $scope.endTime;\r\n      }\r\n      $http.put(api_url + \"/work/teacher/name?page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize, $scope.searchObj\r\n      ).success(function(data) {\r\n        // if (!data.workList.length) {\r\n        //   alert(\"\")\r\n        // } else {\r\n        //   $scope.worklist = data.workList;\r\n        //   $scope.count = data.count;\r\n        //   $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n        // }\r\n        if (!data.status) {\r\n          $scope.worklist = data.workList;\r\n          $scope.count = data.count;\r\n          $scope.num = Math.ceil($scope.count / $scope.pageSize); //\r\n        } else {\r\n          alert(data.info);\r\n        }\r\n      }) \r\n    } else {\r\n      // $scope.getData();\r\n      alert('');\r\n      return;\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.next = function() { //\r\n    if ($scope.currentPage < $scope.num) {\r\n      $scope.currentPage++;\r\n      // console.log($scope.currentPage);\r\n      // \r\n      $scope.searchObj = {};\r\n      if($scope.paperName){\r\n        $scope.searchObj['workName'] = $scope.paperName;\r\n      }\r\n      if($scope.cid&&$scope.cid!=0){\r\n        $scope.searchObj['cid'] = $scope.cid;\r\n      }\r\n      if($scope.startTime){\r\n        $scope.searchObj['startTime'] = $scope.startTime;\r\n      }\r\n      if($scope.endTime){\r\n        $scope.searchObj['endTime'] = $scope.endTime;\r\n      }\r\n      $scope.search();\r\n    }\r\n  };\r\n  $scope.prev = function() { //                 \r\n    if ($scope.currentPage > 1) {\r\n      $scope.currentPage--;\r\n      // \r\n      $scope.searchObj = {};\r\n      if($scope.paperName){\r\n        $scope.searchObj['workName'] = $scope.paperName;\r\n      }\r\n      if($scope.cid&&$scope.cid!=0){\r\n        $scope.searchObj['cid'] = $scope.cid;\r\n      }\r\n      if($scope.startTime){\r\n        $scope.searchObj['startTime'] = $scope.startTime;\r\n      }\r\n      if($scope.endTime){\r\n        $scope.searchObj['endTime'] = $scope.endTime;\r\n      }\r\n      $scope.search();\r\n    }\r\n  };\r\n\r\n\r\n  document.onkeydown = function(ev) {\r\n    var ev = ev || window.ev;\r\n    if (ev.keyCode && ev.which == 13) {\r\n      $scope.search();\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.mouse = {\r\n    mouseover: function() {\r\n      $(\".handle-menu\").css(\"display\", \"block\")\r\n    },\r\n    mouseout: function() {\r\n      $(\".handle-menu\").css(\"display\", \"none\")\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.delete = function() {\r\n    var arr = [];\r\n    for (key in $scope.visible) {\r\n      arr.push(Number(key));\r\n    }\r\n    if (arr.length == 0) {\r\n      alert(\"!\");\r\n      return;\r\n    } else {\r\n      // var querry = \"wid=\";\r\n      // querry = querry + arr.join(\",\");\r\n      $http({\r\n        method: \"DELETE\",\r\n        url: api_url + '/work',\r\n        data: { \"workId\": arr },\r\n        headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.getData();\r\n          alert(\"!\");\r\n          //\r\n          $scope.isAllVisible = false; //\r\n          $scope.visible = {};\r\n        }\r\n      })\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.revoke = function() {\r\n    if ($(\".revoke-exam\").hasClass(\"disabled\")) {\r\n      return;\r\n    }\r\n    var arr = [];\r\n    for (key in $scope.visible) {\r\n      arr.push(Number(key));\r\n    }\r\n\r\n    if (arr.length == 0) {\r\n      alert(\"!\");\r\n      return;\r\n    } else {\r\n      //\r\n      //\r\n      // var querry = arr.join(\",\");\r\n      $http.put(api_url + \"/work/is/revoke\", {\r\n        \"workId\": arr,\r\n        \"isRevoke\": 1\r\n      }).success(function(data) {\r\n        $scope.visible = {};\r\n        $scope.getData();\r\n        alert(\"!\")\r\n      })\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.noRevoke = function() {\r\n    if ($(\".no-revoke-exam\").hasClass(\"disabled\")) {\r\n      return;\r\n    }\r\n    var arr = [];\r\n    for (key in $scope.visible) {\r\n      arr.push(Number(key));\r\n    }\r\n\r\n    if (arr.length == 0) {\r\n      alert(\"!\");\r\n      return;\r\n    } else {\r\n      //\r\n      //\r\n      // var querry = arr.join(\",\");\r\n      $http.put(api_url + \"/work/is/revoke\", {\r\n        \"workId\": arr,\r\n        \"isRevoke\": 0\r\n      }).success(function(data) {\r\n        $scope.visible = {};\r\n        $scope.getData();\r\n        alert(\"!\")\r\n      })\r\n    }\r\n  }\r\n\r\n  // \r\n  // $scope.next = function(){\r\n  //   alert('')\r\n  // }\r\n\r\n}])\r\n\r\n//\r\napp.controller(\"workdetail\", ['$scope', '$http', '$routeParams', '$location', function($scope, $http, $routeParams, $location) {\r\n  $scope.wid = $routeParams.wid;\r\n  $http.get(api_url + \"/work/class?workId=\" + $scope.wid)\r\n    .success(function(data) {\r\n      $scope.classInfo = data.class;\r\n      $scope.workInfo = data;\r\n      //\r\n      //\r\n      //\r\n      $scope.hours = Math.floor($scope.workInfo.durationTime / 3600);\r\n\r\n      $scope.minute = Math.floor(($scope.workInfo.durationTime - parseInt($scope.hours) * 3600) / 60);\r\n\r\n      $scope.second = $scope.workInfo.durationTime - parseInt($scope.hours) * 3600 - parseInt($scope.minute) * 60;\r\n\r\n      //\r\n      $scope.workInfo.deleteStudents = [];\r\n      $scope.workInfo.addStudents = [];\r\n    });\r\n  //\r\n  $scope.setting = function() {\r\n    $(\"div.switch\").toggle(400);\r\n  };\r\n\r\n  //,\r\n  // \r\n  //   \r\n  //  \r\n  // \r\n  // //.\r\n  // var currentTime = Math.round(new Date().getTime() / 1000);\r\n\r\n  //\r\n  $scope.getCurrentTime = function() {\r\n    var currentTime = new Date();\r\n    var year = currentTime.getFullYear();\r\n    var month = currentTime.getMonth() + 1;\r\n    var day = currentTime.getDate();\r\n    var hours = currentTime.getHours();\r\n    var minutes = currentTime.getMinutes();\r\n    var seconds = currentTime.getSeconds();\r\n    //10\"0\";\r\n    if (month < 10) { month = \"0\" + month; }\r\n    if (day < 10) { day = \"0\" + day }\r\n    if (hours < 10) { hours = \"0\" + hours }\r\n    if (minutes < 10) { minutes = \"0\" + minutes }\r\n    if (seconds < 10) { seconds = \"0\" + seconds }\r\n    $scope.currentTime = year + \"-\" + month + \"-\" + day + \" \" + hours + \":\" + minutes + \":\" + seconds;\r\n  }\r\n\r\n  $scope.userCheck = function(studentId) {\r\n    $scope.getCurrentTime();\r\n    //()\r\n    if ($scope.workInfo.endTime && Date.parse(new Date($scope.workInfo.endTime)) < Date.parse(currentTime)) {\r\n      alert(\",!\");\r\n      return;\r\n    }\r\n\r\n    var len = $scope.classInfo.students.length;\r\n    for (var i = 0; i < len; i++) {\r\n      if ($scope.classInfo.students[i][\"studentId\"] == studentId) {\r\n        if ($scope.classInfo.students[i][\"isMake\"] == 1) {\r\n          $scope.classInfo.students[i][\"isMake\"] = 0;\r\n          $scope.workInfo.deleteStudents.push(studentId);\r\n          if ($scope.workInfo.addStudents.indexOf(studentId) != -1) {\r\n            $scope.workInfo.addStudents.splice($scope.workInfo.addStudents.indexOf(studentId), 1)\r\n          }\r\n        } else {\r\n          $scope.classInfo.students[i][\"isMake\"] = 1;\r\n          $scope.workInfo.addStudents.push(studentId);\r\n          if ($scope.workInfo.deleteStudents.indexOf(studentId) != -1) {\r\n            $scope.workInfo.deleteStudents.splice($scope.workInfo.deleteStudents.indexOf(studentId), 1)\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  //\r\n  $scope.isAll = function() {\r\n    $scope.getCurrentTime();\r\n    //\r\n    if ($scope.workInfo.endTime && Date.parse(new Date($scope.workInfo.endTime)) < Date.parse(currentTime)) {\r\n      alert(\",!\");\r\n      return;\r\n    }\r\n    if ($scope.workInfo.isWholeWork == 1) {\r\n      $scope.workInfo.isWholeWork = 2;\r\n    } else {\r\n      $scope.workInfo.isWholeWork = 1;\r\n    }\r\n  };\r\n\r\n  $scope.submit = function() {\r\n    $scope.getCurrentTime();\r\n    //\r\n    //1\r\n    //getTime()Unix\r\n    // var currentTime=Math.round(new Date().getTime()/1000);\r\n    /*if ($scope.workInfo.endTime && Date.parse(new Date($scope.workInfo.endTime)) < Date.parse(currentTime)) {\r\n      alert(\",\");\r\n      return;\r\n    }*/\r\n    //\r\n\r\n    //bug\r\n    //????\r\n    if ($(\".second\").val()) {\r\n      $scope.second = parseInt($scope.second)\r\n    } else {\r\n      $scope.second = 0;\r\n    }\r\n\r\n    $scope.durationTime = $scope.hours * 3600 + $scope.minute * 60 + $scope.second;\r\n\r\n    //\r\n    if (!$(\".startime\").val()) {\r\n      $scope.workInfo.startTime = $scope.currentTime;\r\n    } else {\r\n      $scope.workInfo.startTime = $(\".startime\").val();\r\n    }\r\n\r\n    //\r\n    if (!$(\".noticeTime\").val()) {\r\n      $scope.workInfo.displayTime = $scope.currentTime;\r\n    } else {\r\n      $scope.workInfo.displayTime = $(\".noticeTime\").val();\r\n    }\r\n\r\n    //\r\n    if (!$(\".endtime\").val()) {\r\n      $scope.workInfo.endTime = null;\r\n    } else if (Date.parse(new Date($(\".endtime\").val())) < Date.parse(new Date($scope.workInfo.startTime))) {\r\n      alert('!');\r\n      return;\r\n    } else {\r\n      $scope.workInfo.endTime = $(\".endtime\").val();\r\n    }\r\n\r\n    //\r\n    var startime = new Date($(\".startime\").val()).getTime();\r\n    if ($(\".endtime\").val()) { //\r\n      var endtime = new Date($(\".endtime\").val()).getTime();\r\n      if ((endtime - startime) / 1000 < $scope.durationTime) {\r\n        alert(\"!\");\r\n        return;\r\n      } else {\r\n        $scope.workInfo.durationTime = $scope.durationTime;\r\n      }\r\n    } else {\r\n      $scope.workInfo.durationTime = $scope.durationTime;\r\n    }\r\n    /*var data = {\r\n      \"work\": $scope.workInfo,\r\n      \"class\": $scope.classInfo\r\n    };*/\r\n    // data = JSON.stringify(data);\r\n    /*$scope.studentList = [];\r\n    angular.forEach($scope.classInfo.students, function(ele) {\r\n      $scope.studentList.push({ 'studentId': ele.studentId, 'isMake': ele.isMake })\r\n    })*/\r\n    $scope.workInfo.cids = [];\r\n    $scope.workInfo.cids.push($scope.classInfo);\r\n    $http.put(api_url + \"/work\", $scope.workInfo)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          alert(\"!\");\r\n          $location.path(\"/work/list\");\r\n        }\r\n      })\r\n  }\r\n\r\n}])\r\n\r\n//\r\napp.controller(\"arrange\", ['$scope', '$http', '$location', '$cookieStore', '$routeParams', '$window', function($scope, $http, $location, $cookieStore, $routeParams, $window) {\r\n  $scope.sid = $cookieStore.get(\"user\").sid;\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.userlist = {};\r\n  $scope.currentPage = 1;\r\n  $scope.pageSize = 12; //\r\n  $scope.classTypeName = ['','','']\r\n\r\n  $scope.pid = Number($routeParams.pid);\r\n  $scope.gid = Number($routeParams.gid);\r\n\r\n  //\r\n  $scope.getPaperList = function(){\r\n    $http.get(api_url + \"/test/paper/teacher?page=1&size=99999\")\r\n      .success(function(data) {\r\n        $scope.paperlist = data.paperList;\r\n      });\r\n  }\r\n  // \r\n  $scope.getPaperList();\r\n\r\n  //\r\n  $scope.getGoodPaperList = function(){\r\n    $http.get(api_url + \"/goods/paper/teacher/relation?page=1&size=99999\")\r\n    .success(function(data) {\r\n      $scope.goodsPaperlist = data.goodsList;\r\n      angular.forEach($scope.goodsPaperlist, function(ele) {\r\n        ele[\"goodsPaperName\"] = ele.paperName + \"(\" + ele.goodsName + \")\";\r\n      })\r\n    });\r\n  }\r\n\r\n  //\r\n  $scope.searchPaper = function() {\r\n    if (!$scope.type) {\r\n      if (!$scope.paperName) {\r\n        $http.get(api_url + \"/test/paper/teacher?page=1&size=1000\")\r\n          .success(function(data) {\r\n            $scope.paperlist = data.paperList;\r\n          });\r\n        return;\r\n      }\r\n      $http.put(api_url + \"/test/paper/search?page=1&size=1000\", {\r\n        \"paperName\": $scope.paperName\r\n      }).success(function(data) {\r\n        if (data.count == 0) { //\r\n          $scope.getData();\r\n          alert(\"!\");\r\n        } else {\r\n          $scope.paperlist = data.paperList;\r\n        }\r\n      })\r\n    }\r\n\r\n  };\r\n\r\n  $scope.pKeyup = function(e) {\r\n    var keycode = window.event ? e.keyCode : e.which;\r\n    if (keycode == 13) {\r\n      $scope.searchPaper();\r\n    }\r\n  };\r\n\r\n  $scope.visible = {};\r\n  //\r\n  if ($scope.pid && !$scope.gid) {\r\n    $scope.type = 0; //\r\n    $scope.workType = 1; //\r\n    //\r\n    $http.get(api_url + \"/test/paper?pid=\" + $scope.pid)\r\n      .success(function(data) {\r\n        $scope.visible[$scope.pid] = true;\r\n        if (data.isFinish == 1) {\r\n          $scope.pname = data.paperName;\r\n          $scope.pid = data.pid;\r\n          $(\".checkedPaper\").css(\"display\", \"block\");\r\n        } else {\r\n          $window.history.go(-1);\r\n        }\r\n      })\r\n  } else if ($scope.gid) {\r\n    $scope.type = 1; //\r\n    $scope.workType = 3; //\r\n    $http.get(api_url + \"/goods/paper/preview?goodsId=\" + $scope.gid + \"&pid=\" + $scope.pid)\r\n      .success(function(data) {\r\n        $scope.visible[$scope.gid] = {};\r\n        $scope.visible[$scope.gid][$scope.pid] = true;\r\n        $scope.pname = data.paperName + \"(\" + data.goodsName + \")\";\r\n        $scope.pid = data.pid;\r\n        $scope.gid = data.goodsId;\r\n        $scope.price = data.paperPrice;\r\n        $(\".checkedPaper\").css(\"display\", \"block\");\r\n      })\r\n  } else if (!$scope.pid && !$scope.gid) {\r\n    $scope.type = 0; //\r\n  }\r\n\r\n  //\r\n  // $http.get(api_url + \"/teacher/class/owner?tid=\" + $scope.tid + \"&page=1&size=9999\")\r\n  //   .success(function(data) {\r\n  //     $scope.classlistOwn = data.classList;\r\n  //     /*angular.forEach($scope.classlistOwn, function(ele) {\r\n  //       ele.className += ''\r\n  //     })*/\r\n  //     $http.get(api_url + \"/teacher/class/public?tid=\" + $scope.tid + \"&page=1&size=9999\")\r\n  //       .success(function(res) {\r\n  //         $scope.classlistPublic = res.classList;\r\n  //         /*angular.forEach($scope.classlistPublic, function(ele) {\r\n  //           ele.className += ''\r\n  //         })*/\r\n  //         $scope.classlist = $scope.classlistOwn.concat($scope.classlistPublic);\r\n  //       });\r\n  //   });\r\n\r\n  // //\r\n  // $scope.searchClass = function() {\r\n  //   if (!$scope.className) {\r\n  //     $http.get(api_url + \"/test/paper/teacher?page=1&size=1000\")\r\n  //       .success(function(data) {\r\n  //         $scope.paperlist = data.paperList;\r\n  //       });\r\n  //     return;\r\n  //   }\r\n\r\n  //   $http.put(api_url + \"/teacher/class/search?page=1&size=1000\", {\r\n  //     \"className\": $scope.className,\r\n  //     \"tid\": $scope.tid,\r\n  //     \"type\": 2\r\n  //   }).success(function(data) {\r\n  //     if (data.count == 0) {\r\n  //       alert(\"!\");\r\n  //       return;\r\n  //     }\r\n  //     $scope.classlist = data.classList;\r\n  //   })\r\n  // };\r\n  $scope.getClassData = function() {\r\n    if(!$scope.getClassApi){\r\n      $scope.currentPage = 1;\r\n    }\r\n    // \r\n    $scope.getClassApi = true;\r\n    $http.get(api_url + \"/teacher/class/list?tid=\" + $scope.tid + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          $scope.count = data.count;\r\n          $scope.classlist = data.classList;\r\n          // console.log($scope.priviteClasses);\r\n          for (var i=0; i<$scope.classlist.length; i++){\r\n            if($scope.classlist[i]['className'].length > 25){\r\n              $scope.classlist[i]['shortClassName'] = $scope.classlist[i]['className'].substring(0,25)+'...';\r\n            } else {\r\n              $scope.classlist[i]['shortClassName'] = $scope.classlist[i]['className']\r\n            }\r\n          }\r\n          // console.log($scope.priviteClasses);\r\n          if ($scope.count == 0) {\r\n            $scope.loadMore = false;\r\n          } else if($scope.count>$scope.currentPage*$scope.pageSize) {\r\n            $scope.loadMore = true;\r\n          } else {\r\n            $scope.loadMore = false;\r\n          }\r\n        }\r\n\r\n      })\r\n  };\r\n\r\n  $scope.getClassData();\r\n\r\n  $scope.searchClass = function() {\r\n    if (!$scope.className) {\r\n      // return;\r\n      // \r\n      $scope.getClassData();\r\n      return;\r\n    }\r\n    if($scope.getClassApi){\r\n      $scope.currentPage = 1;\r\n    }\r\n    $scope.getClassApi = false;\r\n    $http.put(api_url + \"/teacher/class/search?\", {\r\n      \"className\": $scope.className,\r\n      \"type\": 2,\r\n      \"tid\": $scope.tid,\r\n      \"page\": $scope.currentPage,\r\n      \"size\": $scope.pageSize\r\n    }).success(function(data) {\r\n      // $scope.className = '';\r\n      $scope.count = data.count;\r\n      $scope.classlist = data.classList;\r\n      if ($scope.count == 0) {\r\n        $scope.loadMore = false;\r\n      } else if($scope.count>$scope.currentPage*$scope.pageSize) {\r\n        $scope.loadMore = true;\r\n      } else {\r\n        $scope.loadMore = false;\r\n      }\r\n    })\r\n  };\r\n\r\n  // \r\n  $scope.getMoreClass = function(){\r\n    $scope.currentPage ++;\r\n    if($scope.getClassApi){\r\n      // \r\n      // $scope.getClassData();\r\n      $http.get(api_url + \"/teacher/class/list?tid=\" + $scope.tid + \"&page=\" + $scope.currentPage + \"&size=\" + $scope.pageSize)\r\n        .success(function(data) {\r\n          if (!data.status) {\r\n            $scope.count = data.count;\r\n            $scope.classlist = $scope.classlist.concat(data.classList);\r\n            // console.log($scope.priviteClasses);\r\n            for (var i=0; i<$scope.classlist.length; i++){\r\n              if($scope.classlist[i]['className'].length > 25){\r\n                $scope.classlist[i]['shortClassName'] = $scope.classlist[i]['className'].substring(0,25)+'...';\r\n              } else {\r\n                $scope.classlist[i]['shortClassName'] = $scope.classlist[i]['className']\r\n              }\r\n            }\r\n            // console.log($scope.priviteClasses);\r\n            if ($scope.count == 0) {\r\n              $scope.loadMore = false;\r\n            } else if($scope.count>$scope.currentPage*$scope.pageSize) {\r\n              $scope.loadMore = true;\r\n            } else {\r\n              $scope.loadMore = false;\r\n            }\r\n          }\r\n\r\n      })\r\n    } else {\r\n      // \r\n      // $scope.searchClass();\r\n      $scope.getClassApi = false;\r\n      $http.put(api_url + \"/teacher/class/search?\", {\r\n        \"className\": $scope.className,\r\n        \"type\": 2,\r\n        \"tid\": $scope.tid,\r\n        \"page\": $scope.currentPage,\r\n        \"size\": $scope.pageSize\r\n      }).success(function(data) {\r\n        // $scope.className = '';\r\n        $scope.count = data.count;\r\n        $scope.classlist = $scope.classlist.concat(data.classList);\r\n        if ($scope.count == 0) {\r\n          $scope.loadMore = false;\r\n        } else if($scope.count>$scope.currentPage*$scope.pageSize) {\r\n          $scope.loadMore = true;\r\n        } else {\r\n          $scope.loadMore = false;\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  $scope.cKeyup = function(e) {\r\n    var keycode = window.event ? e.keyCode : e.which;\r\n    if (keycode == 13) {\r\n      $scope.searchClass();\r\n    }\r\n  };\r\n\r\n  $scope.check = function(pid, gid) {\r\n    if (!$scope.type) {\r\n      if ($scope.visible[pid]) {\r\n        delete $scope.visible[pid];\r\n        $(\".checkedPaper\").css(\"display\", \"none\");\r\n      } else {\r\n        $scope.visible = {};\r\n        $scope.visible[pid] = true;\r\n        $(\".checkedPaper\").css(\"display\", \"block\");\r\n        $scope.pname = this.paper.paperName;\r\n        $scope.pid = this.paper.pid;\r\n      }\r\n    } else {\r\n      if ($scope.visible[gid] && $scope.visible[gid][pid]) {\r\n        delete $scope.visible[gid][pid];\r\n        $(\".checkedPaper\").css(\"display\", \"none\");\r\n      } else {\r\n        $scope.visible = {};\r\n        $scope.visible[gid] = {};\r\n        $scope.visible[gid][pid] = true;\r\n        $(\".checkedPaper\").css(\"display\", \"block\");\r\n        $scope.pname = this.paper.paperName + \"(\" + this.paper.goodsName + \")\";\r\n        $scope.pid = this.paper.pid;\r\n        $scope.gid = this.paper.goodsId;\r\n        $scope.price = this.paper.paperPrice;\r\n      }\r\n    }\r\n\r\n  };\r\n\r\n  $scope.checkedPaper = function() {\r\n    $(\".checkedPaper\").css(\"display\", \"none\");\r\n    $scope.visible = {};\r\n  };\r\n\r\n  $scope.checkType = function(type) {\r\n    if ($scope.type == type) return;\r\n    if (type == 1) {\r\n      $scope.workType = 3;\r\n      $scope.getGoodPaperList();\r\n    } else if (type == 0) {\r\n      $scope.workType = 1;\r\n      $scope.getPaperList();\r\n    }\r\n    $scope.type = type;\r\n    $scope.checkedPaper();\r\n  }\r\n\r\n\r\n  //\r\n  $scope.checked = {}; //ciduid\r\n  //$scope.checked{1:{cid:1,uids:[1,2,4,5]},3:{cid:3,uids:[1,3,5,7]}}\r\n\r\n  $scope.unchecked = {}; //\r\n  $scope.userUnchecked = {}; //\r\n\r\n  //$scope.checked\r\n  $scope.classCheck = function(cid, index) {\r\n    if (!$scope.unchecked[cid]) { //\r\n      //\r\n      //ciduid\r\n      $scope.checked[cid] = {};\r\n\r\n      //  \r\n      $(\"#index\" + index).css(\"display\", \"block\");\r\n      $scope.unchecked[cid] = true; //uncheck.png\r\n      //cid\r\n      //if(!$scope.checked[cid][\"cid\"]==cid)\r\n      $scope.checked[cid][\"cid\"] = cid;\r\n      // $scope.checked[cid][\"sid\"] = sid;\r\n      //uid\r\n      $scope.checked[cid][\"students\"] = []; //uid\r\n      $scope.userUnchecked[cid] = {};\r\n      //\r\n      $http.get(api_url + \"/class/student/list?cid=\" + cid + \"&page=1&size=1000\")\r\n        .success(function(data) {\r\n          $scope.userlist[cid] = data.studentList;\r\n          if ($scope.userlist[cid].length == 0) {\r\n            //\r\n            $scope.checked[cid][\"students\"] = [];\r\n          } else {\r\n            //uid$scope.checked[cid][\"uids\"]\r\n            for (var i = 0; i < $scope.userlist[cid].length; i++) {\r\n              $scope.checked[cid][\"students\"].push({\r\n                \"studentId\": $scope.userlist[cid][i].studentId,\r\n                \"isMake\": 1\r\n              })\r\n            }\r\n          }\r\n        })\r\n    } else if ($scope.checked[cid]) {\r\n      //\r\n      delete $scope.checked[cid]; //$scope.checked[cid] \r\n      $scope.unchecked[cid] = false; //remove.png\r\n\r\n      //\r\n      $http.get(api_url + \"/class/student/list?cid=\" + cid + \"&page=1&size=200\")\r\n        .success(function(data) {\r\n          $scope.userlist[cid] = data.studentList;\r\n          $scope.userUnchecked[cid] = {};\r\n          for (var i = 0; i < $scope.userlist[cid].length; i++) {\r\n            //\r\n            if ($scope.userlist[cid].length == 0) {\r\n              // $scope.userUnchecked[cid] = [];\r\n              $scope.userUnchecked[cid] = {};\r\n              return;\r\n            }\r\n            $scope.userUnchecked[cid][$scope.userlist[cid][i].studentId] = true;\r\n          }\r\n\r\n        })\r\n\r\n    };\r\n\r\n    //\r\n    $scope.userCheck = function(cid, studentId) {\r\n      //$scope.userUnchecked[cid]uid\r\n      //$scope.userUnchecked[cid]\r\n      if (!$scope.userUnchecked[cid]) {\r\n        $scope.userUnchecked[cid] = {};\r\n      }\r\n      if ($scope.userUnchecked[cid][studentId]) { //\r\n        //\r\n        delete $scope.userUnchecked[cid][studentId];\r\n        //\r\n        if (!$scope.checked[cid]) {\r\n          $scope.checked[cid] = {}; //  ciduid\r\n          $scope.checked[cid][\"cid\"] = cid;\r\n          $scope.checked[cid][\"students\"] = [];\r\n\r\n          $http.get(api_url + \"/class/student/list?cid=\" + cid + \"&page=1&size=200\")\r\n            .success(function(data) {\r\n              $scope.userlist[cid] = data.studentList;\r\n              if ($scope.userlist[cid].length == 0) {\r\n                //\r\n                $scope.checked[cid][\"students\"] = [];\r\n              } else {\r\n                //uid$scope.checked[cid][\"uids\"]\r\n                for (var i = 0; i < $scope.userlist[cid].length; i++) {\r\n                  $scope.checked[cid][\"students\"].push({\r\n                    \"studentId\": $scope.userlist[cid][i].studentId,\r\n                    \"isMake\": 0\r\n                  })\r\n                }\r\n              }\r\n\r\n              angular.forEach($scope.checked[cid][\"students\"], function(ele) {\r\n                if (ele.studentId == studentId) {\r\n                  ele.isMake = 1;\r\n                }\r\n              })\r\n\r\n            })\r\n\r\n          // $scope.checked[cid][\"students\"].push(studentId);\r\n          $scope.unchecked[cid] = true;\r\n        }\r\n        /*var index = $scope.checked[cid][\"students\"].indexOf(studentId);\r\n        if (index == -1) {\r\n          $scope.checked[cid][\"students\"].push(studentId);\r\n        }*/\r\n        angular.forEach($scope.checked[cid][\"students\"], function(ele) {\r\n          if (ele.studentId == studentId) {\r\n            ele.isMake = 1;\r\n          }\r\n        })\r\n      } else if (!$scope.userUnchecked[cid][studentId]) {\r\n        //\r\n        $scope.userUnchecked[cid][studentId] = true;\r\n        if ($scope.checked[cid]) {\r\n          var makeList = [];\r\n          angular.forEach($scope.checked[cid][\"students\"], function(ele) {\r\n            if (ele.studentId == studentId) {\r\n              ele.isMake = 0;\r\n            }\r\n            makeList.push(ele.isMake);\r\n          })\r\n          if (makeList.indexOf(1) == -1) {\r\n            $scope.unchecked[cid] = false;\r\n            delete $scope.checked[cid];\r\n          }\r\n          /*var index = $scope.checked[cid][\"students\"].indexOf(studentId);\r\n          if (index != -1) {\r\n            $scope.checked[cid][\"students\"].splice(index, 1); //\r\n            if ($scope.checked[cid][\"students\"].length == 0) {\r\n              $scope.unchecked[cid] = false;\r\n              delete $scope.checked[cid];\r\n            }\r\n          }*/\r\n        }\r\n\r\n      }\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.switch = function(index) {\r\n    $(\"#index\" + index).toggle();\r\n  }\r\n\r\n  //\r\n  $scope.setting = function() {\r\n    $(\"div.switch\").toggle(400);\r\n  }\r\n\r\n  //\r\n  $scope.isall = true;\r\n  $scope.isWholeWork = 1;\r\n  $scope.isAll = function() {\r\n    $scope.isall = !$scope.isall;\r\n    if (!$scope.isall) {\r\n      $scope.isWholeWork = 1;\r\n    } else {\r\n      $scope.isWholeWork = 0;\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.isorder = false;\r\n  $scope.isMixed = 0;\r\n  $scope.isOrder = function() {\r\n    $scope.isorder = !$scope.isorder;\r\n    if (!$scope.isorder) {\r\n      $scope.isMixed = 0;\r\n    } else {\r\n      $scope.isMixed = 1;\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.issee = true;\r\n  $scope.showAnswerType = 1;\r\n  $scope.isSee = function() {\r\n    if(!$(\".endtime\").val()) {\r\n      alert(',');\r\n      return;\r\n    }\r\n    $scope.issee = !$scope.issee;\r\n    if (!$scope.issee) {\r\n      $scope.showAnswerType = 2;\r\n    } else {\r\n      $scope.showAnswerType = 1;\r\n    }\r\n    // console.log($scope.showAnswerType);\r\n  };\r\n\r\n  //\r\n  $scope.isjoin = true;\r\n  $scope.isJoinStatistics = 1;\r\n  $scope.isJoin = function() {\r\n    $scope.isjoin = !$scope.isjoin;\r\n    if (!$scope.isjoin) {\r\n      $scope.isJoinStatistics = 0;\r\n    } else {\r\n      $scope.isJoinStatistics = 1;\r\n    }\r\n  };\r\n  // console.log($scope.isJoinStatistics);\r\n\r\n  //0\r\n  $scope.hours = 0;\r\n  $scope.minute = 0;\r\n  $scope.second = 0;\r\n\r\n  $scope.submit = function() {\r\n    if (!$scope.pname) {\r\n      alert(\"!\");\r\n      return;\r\n    }\r\n\r\n    //\r\n    $scope.cids = []; //\r\n    for (key in $scope.checked) {\r\n      $scope.cids.push($scope.checked[key]);\r\n    }\r\n    if ($scope.cids.length == 0) {\r\n      alert(\"!\");\r\n      return;\r\n    }\r\n\r\n    //\r\n    $scope.durationTime = parseInt($scope.hours * 60 * 60) + parseInt($scope.minute * 60) + parseInt($scope.second);\r\n\r\n    //\r\n    if ($scope.durationTime != 0 && $scope.durationTime < 60) {\r\n      alert(\"1!\");\r\n      return;\r\n    };\r\n\r\n    //\r\n    var currentTime = new Date();\r\n    var year = currentTime.getFullYear();\r\n    var month = currentTime.getMonth() + 1;\r\n    var day = currentTime.getDate();\r\n    var hours = currentTime.getHours();\r\n    var minutes = currentTime.getMinutes();\r\n    var seconds = currentTime.getSeconds();\r\n    //10\"0\";\r\n    if (month < 10) { month = \"0\" + month; }\r\n    if (day < 10) { day = \"0\" + day }\r\n    if (hours < 10) { hours = \"0\" + hours }\r\n    if (minutes < 10) { minutes = \"0\" + minutes }\r\n    if (seconds < 10) { seconds = \"0\" + seconds }\r\n    $scope.currentTime = year + \"-\" + month + \"-\" + day + \" \" + hours + \":\" + minutes + \":\" + seconds;\r\n\r\n    //\r\n    if (!$(\".startime\").val()) {\r\n      $scope.startTime = $scope.currentTime;\r\n    } else {\r\n      $scope.startTime = $(\".startime\").val();\r\n    }\r\n\r\n    //\r\n    if (!$(\".endtime\").val()) {\r\n      $scope.endTime = null;\r\n      // \r\n      $scope.showAnswerType = 1;\r\n    } else if (Date.parse(new Date($(\".endtime\").val())) < Date.parse(new Date($scope.startTime))) {\r\n      alert('!');\r\n      return;\r\n    } else {\r\n      $scope.endTime = $(\".endtime\").val();\r\n    }\r\n\r\n    //\r\n    if (!$(\".noticeTime\").val()) {\r\n      $scope.displayTime = $scope.currentTime;\r\n    } else if (Date.parse(new Date($(\".noticeTime\").val())) < Date.parse(new Date($scope.currentTime))) {\r\n      alert('!');\r\n      return;\r\n    } else if (Date.parse(new Date($(\".noticeTime\").val())) > Date.parse(new Date($scope.startTime))) {\r\n      alert('!');\r\n      return;\r\n    } else {\r\n      $scope.displayTime = $(\".noticeTime\").val();\r\n    }\r\n\r\n    //\r\n    var startime = new Date($(\".startime\").val()).getTime();\r\n    if ($(\".endtime\").val()) { //\r\n      var endtime = new Date($(\".endtime\").val()).getTime();\r\n      if ((endtime - startime) / 1000 < $scope.durationTime) {\r\n        alert(\"!\");\r\n        return;\r\n      }\r\n    }\r\n\r\n    var workInfo = {\r\n      \"pid\": parseInt($scope.pid),\r\n      \"workName\": $scope.pname,\r\n      \"displayTime\": $scope.displayTime,\r\n      \"startTime\": $scope.startTime,\r\n      \"endTime\": $scope.endTime,\r\n      \"showAnswerType\": parseInt($scope.showAnswerType),\r\n      \"durationTime\": parseInt($scope.durationTime),\r\n      \"isMixed\": parseInt($scope.isMixed),\r\n      \"isWholeWork\": parseInt($scope.isWholeWork),\r\n      \"isJoinStatistics\": parseInt($scope.isJoinStatistics),\r\n      \"cids\": $scope.cids,\r\n      \"workType\": $scope.workType\r\n    }\r\n    if ($scope.type) {\r\n      workInfo[\"goodsId\"] = $scope.gid;\r\n    }\r\n    // console.log(workInfo);\r\n\r\n    //json\r\n    workInfo = JSON.stringify(workInfo);\r\n\r\n    $http.post(api_url + \"/work\", workInfo)\r\n      .success(function(data) {\r\n        if (!data.status) {\r\n          alert(\"!\");\r\n          $location.path(\"/work/list\");\r\n        }\r\n      })\r\n\r\n  }\r\n}])\r\n\r\napp.controller('workcorrect', ['$scope', '$routeParams', '$http', '$filter', 'toolServices', \"$cookieStore\", \"$timeout\", \"correctService\", function($scope, $routeParams, $http, $filter, toolServices, $cookieStore, $timeout, correctService) {\r\n  $scope.workId = parseInt($routeParams['workId']); //urlid\r\n  $scope.baseInfo = {};\r\n  $scope.paperQuestions = [];\r\n  $scope.subjectiveQuestions = [];\r\n  $scope.objectiveQuestions = [];\r\n  $scope.currentQuestion = {};\r\n  // $scope.currentSubjectiveIndex = 0;\r\n  $scope.currentStudent = {};\r\n  $scope.currentStudentIndex = 0;\r\n  $scope.corrected = [];\r\n  $scope.uncorrected = [];\r\n  $scope.questions = [];\r\n  $scope.composites = [];\r\n  $scope.tixus = [];\r\n  $scope.startCorrect = 1; //0/1 \r\n  $scope.isShowQuestionInfo = 1; //\r\n  $scope.finalScore = 0;\r\n  var userinfo = $cookieStore.get('user');\r\n  $scope.token = userinfo['token'];\r\n  $scope.messageType = 1  //1-2-\r\n  /*    \r\n        correctscore \r\n        type type = 1   type = 0 \r\n        @param data  [];\r\n        @param index index;\r\n\r\n  */\r\n\r\n  $scope.studentSort = function(data, index) {\r\n    // if (index == 0) {//\r\n    angular.forEach(data, function(student) {\r\n      correctService.getStudentQidInfo($scope.workId, $scope.currentQuestion.qid, student.studentId)\r\n        .then(function(res) {\r\n          student.workId = res.workId;\r\n          student.qid = res.qid;\r\n          student.qType = res.qType;\r\n          student.answer = res.answer;\r\n          student.submitTime = res.submitTime;\r\n          student.answerDuration = res.answerDuration;\r\n          student.tid = res.tid;\r\n          student.tutorId = res.tutorId;\r\n          student.correct = res.correct;\r\n          student.correctTime = res.correctTime;\r\n          student.score = res.score;\r\n          student.isRight = res.isRight;\r\n          student.correctType = res.correctType;\r\n          student.createTime = res.createTime;\r\n          student.updateTime = res.updateTime;\r\n          /*if ($scope.currentQuestion.qType == 1) {\r\n            student.type = 1;\r\n            return;\r\n          }\r\n          if (!student.correct) {\r\n            student.type = 0;\r\n            return;\r\n          }\r\n          student.type = 1;\r\n          for (var i = 0, ii = student.correct.length; i < ii; i++) {\r\n            if (student.correct[i][\"score\"] == undefined) {\r\n              student.type = 0;\r\n              break;\r\n            }\r\n          }*/\r\n        })\r\n    })\r\n\r\n    $scope.students = data;\r\n    // }\r\n    $scope.currentStudentIndex = index;\r\n    $scope.currentStudent = $scope.students[$scope.currentStudentIndex];\r\n    // console.log($scope.currentStudent)\r\n  }\r\n\r\n  /*control whether textarea is show now */\r\n  $scope.isDisplayText = function() {\r\n    $scope.textArr = [];\r\n    /*if ($scope.currentStudent.correct == undefined) {\r\n      $(\".t_textarea\").hide();\r\n    } else {\r\n      for (var i = 0, ii = $scope.currentStudent.correct.length; i < ii; i++) {\r\n        var $textArea = $(\"[data-textIndex=\" + i + \"]\");\r\n        if ($scope.currentStudent.correct[i].correct['textarea'] != undefined && $scope.currentStudent.correct[i].correct['textarea'] != \"\") {\r\n          $textArea.show();\r\n          $textArea.children(\"textarea\").val($scope.currentStudent.correct[i].correct['textarea'])\r\n        } else {\r\n          $textArea.hide();\r\n        }\r\n      }\r\n    }*/\r\n  }\r\n\r\n  /*initialization */\r\n  correctService.getWorkBaseInfo($scope.workId)\r\n    .then(function(data) {\r\n      $scope.baseInfo = data;\r\n      if (!$scope.baseInfo.endTime) {\r\n        $scope.baseInfo.unlimited = 1;\r\n      } else {\r\n        $scope.baseInfo.unlimited = 0;\r\n      }\r\n\r\n      correctService.preview($scope.baseInfo.pid)\r\n        .then(function(data) {\r\n          $scope.questions = data.questions;\r\n          $scope.stems = data.stem;\r\n          $scope.subNumber = data.paper.subNumber; //,\r\n          //\r\n          if ($scope.questions[0].qType && $scope.questions[0].qType == 2) {\r\n            $scope.currentSubjectiveIndex = 0;\r\n          } else if (!$scope.questions[0].qType && $scope.stems[$scope.questions[0].mid][0].qType == 2) {\r\n            $scope.currentSubjectiveIndex = 0;\r\n          } else {\r\n            $scope.currentSubjectiveIndex = -1;\r\n          }\r\n          for (var i = 0; i < data.paper.paperStructJson.length; i++) {\r\n            if (data.paper.paperStructJson[i]['qid']) {\r\n              var tixu = {\r\n                \"tixu\": (i + 1).toString(),\r\n                \"qid\": data.paper.paperStructJson[i]['qid'],\r\n                \"parentId\": 0,\r\n                \"parentTixu\": 0\r\n              }\r\n              $scope.tixus.push(tixu);\r\n              var qid = data.paper.paperStructJson[i][\"qid\"];\r\n              var ques = correctService.findObjInArray(data.questions, \"qid\", qid);\r\n              if (ques.qType == 2) {\r\n                ques.tixu = tixu.tixu;\r\n                $scope.subjectiveQuestions.push(ques);\r\n              }\r\n\r\n            } else if (data.paper.paperStructJson[i]['mid']) {\r\n              var mid = data.paper.paperStructJson[i]['mid'].toString();\r\n              var stem = data.stem[mid];\r\n              for (var j = 0; j < data.paper.paperStructJson[i]['stem'].length; j++) {\r\n                var qid = data.paper.paperStructJson[i]['stem'][j].toString();\r\n                var tixu = {\r\n                  \"tixu\": (i + 1).toString() + \"-\" + (j + 1),\r\n                  \"qid\": data.paper.paperStructJson[i][\"stem\"][j],\r\n                  \"parentId\": data.paper.paperStructJson[i]['mid'],\r\n                  \"parentTixu\": (i + 1)\r\n                }\r\n                $scope.tixus.push(tixu);\r\n                var child = correctService.findObjInArray(stem, \"qid\", qid);\r\n                if (child.qType == 2) {\r\n                  child.parent = stem;\r\n                  child.parentId = tixu.parentId;\r\n                  child.tixu = tixu.tixu;\r\n                  child.parentTixu = tixu.parentTixu;\r\n                  $scope.subjectiveQuestions.push(child);\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n          if ($scope.tixus[0]['parentId'] == 0) {\r\n            $scope.currentQuestion = correctService.findObjInArray($scope.questions, \"qid\", $scope.tixus[0]['qid']);\r\n            $scope.currentQuestion.parentId = 0;\r\n            $scope.currentQuestion.tixu = $scope.tixus[0][\"tixu\"];\r\n          } else if ($scope.tixus[0]['parentId'] != 0) {\r\n            var qid = $scope.tixus[0]['qid'];\r\n            var parentId = $scope.tixus[0]['parentId'];\r\n            var parentTixu = $scope.tixus[0]['parentTixu'];\r\n            $scope.currentQuestion = correctService.findObjInArray($scope.stems[parentId.toString()], \"qid\", qid);\r\n            $scope.currentQuestion.parent = correctService.findObjInArray($scope.questions, \"mid\", parentId);\r\n            $scope.currentQuestion.parentTixu = parentTixu;\r\n            $scope.currentQuestion.parentId = parentId;\r\n            $scope.currentQuestion.tixu = $scope.tixus[0]['tixu'];\r\n          }\r\n          correctService.getCorrectInfoByqid($scope.workId, $scope.currentQuestion.qid)\r\n            .then(function(data) {\r\n              $scope.studentSort(data.studentList, 0);\r\n\r\n              if ($scope.currentQuestion.qType == 2 && angular.isDefined($scope.currentStudent)) {\r\n                $scope.isDisplayText();\r\n              }\r\n            })\r\n\r\n        });\r\n    });\r\n\r\n  $scope.textArr = []; //\r\n  $scope.showTextarea = function(event, index) {\r\n    // $scope.showArea = 1;\r\n    // $(\".t_textarea\").children(\"textarea\").eq(index).text(\"\");\r\n    // $(\".t_textarea\").children(\"textarea\").eq(index).val(\"\");\r\n    // var $textarea = $(event.target).parent().parent().siblings('.teacherAnswer').children(\".t_textarea\");\r\n    // $textarea.show().children(\"textarea\").text(\"\");\r\n    $scope.textArr[index] = true;\r\n  }\r\n\r\n  /*remove text/images/audio */\r\n  $scope.removeTextarea = function(event, type, index) {\r\n    // console.log(index)\r\n    $scope.tindex = $(event.target).parents('.teacherAnswer').attr('data-tindex');\r\n    /* type//*/\r\n    if (type == 1) {\r\n      // $(event.target).siblings(\"textarea\").val(\"\");\r\n      // $(event.target).parent().hide();\r\n      $scope.currentStudent.correct[index].correct['textarea'] = \"\";\r\n      $scope.textArr[index] = false;\r\n\r\n      $scope.submitAnswer($scope.tindex, \"textarea\", null);\r\n    } else if (type == 2) {\r\n      // if ($scope.currentStudent.correct[$scope.tindex].correct['picture'].length == 1) {\r\n      $(event.target).siblings(\".uploadImage\").attr(\"src\", \"\").end().parent().hide();\r\n      $scope.submitAnswer($scope.tindex, \"picture\", null);\r\n      // } else {\r\n      //   $(event.target).siblings(\".uploadImage\").attr(\"src\", \"\");\r\n      //   $scope.currentStudent.correct[$scope.tindex].correct['picture'].splice(index, 1)\r\n      //   $scope.submitAnswer($scope.tindex, \"picture\", $scope.currentStudent.correct[$scope.tindex].correct['picture'], \"delete\");\r\n      // }\r\n    } else if (type == 3) {\r\n      $(event.target).hide();\r\n      $(event.target).siblings(\".decorator\").hide();\r\n      $scope.submitAnswer($scope.tindex, \"audio\", null);\r\n    }\r\n  }\r\n\r\n  $scope.playAudio = function(event) {\r\n    var $target = $(event.target);\r\n    var audioPlayer = $target.siblings().get(1);\r\n    var timeMonitor = $target.siblings(\".currentTime\");\r\n    audioPlayer.play();\r\n    audioPlayer.addEventListener(\"ended\", function() {\r\n      $target.attr(\"src\", \"./static/images/mp3.png\");\r\n    }, false);\r\n    var duration = parseInt(audioPlayer.duration);\r\n    timeMonitor.text(duration);\r\n    audioPlayer.addEventListener(\"timeupdate\", function() {\r\n      var currentTime = parseInt(audioPlayer.currentTime);\r\n      var remain = duration - currentTime;\r\n      timeMonitor.text(remain + \" / \" + duration);\r\n    }, false);\r\n    $target.attr(\"src\", './static/images/pi_mp3.gif');\r\n  }\r\n\r\n  $scope.uploadPic = function(event, index) {\r\n    var target = event.target;\r\n    var form = document.createElement(\"form\");\r\n    form.setAttribute(\"enctype\", \"multipart/form-data\");\r\n    var uploadFileInput = document.createElement(\"input\");\r\n    uploadFileInput.setAttribute(\"type\", \"file\");\r\n    // uploadFileInput.setAttribute(\"name\", \"fileDataFileName\");\r\n    uploadFileInput.setAttribute(\"name\", \"resource\");\r\n    uploadFileInput.click();\r\n    $(form).append(uploadFileInput);\r\n    $(uploadFileInput).on(\"change\", function() {\r\n      var file = uploadFileInput.files[0];\r\n      if (!/image\\/\\w+/.test(file.type)) {\r\n        // correctService.showTip(\"\");\r\n        alert(\"\");\r\n        return;\r\n      }\r\n      var fd = new FormData(form);\r\n      /*Angular$http,httpXMLHttpRequst */\r\n      if (window.XMLHttpRequest) {\r\n        var ajax = new XMLHttpRequest();\r\n      } else if (window.AcitveXObject) {\r\n        var ajax = new AcitveXObject(\"Microsoft.XMLHTTP\");\r\n      } else {\r\n        throw Error(\"XMLHttpRequest not found\");\r\n      }\r\n      var teacherInfo = $cookieStore.get(\"user\");\r\n      var token = teacherInfo['token'];\r\n      ajax.onreadystatechange = function() {\r\n        if (ajax.readyState == 4) {\r\n          if (ajax.status == 200) {\r\n            var response = JSON.parse(ajax.response);\r\n            // var teacherCorrectImg = api_url + '/resource/' + response.con.mini + '?inline=true&token=' + token;\r\n            var teacherCorrectImg = response.data.url;\r\n            $scope.$apply(function() {\r\n              $scope.submitAnswer(index, \"picture\", teacherCorrectImg);\r\n            })\r\n          }\r\n        }\r\n      }\r\n      ajax.open(\"POST\", api_url + \"/upload?type=\" + 1 + \"&token=\" + token, true);\r\n      ajax.send(fd);\r\n    })\r\n  }\r\n\r\n  /* \r\n    \r\n    @param index index\r\n    @param type   \r\n    $param value \r\n  */\r\n\r\n  $scope.submitAnswer = function(index, type, value) {\r\n    index = Number(index);\r\n    /*firstly check whether this is first to correct */\r\n    if ($scope.currentStudent.correct === undefined || $scope.currentStudent.correct === null || $scope.currentStudent.correct.length === 0) {\r\n      var correct = [],\r\n        correctType = [];\r\n      for (var i = 0, ii = $scope.currentQuestion.choices[0].length; i < ii; i++) {\r\n        correct.push({ \"correct\": {} });\r\n        correctType.push(0);\r\n      }\r\n      $scope.currentStudent.correct = correct;\r\n      $scope.currentStudent.correctType = correctType;\r\n    }\r\n\r\n    if (type == \"textarea\") {\r\n      if (value == null) {\r\n        delete $scope.currentStudent.correct[index].correct['textarea'];\r\n      } else {\r\n        $scope.currentStudent.correct[index].correct['textarea'] = value;\r\n      }\r\n      // console.log($scope.currentStudent.correct[index].correct['textarea']);\r\n    }\r\n    if (type == \"picture\") {\r\n      if (value == null) {\r\n        delete $scope.currentStudent.correct[index].correct['picture'];\r\n        // } else if ($scope.currentStudent.correct[index].correct['picture'] && $scope.currentStudent.correct[index].correct['picture'].constructor == Array) {\r\n        // } else if ($scope.currentStudent.correct[index].correct['picture'] && img == 'delete') {\r\n        // $scope.currentStudent.correct[index].correct['picture'] = [];\r\n        // $scope.currentStudent.correct[index].correct['picture'] = value;\r\n        // } else if ($scope.currentStudent.correct[index].correct['picture'] && img == 'upload') {\r\n        // $scope.currentStudent.correct[index].correct['picture'] = value;\r\n        // $scope.currentStudent.correct[index].correct['picture'].push(value);\r\n      } else {\r\n        $scope.currentStudent.correct[index].correct['picture'] = value;\r\n        // $scope.currentStudent.correct[index].correct['picture'] = [];\r\n        // $scope.currentStudent.correct[index].correct['picture'].push(value);\r\n      }\r\n    }\r\n\r\n    if (type == \"score\") {\r\n      $scope.currentStudent.correct[index]['score'] = parseInt(value);\r\n      // $scope.currentStudent.correctType[index] = 0;\r\n    }\r\n    if (type == \"audio\") {\r\n      if (value == null) {\r\n        delete $scope.currentStudent.correct[index].correct['audio'];\r\n      }\r\n    }\r\n    var totalScore = 0;\r\n    for (var i = 0; i < $scope.currentStudent.correct.length; i++) {\r\n      var score = $scope.currentStudent.correct[i].score;\r\n      if (score != undefined) {\r\n        totalScore += parseInt(score);\r\n      }\r\n    }\r\n    $scope.currentStudent.score = totalScore;\r\n    /*\r\n      0  \r\n      \r\n    */\r\n\r\n    var teacherInfo = $cookieStore.get(\"user\");\r\n    var teacherCorrectInfo = {\r\n      \"studentId\": $scope.currentStudent.studentId,\r\n      \"workId\": $scope.workId,\r\n      \"qid\": $scope.currentQuestion.qid,\r\n      \"qOrder\": index + 1,\r\n      \"tid\": teacherInfo.tid,\r\n      \"correct\": $scope.currentStudent.correct[index].correct,\r\n      \"score\": $scope.currentStudent.correct[index].score\r\n    };\r\n\r\n    // console.log(teacherCorrectInfo)\r\n\r\n    correctService.submit(JSON.stringify(teacherCorrectInfo)).then(function(data) {\r\n      // if( typeof data != \"object\" || data.con == null) {\r\n      //       alert('');\r\n      //       return;\r\n      // }\r\n      // correctService.showTip(\"\");\r\n      // console.log($scope.currentStudent.correct)\r\n      var correctedFlag = true;\r\n      for (var i = 0, ii = $scope.currentQuestion.choices[0].length; i < ii; i++) {\r\n        if ($scope.currentStudent.correct[i]['score'] == undefined) {\r\n          correctedFlag = false;\r\n          break;\r\n        }\r\n      }\r\n      if (correctedFlag == true) {\r\n        $scope.currentStudent.type = 1;\r\n        $scope.currentStudent.score = totalScore;\r\n        $scope.students[$scope.currentStudentIndex] = $scope.currentStudent;\r\n      }\r\n    })\r\n  }\r\n\r\n  $scope.submitText = function(event, index) {\r\n    var text = $(event.target).val();\r\n    $scope.submitAnswer(index, \"textarea\", text);\r\n\r\n  }\r\n  $scope.submitScore = function(event, index) {\r\n    // console.log(index)\r\n    var score = $(event.target).val();\r\n    var maxscore = $scope.currentQuestion.choices[1][index];\r\n    if ($.trim(score) == \"\") {\r\n      return;\r\n    }\r\n    if (!/^\\d+$/.test(score)) {\r\n      // correctService.showTip(\"\"); \r\n      $(event.target).parent().parent().siblings(\".highScoreTip\").text(\"*:\").show();\r\n      return;\r\n    } else {\r\n      $(event.target).parent().parent().siblings(\".highScoreTip\").hide();\r\n    }\r\n    if (parseInt(score) > maxscore) {\r\n      $(event.target).parent().parent().siblings(\".highScoreTip\").text(\"*:\").show();\r\n      return;\r\n    } else {\r\n      $(event.target).parent().parent().siblings(\".highScoreTip\").hide();\r\n    }\r\n\r\n    $(event.target).val(\"\").parent().siblings(\".score\").removeClass(\"computerCorrect\").show().children(\"span\").show();\r\n    $scope.submitAnswer(index, \"score\", score);\r\n  }\r\n\r\n\r\n  $scope.confirmScore = function(event, index) {\r\n    var $confirmBtn = $(event.target);\r\n    var score = $confirmBtn.siblings(\".score_input\").val();\r\n    if (!/^\\d+$/.test(parseInt(score))) {\r\n      return;\r\n    }\r\n    $confirmBtn.siblings(\".score\").removeClass(\"computerCorrect\").children(\"span\").show();\r\n    $scope.submitAnswer(index, \"score\", score);\r\n  }\r\n\r\n\r\n  $scope.selectQuestion = function(tixu, event) {\r\n    var qid = tixu.qid;\r\n    var parentId = tixu.parentId;\r\n    var parentTixu = tixu.parentTixu;\r\n\r\n    if (parentId != 0) {\r\n      $scope.currentQuestion = correctService.findObjInArray($scope.stems[parentId.toString()], \"qid\", qid);\r\n      $scope.currentQuestion.parent = correctService.findObjInArray($scope.questions, \"mid\", parentId);\r\n      $scope.currentQuestion.parentTixu = parentTixu;\r\n      $scope.currentQuestion.parentId = parentId\r\n      $scope.currentQuestion.tixu = tixu.tixu;\r\n    } else {\r\n      $scope.currentQuestion = correctService.findObjInArray($scope.questions, \"qid\", qid);\r\n      $scope.currentQuestion.tixu = tixu.tixu;\r\n    }\r\n    $(event.target).addClass(\"selected\").siblings().removeClass(\"selected\");\r\n    correctService.getCorrectInfoByqid($scope.workId, $scope.currentQuestion.qid)\r\n      .then(function(data) {\r\n        $scope.studentSort(data.studentList, 0);\r\n        if ($scope.currentQuestion.qType == 2 && angular.isDefined($scope.currentStudent)) {\r\n          $scope.isDisplayText();\r\n          //,\r\n          for (var i = 0; i < $scope.subjectiveQuestions.length; i++) {\r\n            if ($scope.currentQuestion.qid == $scope.subjectiveQuestions[i].qid) {\r\n              $scope.currentSubjectiveIndex = i;\r\n            }\r\n          }\r\n        }\r\n      })\r\n  }\r\n  $scope.showMiddle = function(event) {\r\n    var $target = $(event.target);\r\n    var $middle = $target.siblings(\".middle\");\r\n    $target.hide();\r\n    $middle.show();\r\n    $middle.on(\"mouseover\", function() {\r\n      $(this).show();\r\n      $target.hide();\r\n    });\r\n    $middle.on(\"mouseout\", function() {\r\n      $(this).hide();\r\n      $target.show();\r\n    });\r\n    $target.on(\"mouseout\", function() {\r\n      $middle.hide();\r\n      $target.show();\r\n    });\r\n  }\r\n\r\n  // \r\n  // console.log($scope.messageType);\r\n  $scope.changeMessageType = function(){\r\n    if ($scope.messageType == 1){\r\n      $scope.messageType = 2;\r\n    } else {\r\n      $scope.messageType = 1;\r\n    }\r\n    // console.log($scope.messageType);\r\n  }\r\n\r\n  /*  */\r\n  $scope.finishCorrect = function() {\r\n    (function() {\r\n      var bodyWidth = $(window).width();\r\n      var bodyHeight = $(window).height();\r\n      var left = (bodyWidth - 340) / 2;\r\n      var top = (bodyHeight - 200) / 2;\r\n      var popupBox;\r\n      // console.log($scope.baseInfo.unlimited, $scope.baseInfo.endTime)\r\n      if (!$scope.baseInfo.unlimited && Date.parse(new Date()) < Date.parse($scope.baseInfo.endTime)) {\r\n        popupBox = '<div id=\"popupBox\" style=\"width:340px;height:200px;border:1px solid #d3d3d3;' + 'position:fixed;top:' + top + 'px' + ';left:' + left + 'px;background:#fff;' + ';z-index:99999;border-radius:4px;\">' + '<p style=\"font-size:14px;color:#797979;margin:25px;margin-top:40px;\">' + '!' + '</p>' + '<div style=\"margin-left:25px;margin-right:25px;\">' + '<a style=\"width:120px;height:33px;background:#e4e4e4;display:block;text-align:center;line-height:33px;float:left;cursor:pointer;\" id=\"thanks\"></a>' + '<a style=\"width:120px;height:33px;background:#009e4d;display:block;text-align:center;line-height:33px;float:right;color:#fff;cursor:pointer;\" id=\"thanks-again\" ></a>' + '</div>' + '</div>';\r\n      } else {\r\n        popupBox = '<div id=\"popupBox\" style=\"width:340px;height:200px;border:1px solid #d3d3d3;' + 'position:fixed;top:' + top + 'px' + ';left:' + left + 'px;background:#fff;' + ';z-index:99999;border-radius:4px;\">' + '<p style=\"font-size:14px;color:#797979;margin:25px;margin-top:40px;\">' + ',,?' + '</p>' + '<div style=\"margin-left:25px;margin-right:25px;\">' + '<a style=\"width:120px;height:33px;background:#e4e4e4;display:block;text-align:center;line-height:33px;float:left;cursor:pointer;\" id=\"thanks\"></a>' + '<a style=\"width:120px;height:33px;background:#009e4d;display:block;text-align:center;line-height:33px;float:right;color:#fff;cursor:pointer;\" id=\"doBigSave\" ></a>' + '</div>' + '</div>';\r\n      }\r\n      $(\"body\").append(popupBox);\r\n      $(\"#thanks\").click(function() {\r\n        $(\"#popupBox\").remove();\r\n      });\r\n      $(\"#thanks-again\").click(function() {\r\n        $(\"#popupBox\").remove();\r\n      });\r\n      $(\"#doBigSave\").click(function() {\r\n        $(\"#popupBox\").remove();\r\n        correctService.changeWorkStatus($scope.workId,$scope.messageType)\r\n          .then(function(data) {\r\n            // if (!data.status) {\r\n            //   correctService.showTip(\"\");\r\n            // } else {\r\n            //   correctService.showTip(\"\");\r\n            // }\r\n          })\r\n      });\r\n    })();\r\n  }\r\n\r\n  /*\r\n    @param qid \r\n    @param currentStudentIndex\r\n  */\r\n  $scope.getOneQuestionCorrectInfo = function(qid, index) {\r\n    correctService.getCorrectInfoByqid($scope.workId, qid)\r\n      .then(function(data) {\r\n        $scope.studentSort(data.studentList, index);\r\n        $scope.isDisplayText();\r\n      });\r\n  };\r\n\r\n  $scope.prevSub = function() {\r\n    $scope.currentSubjectiveIndex -= 1;\r\n    if ($scope.currentSubjectiveIndex < 0) {\r\n      $scope.currentSubjectiveIndex = 0;\r\n      // $scope.getOneQuestionCorrectInfo($scope.currentQuestion.qid, 0);\r\n      return;\r\n    }\r\n    $scope.currentQuestion = $scope.subjectiveQuestions[$scope.currentSubjectiveIndex];\r\n    $scope.currentQuestion.parent = correctService.findObjInArray($scope.questions, \"mid\", $scope.currentQuestion.parentId);\r\n    var tixu = $scope.currentQuestion.tixu;\r\n    var sort_list = $(\".sort_list li\");\r\n    for (var i = 0; i < sort_list.length; i++) {\r\n      if ($.trim(sort_list.eq(i).text()) == tixu) {\r\n        sort_list.eq(i).addClass(\"selected\").siblings().removeClass(\"selected\");\r\n      }\r\n    }\r\n    $(\".highScoreTip\").hide();\r\n    $scope.getOneQuestionCorrectInfo($scope.currentQuestion.qid, 0);\r\n  }\r\n\r\n\r\n  $scope.nextSub = function() {\r\n    $scope.currentSubjectiveIndex += 1;\r\n    if ($scope.currentSubjectiveIndex >= $scope.subjectiveQuestions.length) {\r\n      $scope.currentSubjectiveIndex = $scope.subjectiveQuestions.length - 1;\r\n      // $scope.getOneQuestionCorrectInfo($scope.currentQuestion.qid, 0);\r\n      return;\r\n    }\r\n    $scope.currentQuestion = $scope.subjectiveQuestions[$scope.currentSubjectiveIndex];\r\n    $scope.currentQuestion.parent = correctService.findObjInArray($scope.questions, \"mid\", $scope.currentQuestion.parentId);\r\n    var tixu = $scope.currentQuestion.tixu;\r\n    var sort_list = $(\".sort_list li\");\r\n    for (var i = 0; i < sort_list.length; i++) {\r\n      if ($.trim(sort_list.eq(i).text()) == tixu) {\r\n        sort_list.eq(i).addClass(\"selected\").siblings().removeClass(\"selected\");\r\n      }\r\n    }\r\n    $(\".highScoreTip\").hide();\r\n    $scope.getOneQuestionCorrectInfo($scope.currentQuestion.qid, 0);\r\n  };\r\n\r\n\r\n  $scope.prevUser = function() {\r\n    $scope.currentStudentIndex -= 1;\r\n    if ($scope.currentStudentIndex < 0) {\r\n      $scope.currentStudentIndex = 0;\r\n      return;\r\n    }\r\n    $(\".highScoreTip\").hide();\r\n    correctService.getCorrectInfoByqid($scope.workId, $scope.currentQuestion.qid)\r\n      .then(function(data) {\r\n        // $scope.studentSort(data.studentList, index);\r\n        $scope.currentStudent = $scope.students[$scope.currentStudentIndex];\r\n        // $scope.isDisplayText();\r\n      })\r\n      // $scope.getOneQuestionCorrectInfo($scope.currentQuestion.qid, $scope.currentStudentIndex);\r\n  }\r\n\r\n\r\n  $scope.nextUser = function() {\r\n    $scope.currentStudentIndex += 1;\r\n    if ($scope.currentStudentIndex >= $scope.students.length) {\r\n      $scope.currentStudentIndex = $scope.students.length - 1;\r\n      return;\r\n    }\r\n    $(\".highScoreTip\").hide();\r\n    correctService.getCorrectInfoByqid($scope.workId, $scope.currentQuestion.qid)\r\n      .then(function(data) {\r\n        // $scope.studentSort(data.studentList, index);\r\n        $scope.currentStudent = $scope.students[$scope.currentStudentIndex];\r\n        // $scope.isDisplayText();\r\n      })\r\n      // $scope.getOneQuestionCorrectInfo($scope.currentQuestion.qid, $scope.currentStudentIndex);\r\n\r\n  }\r\n\r\n  /*/*/\r\n  $scope.toggleQuestionInfo = function() {\r\n    $scope.isShowQuestionInfo = $scope.isShowQuestionInfo == 1 ? 0 : 1;\r\n  }\r\n\r\n  /*click to choose one student */\r\n  $scope.selectUser = function(studentId, index) {\r\n    $scope.startCorrect = 1;\r\n    // $scope.currentStudent = correctService.findObjInArray($scope.students, 'studentId', studentId);\r\n    // $scope.currentStudentIndex = $scope.students.indexOf($scope.currentStudent);\r\n    $scope.currentStudentIndex = index;\r\n    // correctService.getCorrectInfoByqid($scope.workId, $scope.currentQuestion.qid)\r\n    // .then(function(data) {\r\n    // $scope.studentSort(data.studentList, index);\r\n    $scope.currentStudent = $scope.students[index];\r\n    $scope.isDisplayText();\r\n    // })\r\n    $(\".highScoreTip\").hide();\r\n    $(\".student_list\").children(\"[data-studentId=\" + studentId + \"]\").addClass(\"active\").siblings().removeClass(\"active\");\r\n  }\r\n\r\n  $scope.zoomImg = function(event) {\r\n    var bodyWidth = $(\"body\").width();\r\n    var zoomBoxWidth = (bodyWidth - 80);\r\n    var $target = $(event.target);\r\n    var src = $target.attr(\"src\");\r\n    src = src.replace(\"mini_\", \"\");\r\n    // console.log(src);\r\n\r\n    var overLay = \"<div id=\\\"zoomImageOverlay\\\" style=\\\"position:fixed;top:0;left:0;width:100%;\" + \"height:100%;background:black;opacity:0.75;text-align:center;z-index:9999;\\\"></div>\" + \"<div id=\\\"zoomImageBox\\\"style=\\\"position:absolute;top:0;left:0;z-index:99999;\" + \"text-align:center;width:100%;\\\"><img title=\\\"\\\" src=\\\"\" + src + \"\\\" style=\\\"max-width:1200px;\" + \"cursor:pointer;margin-top:40px;background:#fff;\\\"/>\" + \"<span id=\\\"zoomImageBoxCloseBtn\\\" style=\\\"width:36px;height:36px;border-radius:18px;\" + \"cursor:pointer;text-align:center;line-height:36px;color:#fff;position:fixed;top:10px;\" + \"right:50px;font-size:26px;border:1px solid #fff; \\\">X</span></div>\";\r\n    $(\"body\").append(overLay).scrollTop(0);\r\n    $(\"#zoomImageBoxCloseBtn\").click(function() {\r\n      $(\"#zoomImageBox\").remove();\r\n      $(\"#zoomImageOverlay\").remove();\r\n    })\r\n    var degree = 0;\r\n    $(\"#zoomImageBox\").children(\"img\").click(function() {\r\n      degree += 90;\r\n      $(\"#zoomImageBox\").children(\"img\").css({ \"transform\": \"rotate(+\" + degree + \"deg)\", \"-webkit-transform\": \"rotate(+\" + degree + \"deg)\", \"-moz-transform\": \"rotate(+\" + degree + \"deg)\" })\r\n\r\n    })\r\n\r\n  }\r\n\r\n  /*=================================\r\n  keyboard control \r\n    \r\n  \r\n  ===================================*/\r\n  \r\n  $(document).on(\"keydown\", function(event) {\r\n    var keycode = event.which;\r\n    if (keycode == 40) {\r\n      $scope.nextUser();\r\n    }\r\n    if (keycode == 38) {\r\n      $scope.prevUser();\r\n    }\r\n    if (keycode == 37) {\r\n      $scope.prevSub();\r\n    }\r\n    if (keycode == 39) {\r\n      $scope.nextSub();\r\n    }\r\n  })\r\n\r\n}]);\r\n\r\n\r\n//\r\napp.controller(\"setting\", ['$scope', '$http', '$cookieStore', '$interval', function($scope, $http, $cookieStore, $interval) {\r\n  //cookietid\r\n  $scope.tid = $cookieStore.get(\"user\").tid;\r\n  $scope.token = $cookieStore.get(\"user\").token;\r\n\r\n  //tid \r\n  $scope.getInfo = function() {\r\n    $http.get(api_url + \"/teacher?tid=\" + $scope.tid)\r\n      .success(function(data) {\r\n        $scope.teacher = data;\r\n        $scope.uid = data.uid;\r\n      })\r\n  }\r\n  $scope.getInfo();\r\n\r\n  //\r\n  $scope.editName = function() {\r\n    if ($scope.teacher.teacherName) {\r\n      $http.put(api_url + '/teacher', {\r\n        \"teacherName\": $scope.teacher.teacherName,\r\n        \"tid\": $scope.tid\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          // alert('!');\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.editNumber = function(type) {\r\n    $scope.myModal = true;\r\n    $scope.numberModal = true;\r\n    $scope.validate = true;\r\n    $scope.editType = type;\r\n  }\r\n\r\n  //\r\n  $scope.getPicCaptcha = function() {\r\n    $http.get(api_url + \"/image/code?w=100&h=40\")\r\n      .success(function(data) {\r\n        $scope.image = data.image;\r\n        $scope.key = data.codeKey;\r\n      })\r\n  };\r\n\r\n  //\r\n  $scope.validatePwd = function() {\r\n    if ($scope.password) {\r\n      //md5\r\n      $scope.md5Pwd = hex_md5($scope.password);\r\n      $scope.md5Pwd = $scope.md5Pwd.split('');\r\n      $scope.md5Pwd[5] = $scope.password.charAt(0);\r\n      $scope.md5Pwd[10] = $scope.password.charAt(1);\r\n      $scope.md5Pwd[15] = $scope.password.charAt(2);\r\n\r\n      $http.post(api_url + '/user/confirmation', {\r\n        'uid': $scope.uid,\r\n        'password': $scope.md5Pwd.join('')\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.validate = false;\r\n          if ($scope.editType == 1) {\r\n            $scope.getPicCaptcha();\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  //\r\n  var accountExp = /^[a-zA-Z]\\w+$/,\r\n    phoneExp = /^1[34578]\\d{9}$/,\r\n    mailExp = /^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$/;\r\n\r\n  //\r\n  $scope.setTimer = function() {\r\n    $scope.second = 60;\r\n    $scope.timer = null;\r\n    $scope.timer = $interval(function() {\r\n      $scope.second--;\r\n      if ($scope.second == 0) {\r\n        $interval.cancel($scope.timer);\r\n      }\r\n    }, 1000);\r\n  }\r\n\r\n  //\r\n  $scope.getCaptcha = function() {\r\n    if ($scope.editType == 1) {\r\n      if (!$scope.phoneCaptcha) {\r\n        alert(\"!\");\r\n        return;\r\n      }\r\n      //\r\n      if ($scope.newPhone && phoneExp.test($scope.newPhone)) {\r\n        $http.put(api_url + '/user/only', {\r\n          'phone': $scope.newPhone\r\n        }).success(function(data) {\r\n          if (!data.status) {\r\n            //\r\n            $http.post(api_url + '/captcha/create', {\r\n              \"isRegister\": 1,\r\n              'phone': $scope.newPhone,\r\n              \"code\": $scope.phoneCaptcha,\r\n              \"codeKey\": $scope.key\r\n            }).success(function(data) {\r\n              if (!data.status) {\r\n                $scope.setTimer();\r\n              }\r\n            })\r\n          }\r\n        })\r\n      } else {\r\n        alert(\"!\")\r\n      }\r\n    } else if ($scope.editType == 2) {\r\n      //\r\n      if ($scope.newMail && mailExp.test($scope.newMail)) {\r\n        $http.put(api_url + '/user/only', {\r\n          'email': $scope.newMail\r\n        }).success(function(data) {\r\n          if (!data.status) {\r\n            //\r\n            $http.post(api_url + '/email/captcha/create', {\r\n              'email': $scope.newMail\r\n            }).success(function(data) {\r\n              if (!data.status) {\r\n                $scope.setTimer();\r\n              }\r\n            })\r\n          }\r\n        })\r\n      } else {\r\n        alert(\"!\")\r\n      }\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.confirmEdit = function() {\r\n    if ($scope.editType == 1) {\r\n      $http.put(api_url + '/modify/phone', {\r\n        'uid': $scope.uid,\r\n        'phone': $scope.newPhone,\r\n        'captcha': $scope.phonePwd\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.teacher.phone = $scope.newPhone;\r\n          $scope.hideModal();\r\n        }\r\n      })\r\n    } else if ($scope.editType == 2) {\r\n      $http.put(api_url + '/modify/email', {\r\n        'uid': $scope.uid,\r\n        'email': $scope.newMail,\r\n        'captcha': $scope.mailPwd\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.teacher.email = $scope.newMail;\r\n          $scope.hideModal();\r\n        }\r\n      })\r\n    } else if ($scope.editType == 3) {\r\n      if ($scope.newAccount && accountExp.test($scope.newAccount)) {\r\n        $http.put(api_url + '/modify/account', {\r\n          'uid': $scope.uid,\r\n          'account': $scope.newAccount\r\n        }).success(function(data) {\r\n          if (!data.status) {\r\n            $scope.teacher.account = $scope.newAccount;\r\n            $scope.hideModal();\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.hideModal = function() {\r\n    $scope.myModal = false;\r\n    $scope.numberModal = false;\r\n    $scope.tagModal = false;\r\n    $interval.cancel($scope.timer);\r\n    $scope.second = 0;\r\n    $scope.password = '';\r\n    $scope.phonePwd = '';\r\n    $scope.mailPwd = '';\r\n    $scope.newMail = '';\r\n    $scope.newPhone = '';\r\n    $scope.newAccount = '';\r\n  }\r\n\r\n  //\r\n  $scope.getTeacherTag = function() {\r\n    $http.get(api_url + '/tag/teacher?tid=' + $scope.tid)\r\n      .success(function(data) {\r\n        $scope.teacherTags = [];\r\n        $scope.courseTags = [];\r\n        angular.forEach(data.tagList, function(ele) {\r\n          if (ele.tagType == 1) {\r\n            angular.forEach(ele.childList, function(element) {\r\n              element.tagName = ele.tagName + element.tagName;\r\n              $scope.teacherTags.push(element);\r\n            })\r\n          } else if (ele.tagType == 3) {\r\n            $scope.courseTags.push(ele);\r\n          }\r\n        })\r\n      })\r\n  }\r\n  $scope.getTeacherTag();\r\n\r\n  //\r\n  $http.get(api_url + '/tag/public/stage/grade')\r\n    .success(function(data) {\r\n      $scope.tags = data.stageList;\r\n    })\r\n\r\n  //\r\n  $http.get(api_url + '/tag?isPublic=1&tagType=3&isUse=1&page=1&size=1000')\r\n    .success(function(data) {\r\n      $scope.courses = data.tagList;\r\n    })\r\n\r\n  //\r\n  $scope.editPhoto = function() {\r\n    $(\"#file\").click();\r\n  }\r\n\r\n  $scope.flag = true; //\r\n\r\n  function handleFileSelect(evt) {\r\n    var files = evt.target.files,\r\n      f = files[0];\r\n    var limit = 1024 * 1024;\r\n\r\n    if (f.size / limit > 10) { //M\r\n      toastr.info(\"!\")\r\n      return;\r\n    }\r\n\r\n    var formData = new FormData($(\"#uploadPicForm\")[0]);\r\n    if (!files.length) {\r\n      alert(\"\");\r\n      return;\r\n    }\r\n\r\n    $scope.flag = false;\r\n\r\n    //\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.upload.addEventListener(\"load\", loadedProgress, false);\r\n    xhr.open(\"POST\", api_url + \"/upload?w=120&h=120&type=1&token=\" + $scope.token);\r\n    //\r\n    function loadedProgress(evt) {\r\n      $scope.flag = true;\r\n    }\r\n\r\n    xhr.send(formData);\r\n\r\n    xhr.onreadystatechange = function() {\r\n      if (xhr.readyState == 4) {\r\n        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304) {\r\n          $scope.$apply(function() {\r\n            $scope.teacher.photo = JSON.parse(xhr.responseText).data.url;\r\n          })\r\n          $http.put(api_url + '/teacher', {\r\n            \"photo\": $scope.teacher.photo,\r\n            \"tid\": $scope.tid\r\n          }).success(function(data) {\r\n            if (!data.status) {\r\n              // alert('!');\r\n            }\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n  document.getElementById('file').addEventListener('change', handleFileSelect, false);\r\n\r\n  //\r\n  $scope.deleteTag = function(id) {\r\n    $http({\r\n      method: \"delete\",\r\n      url: api_url + '/tag/teacher',\r\n      data: { \"id\": [id] },\r\n      headers: { \"Content-Type\": \"application/json;charset=utf-8\" }\r\n    }).success(function(data) {\r\n      if (!data.status) {\r\n        $scope.getTeacherTag();\r\n      }\r\n    })\r\n  }\r\n\r\n  //\r\n  $scope.modalGrade = function() {\r\n    $scope.myModal = true;\r\n    $scope.tagModal = true;\r\n    $scope.gradeModal = true;\r\n\r\n    $scope.choosenTagIds = [];\r\n    $scope.chooseTagIds = [];\r\n\r\n    angular.forEach($scope.teacherTags, function(ele) {\r\n      $scope.choosenTagIds.push(ele.tagId);\r\n      if ($scope.choosenTagIds.indexOf(ele.parentTagId) == -1) {\r\n        $scope.choosenTagIds.push(ele.parentTagId);\r\n      }\r\n    })\r\n\r\n    $scope.chooseTagIds = $scope.chooseTagIds.concat($scope.choosenTagIds);\r\n  }\r\n\r\n  $scope.chooseTag = function(id, parentId) {\r\n    if ($scope.choosenTagIds.indexOf(id) != -1) return;\r\n    $scope.tagIdx = $scope.chooseTagIds.indexOf(id);\r\n    if ($scope.tagIdx == -1) {\r\n      $scope.chooseTagIds.push(id);\r\n      $scope.chooseTagIds.push(parentId);\r\n    } else {\r\n      $scope.chooseTagIds.splice($scope.tagIdx, 1);\r\n      $scope.parentIdx = $scope.chooseTagIds.indexOf(parentId);\r\n      $scope.chooseTagIds.splice($scope.parentIdx, 1);\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.modalCourse = function() {\r\n    $scope.myModal = true;\r\n    $scope.tagModal = true;\r\n    $scope.gradeModal = false;\r\n\r\n    $scope.choosenCourseIds = [];\r\n    $scope.chooseCourseIds = [];\r\n\r\n    angular.forEach($scope.courseTags, function(ele) {\r\n      $scope.choosenCourseIds.push(ele.tagId);\r\n    })\r\n\r\n    $scope.chooseCourseIds = $scope.chooseCourseIds.concat($scope.choosenCourseIds);\r\n  }\r\n\r\n  $scope.chooseCourse = function(id) {\r\n    if ($scope.choosenCourseIds.indexOf(id) != -1) return;\r\n    $scope.CourseIdx = $scope.chooseCourseIds.indexOf(id);\r\n    if ($scope.CourseIdx == -1) {\r\n      $scope.chooseCourseIds.push(id);\r\n    } else {\r\n      $scope.chooseCourseIds.splice($scope.CourseIdx, 1);\r\n    }\r\n  }\r\n\r\n  //\r\n  $scope.unique = function(arr) {\r\n    $scope.n = {};\r\n    $scope.tempArr = []; //nhashr\r\n    for (var i = 0; i < arr.length; i++) //\r\n    {\r\n      if (!$scope.n[arr[i]]) //hash\r\n      {\r\n        $scope.n[arr[i]] = true; //hash\r\n        $scope.tempArr.push(arr[i]); //push\r\n      }\r\n    }\r\n    return $scope.tempArr;\r\n  }\r\n\r\n  $scope.confirm = function() {\r\n    if ($scope.gradeModal) {\r\n      $scope.unique($scope.chooseTagIds);\r\n      angular.forEach($scope.choosenTagIds, function(element) {\r\n        $scope.tempArrIdx = $scope.tempArr.indexOf(element);\r\n        if ($scope.tempArrIdx != -1) {\r\n          $scope.tempArr.splice($scope.tempArrIdx, 1);\r\n        }\r\n      })\r\n      $http.post(api_url + '/tag/teacher', {\r\n        \"tagId\": $scope.tempArr,\r\n        \"tid\": [$scope.tid]\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.hideModal();\r\n          $scope.getTeacherTag();\r\n        }\r\n      })\r\n    } else {\r\n      $http.post(api_url + '/tag/teacher', {\r\n        \"tagId\": $scope.chooseCourseIds.splice($scope.choosenCourseIds.length),\r\n        \"tid\": [$scope.tid]\r\n      }).success(function(data) {\r\n        if (!data.status) {\r\n          $scope.hideModal();\r\n          $scope.getTeacherTag();\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n}]);\r\n\r\n\r\n//\r\napp.controller(\"password\", ['$scope', '$http', function($scope, $http) {\r\n  $scope.submit = function() {\r\n    if ($scope.newPassword && !/^\\w{6,20}$/.test($scope.newPassword)) {\r\n      alert('6-20');\r\n    }\r\n    if (!$scope.oldPassword || !$scope.newPassword || $scope.newPassword != $scope.rePassword) {\r\n      alert('');\r\n      return;\r\n    }\r\n    //md5\r\n    $scope.md5oldPwd = hex_md5($scope.oldPassword);\r\n    $scope.md5oldPwd = $scope.md5oldPwd.split('');\r\n    $scope.md5oldPwd[5] = $scope.oldPassword.charAt(0);\r\n    $scope.md5oldPwd[10] = $scope.oldPassword.charAt(1);\r\n    $scope.md5oldPwd[15] = $scope.oldPassword.charAt(2);\r\n\r\n    $scope.md5newPwd = hex_md5($scope.newPassword);\r\n    $scope.md5newPwd = $scope.md5newPwd.split('');\r\n    $scope.md5newPwd[5] = $scope.newPassword.charAt(0);\r\n    $scope.md5newPwd[10] = $scope.newPassword.charAt(1);\r\n    $scope.md5newPwd[15] = $scope.newPassword.charAt(2);\r\n\r\n    $http.put(api_url + '/changePassword', {\r\n      \"oldpassword\": $scope.md5oldPwd.join(''),\r\n      \"newpassword\": $scope.md5newPwd.join('')\r\n    }).success(function(data) {\r\n      if (!data.status) {\r\n        alert('!');\r\n        $scope.oldPassword = '';\r\n        $scope.newPassword = '';\r\n        $scope.rePassword = '';\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n\r\n}]);\r\n\r\n\r\n//\r\napp.controller(\"account\", ['$scope', '$http', function($scope, $http) {\r\n  $http.get(api_url + '/account/statistics')\r\n    .success(function(data) {\r\n      $scope.account = data;\r\n    })\r\n\r\n}]);\r\n\nvar myFilter = angular.module(\"myFilter\", []);\r\n\r\n//\r\nmyFilter.filter(\"createChoice\", function() {\r\n  return function(data) {\r\n    var arr = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'];\r\n\r\n    //\r\n    if (angular.isArray(data)) {\r\n      var result = [];\r\n      angular.forEach(data, function(value, index, array) {\r\n        result.push((angular.isUndefined(arr[value])) ? '' : arr[value])\r\n      })\r\n      return result;\r\n    } else {\r\n      return (angular.isUndefined(arr[data])) ? '' : arr[data];\r\n    }\r\n\r\n  }\r\n})\r\n\r\n//\r\nmyFilter.filter('arraySplit', function() {\r\n  return function(arr, delimiter) {\r\n    //var delimiter = ',';\r\n    if (angular.isArray(arr) && angular.isString(delimiter)) {\r\n      return arr.join(delimiter);\r\n    }\r\n    return arr;\r\n  }\r\n})\r\n\r\n//\r\nmyFilter.filter('escape2Html', function() {\r\n  return function(str) {\r\n    if ($.trim(str) !== '') {\r\n      var arrEntities = { 'lt': '<', 'gt': '>', 'nbsp': ' ', 'amp': '&', 'quot': '\"' };\r\n      return str.replace(/&(lt|gt|nbsp|amp|quot);/ig, function(all, t) {\r\n        return arrEntities[t];\r\n      });\r\n    }\r\n    return str;\r\n  }\r\n})\r\n\r\n//\r\nmyFilter.filter(\"timeFormat\", function() {\r\n  return function(str) {\r\n    var timeNum = parseInt(str) * 1000;\r\n    var time = new Date(timeNum);\r\n    var year = time.getFullYear();\r\n    var month = time.getMonth() + 1;\r\n    var day = time.getDate();\r\n    var hours = time.getHours();\r\n    var minutes = time.getMinutes();\r\n    //10\"0\";\r\n    if (month < 10) { month = \"0\" + month; }\r\n    if (day < 10) { day = \"0\" + day }\r\n    if (hours < 10) { hours = \"0\" + hours }\r\n    if (minutes < 10) { minutes = \"0\" + minutes }\r\n    var date = year + \"/\" + month + \"/\" + day + \" \" + hours + \":\" + minutes;\r\n    return date;\r\n  }\r\n})\r\n\r\nmyFilter.filter(\"timeFormat1\", function() {\r\n  return function(str) {\r\n    var timeNum = parseInt(str);\r\n    var time = new Date(timeNum);\r\n    var year = time.getFullYear();\r\n    var month = time.getMonth() + 1;\r\n    var day = time.getDate();\r\n    var hours = time.getHours();\r\n    var minutes = time.getMinutes();\r\n    //10\"0\";\r\n    if (month < 10) { month = \"0\" + month; }\r\n    if (day < 10) { day = \"0\" + day }\r\n    if (hours < 10) { hours = \"0\" + hours }\r\n    if (minutes < 10) { minutes = \"0\" + minutes }\r\n    var date = year + \"/\" + month + \"/\" + day + \" \" + hours + \":\" + minutes;\r\n    return date;\r\n  }\r\n})\r\n\r\n\r\n//, \r\nmyFilter.filter('hmdFormat', ['$filter', function($filter) {\r\n  return function(date) {\r\n    var minutes = '';\r\n    var hours = '';\r\n    var seconds = '';\r\n    var time = '';\r\n\r\n    //\r\n    if (date >= 86400) {\r\n      //,\r\n      if (date.toString().length == 10) date *= 1000;\r\n      return $filter('date')(date, 'yyyy/MM/dd HH:mm:ss');\r\n    }\r\n    if (date < 60) {\r\n      seconds = date;\r\n    } else {\r\n\r\n      //\r\n      if (date > 60 && date < 60 * 60) {\r\n        minutes = parseInt(date / 60);\r\n\r\n        //\r\n        if (!date % 60 === 0) {\r\n          seconds = date % 60;\r\n        }\r\n        //\r\n      } else {\r\n        hours = parseInt(date / 3600);\r\n        var num = date % 3600;\r\n\r\n        if (!num == 0) {\r\n          if (num < 60) {\r\n            seconds = num;\r\n          } else if (num > 60 && num < 60 * 60) {\r\n            minutes = parseInt(num / 60);\r\n            //\r\n            if (!num % 60 === 0) {\r\n              seconds = num % 60;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (!hours == '') time += hours + '';\r\n    if (!minutes == '') time += minutes + '';\r\n    if (!seconds == '') time += seconds + '';\r\n\r\n    return time;\r\n  }\r\n}])\r\n\r\n//\r\nmyFilter.filter('timeTips', function() {\r\n  return function(data) {\r\n    var date = parseInt(data);\r\n    var sec = Math.ceil(new Date().getTime() / 1000) - date;\r\n    if (sec > 60 * 60 * 24) {\r\n      return Math.floor(sec / 60 * 60 * 24) + \"\";\r\n    }\r\n    if (sec > 60 * 60) {\r\n      return Math.floor(sec / 60 / 60) + '';\r\n    }\r\n    if (sec > 60) {\r\n      return Math.floor(sec / 60) + '';\r\n    }\r\n    return '';\r\n  };\r\n});\r\n\r\nmyFilter.filter('removeHtml', function() {\r\n  return function(str) {\r\n    str = str.replace(/<\\/?[^>]*>/g, ''); //HTML tag\r\n    str = str.replace(/[ | ]*\\n/g, '\\n'); //\r\n    //str = str.replace(/\\n[\\s| | ]*\\r/g,'\\n'); //\r\n    str = str.replace(/ /ig, ''); // \r\n    return str;\r\n  }\r\n});\r\n\r\n//html\r\nmyFilter.filter('to_trusted', ['$sce', function($sce) {\r\n  return function(text) {\r\n    return $sce.trustAsHtml(text);\r\n  };\r\n}]);\r\n\r\n\r\n\r\n\r\n/* */\r\nmyFilter.filter('imgToTrusted', ['$sce', function($sce) {\r\n  return function(text) {\r\n    if (angular.isString(text)) {\r\n      var text = text.replace(/<img.*_src=\\\"(.*)\\\".*type=\\\"vedio\\\">/, \"<iframe height=498 width=510 src=\\\"$1\\\" frameborder=0 allowfullscreen></iframe>\")\r\n      text = text.replace(/<img.*_src=\\\"(.*)\\\".*type=\\\"mp3\\\">/, \"<audio controls src=\\\"$1\\\" style=\\\"margin-top:24px\\\"></audio>\");\r\n    }\r\n    return $sce.trustAsHtml(text);\r\n  };\r\n}]);\r\n\r\n\r\n\r\nmyFilter.filter(\"noAnswer\", function() {\r\n  return function(str) {\r\n    if (!str) {\r\n      return \"[]\";\r\n    } else {\r\n      return \"\";\r\n    }\r\n  }\r\n})\r\n\r\n\r\nmyFilter.filter('limitword', function() {\r\n  return function(value, wordwise, max, tail) {\r\n    if (!value) return '';\r\n    max = parseInt(max, 10);\r\n    if (!max) return value;\r\n    if (value.length <= max) return value;\r\n    value = value.substr(0, max);\r\n    if (wordwise) {\r\n      var lastspace = value.lastIndexOf('');\r\n      if (lastspace != -1) {\r\n        value = value.substr(0, lastspace);\r\n      }\r\n    }\r\n    return value + (tail || '...');\r\n  };\r\n})\r\n\nvar myService = angular.module(\"myServices\", ['myFilter']);\r\n\r\n//\r\nmyService.factory('mxxServices', ['$rootScope', '$location', '$http', '$window', function($rootScope, $location, $http, $window) {\r\n  var mxxServices = {\r\n    //\r\n    qrCode: function(element, url) {\r\n      //var url=\"http://institu.mstudy.me/wechat/index?iid=\"+sid+\"#/classaction/\"+cid;\r\n      element.qrcode({\r\n        render: \"canvas\", //  \r\n        width: 140,\r\n        height: 140,\r\n        correctLevel: 0,\r\n        text: url\r\n      });\r\n    },\r\n\r\n    loginQrcode: function(element, url) {\r\n      element.qrcode({\r\n        render: \"canvas\", //  \r\n        width: 200,\r\n        height: 200,\r\n        correctLevel: 0,\r\n        text: url\r\n      });\r\n    },\r\n\r\n    getClassInfo: function(sco) {\r\n      //\r\n      $http.get(api_url + \"/class/info?cid=\" + sco.cid)\r\n        .success(function(data) {\r\n          sco.password = data.password;\r\n          sco.className = data.className;\r\n          sco.limit = data.maxNumber;\r\n          sco.classNum = data.userNumber;\r\n          sco.createSid = data.sid;\r\n          sco.isPumping = data.isPumping || 0;\r\n          // console.log(sco.isPumping);\r\n          // sco.url = data.qrCode;data.isPumping\r\n        })\r\n    },\r\n\r\n    //\r\n    showClass2WM: function(sco) {\r\n      sco.url = \"http://www.maixuexi.cn/student/#/my/class/all/\" + sco.cid;\r\n    },\r\n\r\n    getPaperData: function(sco) {\r\n      //\r\n      $http.get(api_url + \"/test/paper/preview?pid=\" + sco.pid)\r\n        .success(function(data) {\r\n          if (!data.status) {\r\n            // $http.get(api_url + \"/paper/preview/\" + sco.pid).success(function(data) {\r\n            //   if (!data.ret) {\r\n            sco.paper = data.paper;\r\n            sco.questions = data.questions;\r\n            if (data.stem) {\r\n              sco.stems = data.stem;\r\n            }\r\n            sco.isFinish = data.paper.isFinish;\r\n            sco.tid = data.paper.ownerTid;\r\n            sco.classes=[100674,100675,100676,100677,100678,100679];\r\n            if(sco.classes.indexOf(sco.tid)!=-1){\r\n              sco.showShareQuestionBox = true;\r\n            }\r\n            // console.log('1111',sco.isFinish,sco.showShareQuestionBox);\r\n            //paperquestion\r\n            if (sco.paper.paperStructJson && sco.paper.paperStructJson.length != 0) {\r\n              //``\r\n              sco.ans = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"];\r\n              for (var i = 0; i < sco.paper.paperStructJson.length; i++) {\r\n                if (sco.paper.paperStructJson[i].mid) {\r\n                  //\r\n                  // var reg=/^\\<img[*]\\>$/;\r\n                  var reg = /<img[^>]*>/gi;\r\n                  var imgArr = sco.questions[i].mContent.match(reg);\r\n\r\n                  if (imgArr) {\r\n                    for (var k = 0; k < imgArr.length; k++) {\r\n                      var startIndex = imgArr[k].indexOf('_src=\"');\r\n                      var endIndex = imgArr[k].indexOf('\"', startIndex + 6);\r\n                      if (imgArr[k].indexOf(\"vedio\") != -1) {\r\n                        sco.questions[i]['vedio_url'] = imgArr[k].substring(startIndex + 6, endIndex)+'?v=1002';\r\n                        sco.questions[i].mContent = sco.questions[i].mContent.replace(imgArr[k], '');\r\n                      }\r\n                      if (imgArr[k].indexOf(\"mp3\") != -1) {\r\n                        sco.questions[i]['audio_url'] = imgArr[k].substring(startIndex + 6, endIndex);\r\n                        sco.questions[i].mContent = sco.questions[i].mContent.replace(imgArr[k], '');\r\n                      }\r\n                    }\r\n                  };\r\n\r\n                  var mid = sco.paper.paperStructJson[i][mid];\r\n                  var resolves = sco.stems[mid];\r\n                  if (!resolves) { resolves = [] };\r\n                  for (var j = 0; j < resolves.length; j++) {\r\n                    var resolveToArray = []\r\n                    for (key in resolves[j].qResolve) {\r\n                      resolveToArray.push(key);\r\n                    }\r\n                    if (resolveToArray.length == 0) {\r\n                      resolves[j].qResolve = '';\r\n                    }\r\n                  }\r\n                } else {\r\n                  //\r\n                  var resolveToArray = [];\r\n                  // if (sco.questions[i] && sco.questions[i].qResolve) {\r\n                  for (key in sco.questions[i].qResolve) {\r\n                    resolveToArray.push(key);\r\n                  }\r\n                  // }\r\n\r\n                  if (resolveToArray.length == 0) {\r\n                    sco.questions[i].qResolve = '';\r\n                  }\r\n                }\r\n              };\r\n            };\r\n\r\n          }\r\n        });\r\n    }\r\n\r\n  };\r\n  return mxxServices;\r\n\r\n}]);\r\n\r\n//\r\nmyService.factory('toolServices', [function() {\r\n  var tools = {\r\n    /**\r\n     * keylist\r\n     * @obj Object key\r\n     */\r\n    'getKeys': function(obj) {\r\n      var list = new Array();\r\n      angular.forEach(obj, function(value, index, data) {\r\n        list.push(index);\r\n      })\r\n      return list;\r\n    },\r\n    //\r\n    getRandomNum: function(min, max) {\r\n      var range = max - min;\r\n      var random = Math.random();\r\n      return (min + Math.round(random * range));\r\n    }\r\n  };\r\n\r\n  return tools;\r\n}])\r\n\r\n//\r\nmyService.directive('classInfo', [function() {\r\n  return {\r\n    restict: 'AE',\r\n    replace: true,\r\n    templateUrl: './views/directive/classInfo.html'\r\n  };\r\n}]);\r\n\r\n//         word\r\nmyService.directive('paperStruct', [function() {\r\n  return {\r\n    restict: 'AE',\r\n    replace: true,\r\n    templateUrl: './views/directive/paperStruct.html'\r\n  };\r\n}]);\r\n\r\n\r\n//\r\nmyService.directive('monitor', ['$http', 'mxxServices', '$timeout', function($http, mxxServices, $timeout) {\r\n  return {\r\n    restict: 'AE',\r\n    replace: true,\r\n    templateUrl: './views/directive/monitor.html',\r\n    link: function(scope, ele, attrs) {\r\n      //\r\n      // $http.get(api_url + \"/class/teacher/tutor?cid=\" + scope.cid + \"&tid=\" + scope.tid)\r\n      //   .success(function(data) {\r\n      //     if (!data.status) {\r\n      //       scope.monitorlist = data.tutorList; //\r\n      //       if (data.count) {\r\n      //         $timeout(function() {\r\n      //           for (var i = 0; i < scope.monitorlist.length; i++) {\r\n      //             var url = \"http://www.maixuexi.cn/student/#/tutor/\" + scope.monitorlist[i].tutorId;\r\n      //             imgCode = $($(\".imgcode\")[i]);\r\n\r\n      //             mxxServices.qrCode(imgCode, url);\r\n\r\n      //           };\r\n      //         }, 500)\r\n      //       }\r\n      //     }\r\n\r\n      //   });\r\n    }\r\n  }\r\n}]);\r\n\r\n\r\n//\r\nmyService.directive('achive', ['$http', function($http) {\r\n  return {\r\n    restict: 'AE',\r\n    templateUrl: './views/directive/stat.html',\r\n    link: function(scope, ele, attrs) {\r\n      //\r\n      scope.update = function(wid) {\r\n        $http.get(api_url + \"/student/class/work/report?studentId=\" + scope.uid + \"&workId=\" + wid)\r\n          .success(function(data) {\r\n            if (!data.status) {\r\n              scope.workInfo = data;\r\n              scope.userQuesList = data.questionList;\r\n            }\r\n          })\r\n      }\r\n\r\n      //&number=5 \r\n      $http.get(api_url + \"/student/class/score?studentId=\" + scope.uid + \"&cid=\" + scope.cid + \"&number=5\")\r\n        .success(function(data) {\r\n          scope.worklist = data.scoreList;\r\n\r\n          if (scope.worklist.length != 0) { //0\r\n            var userScore = []; //\r\n            var avgScore = []; //\r\n            var getTime = []; //\r\n\r\n            function mdFormat(date) {\r\n              // var timeNum = parseInt(date);\r\n              // var time = new Date(timeNum);\r\n              var time = new Date(date);\r\n              var month = time.getMonth() + 1;\r\n              var day = time.getDate();\r\n              var hours = time.getHours();\r\n              var minutes = time.getMinutes();\r\n              //10\"0\";\r\n              if (month < 10) { month = \"0\" + month; }\r\n              if (day < 10) { day = \"0\" + day }\r\n              if (hours < 10) { hours = \"0\" + hours }\r\n              if (minutes < 10) { minutes = \"0\" + minutes }\r\n              var date = month + \"/\" + day + \" \" + hours + \":\" + minutes;\r\n              return date;\r\n            }\r\n\r\n            for (var i = 0; i < scope.worklist.length; i++) {\r\n              userScore.push(scope.worklist[i].score);\r\n              avgScore.push(scope.worklist[i].avgScore);\r\n              //\r\n              // scope.worklist[i].getTime = mdFormat(scope.worklist[i].getTime);\r\n              getTime.push(scope.worklist[i].submitTime);\r\n            }\r\n            $('#achive').highcharts({\r\n              exporting: {\r\n                enabled: false\r\n              },\r\n\r\n              chart: {\r\n                type: 'spline'\r\n              },\r\n              title: {\r\n                text: '<span style=\"color:#009234\"></span>/<span style=\"color:#bdbdbd\"></span>',\r\n\r\n              },\r\n              xAxis: {\r\n                //\r\n                categories: getTime\r\n              },\r\n              yAxis: {\r\n                title: {\r\n                  text: ''\r\n                }\r\n              },\r\n              tooltip: {\r\n                crosshairs: true,\r\n                shared: true\r\n              },\r\n              plotOptions: {},\r\n              series: [{\r\n                name: '',\r\n                color: '#009234',\r\n                data: userScore\r\n              }, {\r\n                name: '',\r\n                color: '#bdbdbd',\r\n                data: avgScore\r\n              }]\r\n            });\r\n          } else {\r\n            $(\"#achive\").html('<p class=\"norecord\"></p>');\r\n            $(\".paper-info\").css(\"display\", \"none\")\r\n          }\r\n\r\n        })\r\n\r\n      //\r\n      $http.get(api_url + \"/work/class/student/finish?cid=\" + scope.cid + '&studentId=' + scope.uid + \"&page=1&size=9999\")\r\n        .success(function(data) {\r\n          if (!data.status) {\r\n            scope.count = data.count;\r\n            scope.allWorkList = data.workList;\r\n            if(scope.count){\r\n              scope.work = scope.allWorkList[0];\r\n              scope.update(scope.allWorkList[0].workId);\r\n            } else {\r\n              // console.log('')\r\n              return;\r\n            }\r\n          }\r\n        })\r\n    }\r\n  };\r\n}]);\r\n\r\n\r\n//wid\r\nmyService.directive('stat', ['$http', function($http) {\r\n  return {\r\n    restict: 'AE',\r\n    template: '<div class=\"stat\" id=\"stat\"></div>',\r\n    link: function(scope, ele, attrs) {\r\n      $http.get(api_url + \"/work/question/answer?workId=\" + scope.wid)\r\n        .success(function(data) {\r\n          var ans = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"]; //\r\n          if (!data.status) {\r\n            scope.load = false;\r\n            var $stat = $(\"#stat\");\r\n            //data\r\n            var i = 0;\r\n            $.each(data.workList, function(key, obj) {\r\n              if (obj.keyList.length != 0) {\r\n                var str = '<div class=\"stat-img\" id=\"stat-' + i + '\"></div>';\r\n                $stat.append(str);\r\n                var isObjQues = obj.qType == 1 ? \"\" : \"\";\r\n\r\n                //\r\n                var options = [];\r\n                for (var j = 0; j < obj.keyList.length; j++) {\r\n                  if (obj.qType == 1) {\r\n                    //  ABCD...\r\n                    var index = obj.keyList[j].key;\r\n                    options.push(ans[index]);\r\n                  } else {\r\n                    var index = obj.keyList[j].key;\r\n                    options.push(index);\r\n                  };\r\n\r\n                };\r\n                var selectNum = [];\r\n                for (var j = 0; j < obj.keyList.length; j++) {\r\n                  selectNum.push(obj.keyList[j].value);\r\n\r\n                };\r\n                if (obj.qType == 1) {\r\n                  var answer = '';\r\n                  // obj.qAnswer = JSON.parse(obj.qAnswer);\r\n                  for (var k = 0; k < obj.qAnswer.length; k++) {\r\n                    var index = obj.qAnswer[k];\r\n                    answer += ans[index]\r\n                  }\r\n                  //\r\n                  var subtitle = \": \" + answer;\r\n                } else {\r\n                  var subtitle = '';\r\n                }\r\n                //x\r\n                //y\r\n                $('#stat-' + i).highcharts({ //divid\r\n                  chart: {\r\n                    type: 'column' //line\r\n                  },\r\n                  title: {\r\n                    text: obj.qNumber + '(' + isObjQues + obj.score + ')' //\r\n                  },\r\n                  subtitle: {\r\n                    text: subtitle\r\n                  },\r\n                  xAxis: {\r\n                    categories: options, //x\r\n                    crosshair: true\r\n                  },\r\n                  yAxis: {\r\n                    title: {\r\n                      text: '' //y\r\n                    }\r\n                  },\r\n                  series: [{ //\r\n                    name: '', //\r\n                    data: selectNum //\r\n                  }]\r\n                });\r\n\r\n                i++;\r\n              } else {\r\n                $(\"#stat\").html('<p class=\"norecord\">!</p>');\r\n              }\r\n\r\n            })\r\n          }\r\n        })\r\n    }\r\n  };\r\n}]);\r\n\r\nmyService.directive('userTop', ['$http', '$cookieStore', function($http, $cookieStore) {\r\n  return {\r\n    restict: 'AE',\r\n    replace: true,\r\n    templateUrl: './views/directive/userTop.html',\r\n    link: function(scope, ele, attrs) {\r\n      scope.userInfo = $cookieStore.get('user');\r\n\r\n      //cookie\r\n      $(\".logout\").click(function() {\r\n        $cookieStore.remove(\"loginTime\");\r\n      })\r\n    }\r\n  };\r\n}]);\r\n\r\n//\r\nmyService.directive('qrcode', ['mxxServices', function(mxxServices) {\r\n  return {\r\n    restict: 'AE',\r\n    transclude: true,\r\n    template: '<div class=\"qrCode\"><div id=\"imgCode\"></div><p></p></div>',\r\n    link: function(scope, ele, attrs) {\r\n      $(\"#imgCode\").qrcode({\r\n        render: \"canvas\", //  \r\n        width: 140,\r\n        height: 140,\r\n        correctLevel: 0,\r\n        text: scope.url\r\n      });\r\n    }\r\n  };\r\n}]);\r\n\r\nmyService.directive('dialog', ['$http', '$location', 'mxxServices', function($http, $location, mxxServices) {\r\n  return {\r\n    restict: 'AE',\r\n    templateUrl: './views/directive/dialog.html',\r\n    link: function(scope, ele, attrs) {\r\n\r\n      //\r\n      scope.mouse = {\r\n        mouseover: function() {\r\n          $(\".handle-menu\").css(\"display\", \"block\")\r\n        },\r\n        mouseout: function() {\r\n          $(\".handle-menu\").css(\"display\", \"none\")\r\n        }\r\n      };\r\n\r\n      scope.localWork = function() {\r\n        scope.paperName = \"\";\r\n        scope.selectedTagIds = [];\r\n        scope.paperlist = [];\r\n        //\r\n        $http.get(api_url + \"/tag/test/paper/list?page=1&size=99999\")\r\n          .success(function(data) {\r\n            scope.tagList = data.tagList;\r\n          });\r\n\r\n        //\r\n        $http.get(api_url + \"/test/paper/teacher?page=1&size=99999\")\r\n          .success(function(data) {\r\n            scope.paperlist = [];\r\n            // scope.paperlist = data.paperList;\r\n            if (!data.paperList || data.paperList.length == 0) {\r\n              scope.tip = true;\r\n            } else {\r\n              scope.tip = false;\r\n              for (var i = 0; i < data.paperList.length; i++) {\r\n                if (data.paperList[i].isFinish == 1) {\r\n                  scope.paperlist.push(data.paperList[i])\r\n                }\r\n              }\r\n            }\r\n          });\r\n\r\n        $(\".paper-modal\").css(\"display\", \"block\");\r\n        $(\".mask\").css(\"display\", \"block\")\r\n      };\r\n\r\n      //\r\n      scope.cancel = function() {\r\n        $(\".paper-modal\").css(\"display\", \"none\");\r\n        $(\".mask\").css(\"display\", \"none\")\r\n      };\r\n\r\n      // \r\n      scope.selectTag = function(id) {\r\n        scope.checked = {};\r\n        var index = scope.selectedTagIds.indexOf(id);\r\n        if (index == -1) {\r\n          scope.selectedTagIds.push(id)\r\n        } else {\r\n          scope.selectedTagIds.splice(index, 1);\r\n        }\r\n\r\n        if (scope.selectedTagIds.length == 0) {\r\n          // \r\n          $http.get(api_url + \"/test/paper/teacher?page=1&size=99999\")\r\n            .success(function(data) {\r\n              scope.paperlist = [];\r\n              // scope.paperlist = data.paperList;\r\n              if (!data.paperList || data.paperList.length == 0) {\r\n                scope.tip = true;\r\n              } else {\r\n                scope.tip = false;\r\n                for (var i = 0; i < data.paperList.length; i++) {\r\n                  if (data.paperList[i].isFinish == 1) {\r\n                    scope.paperlist.push(data.paperList[i])\r\n                  }\r\n                }\r\n              }\r\n            });\r\n          return\r\n        }\r\n\r\n        $http.get(api_url + \"/tag/test/paper?tagId=[\" + scope.selectedTagIds + \"]&page=1&size=99999\")\r\n          .success(function(data) {\r\n            scope.paperlist = [];\r\n            // scope.paperlist = data.paperList;\r\n            if (!data.paperList || data.paperList.length == 0) {\r\n              scope.tip = true;\r\n            } else {\r\n              scope.tip = false;\r\n              for (var i = 0; i < data.paperList.length; i++) {\r\n                if (data.paperList[i].isFinish == 1) {\r\n                  scope.paperlist.push(data.paperList[i])\r\n                }\r\n              }\r\n            }\r\n          });\r\n      }\r\n\r\n      //\r\n      /*scope.search = function() {\r\n        if (!scope.paperName) {\r\n          alert(\"!\");\r\n          return;\r\n        }\r\n        $http.put(api_url + \"/test/paper/search?page=1&size=99999\", {\r\n          \"paperName\": scope.paperName\r\n        }).success(function(data) {\r\n          scope.paperlist = []; //\r\n          for (var i = 0; i < data.paperList.length; i++) {\r\n            if (data.paperList[i].isFinish == 1) {\r\n              scope.paperlist.push(data.paperList[i])\r\n            }\r\n          }\r\n        })\r\n      };*/\r\n      scope.checked = {};\r\n      scope.oneCheck = function(pid) {\r\n        if (scope.checked[pid]) {\r\n          scope.checked = {};\r\n        } else {\r\n          scope.checked = {};\r\n          scope.checked[pid] = true;\r\n        }\r\n      };\r\n      scope.confirm = function() {\r\n        var arr = [];\r\n        for (key in scope.checked) {\r\n          arr.push(key);\r\n        };\r\n\r\n        if (arr.length == 0) {\r\n          alert(\"!\");\r\n        } else {\r\n          $(\".mtk-import-info\").css(\"display\", \"none\");\r\n          $(\".paper-modal\").css(\"display\", \"none\");\r\n          $(\".edui-container\").css(\"display\", \"none\");\r\n          $(\".mask\").css(\"display\", \"none\")\r\n          $(\".mtk-contenter\").css(\"display\", \"block\");\r\n          $(\".test-tag-list\").css(\"display\", \"none\");\r\n          $(\".mtk-info\").css(\"display\", \"block\");\r\n\r\n          $http.get(api_url + \"/test/paper/preview?pid=\" + arr[0])\r\n            .success(function(data) {\r\n              if (!data.status) {\r\n                $(\".left-input p\").css(\"display\", \"block\");\r\n                scope.paperInfo = data.paper;\r\n                scope.paperInfo.score = parseInt(scope.paperInfo.objScore) + parseInt(scope.paperInfo.subScore);\r\n                scope.localPaperName = data.paper.paperName;\r\n                scope.localPaper = data.questions;\r\n                if (data.stem) {\r\n                  scope.localStems = data.stem;\r\n                };\r\n\r\n                //\r\n                $http.get(api_url + \"/tag/test/question/achieve/paper?pid=\" + arr[0])\r\n                  .success(function(res) {\r\n                    if (!res.status) {\r\n                      angular.forEach(res.questions, function(ele) {\r\n                        angular.forEach(scope.localPaper, function(element) {\r\n                          if (ele.qid && element.qid && ele.qid === element.qid) {\r\n                            element['tagList'] = ele.tagList;\r\n                          }\r\n                        })\r\n                      })\r\n                      if (res.stem) {\r\n                        for (var k in res.stem) {\r\n                          angular.forEach(scope.localStems[k], function(ele) {\r\n                            angular.forEach(res.stem[k], function(element) {\r\n                              if (ele.qid == element.qid) {\r\n                                ele['tagList'] = element.tagList;\r\n                              }\r\n                            })\r\n                          })\r\n                        }\r\n                      };\r\n\r\n                    }\r\n                  })\r\n\r\n                if ($(\".qrcode\").children()) {\r\n                  $(\".qrcode\").empty();\r\n                }\r\n\r\n                //\r\n                var url = \"http://www.maixuexi.cn/phone/#/preview/\" + arr[0];\r\n                //\r\n                mxxServices.qrCode($(\".qrcode\"), url);\r\n\r\n                if (scope.paperInfo.paperStructJson && scope.paperInfo.paperStructJson.length != 0) {\r\n                  //\r\n                  scope.ans = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"];\r\n                  /*for (var i = 0; i < scope.paperInfo.paperStruct.length; i++) {\r\n                    if (scope.localPaper[i]) { //\r\n                      scope.localPaper[i].isComposite = scope.paperInfo.paperStruct[i].isComposite;\r\n                    }\r\n                  };*/\r\n                };\r\n              }\r\n            });\r\n        }\r\n      };\r\n\r\n      //\r\n      scope.localTest = function() {\r\n        scope.localPaper = [];\r\n        scope.localStems = {};\r\n        //\r\n        $http.get(api_url + \"/tag/test/question/list?page=1&size=99999\")\r\n          .success(function(data) {\r\n            scope.testTagList = data.tagList;\r\n            scope.selectedTestTagIds = [];\r\n\r\n            $(\".mtk-import-info\").css(\"display\", \"none\");\r\n            $(\".mtk-info\").css(\"display\", \"none\");\r\n            $(\".left-input p\").css(\"display\", \"none\");\r\n            $(\".test-tag-list\").css(\"display\", \"block\");\r\n            $(\".edui-container\").css(\"display\", \"none\");\r\n            $(\".mtk-contenter\").css(\"display\", \"block\");\r\n          });\r\n      }\r\n\r\n      // \r\n      scope.selectTestTag = function(id) {\r\n        var index = scope.selectedTestTagIds.indexOf(id);\r\n        if (index == -1) {\r\n          scope.selectedTestTagIds.push(id)\r\n        } else {\r\n          scope.selectedTestTagIds.splice(index, 1);\r\n        }\r\n\r\n        if (scope.selectedTestTagIds.length == 0) {\r\n          scope.localPaper = [];\r\n          scope.localStems = {};\r\n          scope.testTip = false;\r\n          return\r\n        }\r\n\r\n        $http.get(api_url + \"/tag/test/question?tagId=[\" + scope.selectedTestTagIds + \"]\")\r\n          .success(function(data) {\r\n            if (data.count == 0) {\r\n              scope.testTip = true;\r\n              scope.localPaper = [];\r\n              scope.localStems = {};\r\n            } else {\r\n              scope.testTip = false;\r\n              scope.localPaper = data.questions;\r\n              if (data.stem) {\r\n                scope.localStems = data.stem;\r\n              };\r\n\r\n              // if (scope.paperInfo.paperStructJson && scope.paperInfo.paperStructJson.length != 0) {\r\n              //\r\n              scope.ans = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"];\r\n              /*for (var i = 0; i < scope.paperInfo.paperStruct.length; i++) {\r\n                if (scope.localPaper[i]) { //\r\n                  scope.localPaper[i].isComposite = scope.paperInfo.paperStruct[i].isComposite;\r\n                }\r\n              };*/\r\n              // };\r\n            }\r\n\r\n          });\r\n      }\r\n\r\n    }\r\n  };\r\n}]);\r\n\r\n//\r\nmyService.directive('uploader', ['$location', '$rootScope', '$http', function($location, $rootScope, $http) {\r\n  return {\r\n    restict: 'AE',\r\n    scope: true,\r\n    templateUrl: './views/directive/uploader.html',\r\n    link: function(scope, ele, attrs) {\r\n      //\r\n      scope.forward = function() {\r\n        // window.history.go(-1);\r\n        //\r\n        $location.path(\"/paper/name/\" + scope.pid)\r\n      };\r\n      scope.ans = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"];\r\n      //\r\n      scope.preview = function() {\r\n        $dt = $(\"#test dt\");\r\n        var len = $(\"#test dt\").length;\r\n        if (len == 0) {\r\n          alert(\"...\");\r\n          return;\r\n        };\r\n        //$(\"#test dt\")\r\n        for (var i = 0; i < len; i++) {\r\n          var $this = $($dt[i]); //jquery\r\n          var type = $this.attr('data-type');\r\n          if (type != 3) { //\r\n            if ($this.find(\"input[attr='score']\").val() == '') {\r\n              alert(\"\" + (i + 1) + \"!\");\r\n              $.pinput.handle.jumpOrder(i + 1);\r\n              return;\r\n            };\r\n            if ($this.find(\"div[attr='title']\").html() == '') {\r\n              alert(\"\" + (i + 1) + \"\");\r\n              $.pinput.handle.jumpOrder(i + 1);\r\n              return;\r\n            };\r\n            if (type == 1) { //\r\n              //console.log($this.find(\".correct\").length);\r\n              if ($this.find(\".correct\").length == 0) {\r\n                alert(\"\" + (i + 1) + \"\");\r\n                $.pinput.handle.jumpOrder(i + 1);\r\n                return;\r\n              }\r\n              for (var j = 0; j < $this.find(\".answer\").length; j++) {\r\n                if ($this.find(\".answer\")[j].innerHTML == \"\") {\r\n                  alert(\"\" + (i + 1) + \"\" + scope.ans[j] + \"\");\r\n                  $.pinput.handle.jumpOrder(i + 1);\r\n                  return;\r\n                }\r\n              }\r\n            }\r\n          };\r\n          if (type == 3) {\r\n            //console.log($this.find(\"div[attr='material']\").html());\r\n            if ($this.find(\"div[attr='material']\").html() == '') {\r\n              alert(\"\" + (i + 1) + \"\");\r\n              $.pinput.handle.jumpOrder(i + 1);\r\n              return;\r\n            };\r\n            //console.log($this.find(\".pinput-item-question .pinput-question\").attr(\"data-type\"));                       \r\n\r\n            var $items = $this.find(\".pinput-item-boder\");\r\n            //console.log($items);\r\n            if ($items.length == 0) {\r\n              alert(\"\" + (i + 1) + \"\");\r\n              $.pinput.handle.jumpOrder(i + 1);\r\n              return;\r\n            }\r\n            for (var j = 0; j < $items.length; j++) {\r\n              var _this = $($items[j]);\r\n              var qtype = _this.find(\".pinput-item-main .pinput-question\").attr(\"data-type\");\r\n              //\r\n              //console.log(qtype);\r\n              //console.log(_this.find(\"input[attr='score']\").val());\r\n              if (_this.find(\"input[attr='score']\").val() == '') {\r\n                alert(\"\" + (i + 1) + '-' + (j + 1) + \"!\");\r\n                $.pinput.handle.jumpOrder(i + 1);\r\n                return;\r\n              };\r\n              if (_this.find(\"div[attr='title']\").html() == '') {\r\n                alert(\"\" + (i + 1) + '-' + (j + 1) + \"\");\r\n                $.pinput.handle.jumpOrder(i + 1);\r\n                return;\r\n              };\r\n              if (qtype == 1) {\r\n                if (_this.find(\".correct\").length == 0) {\r\n                  alert(\"\" + (i + 1) + '-' + (j + 1) + \"\")\r\n                  $.pinput.handle.jumpOrder(i + 1);\r\n                  return;\r\n                }\r\n                console.log(_this.find(\".answer\"))\r\n                for (var k = 0; k < _this.find(\".answer\").length; k++) {\r\n                  if (_this.find(\".answer\")[k].innerHTML == \"\") {\r\n                    alert(\"\" + (i + 1) + '-' + (j + 1) + \"\" + scope.ans[k] + \"\");\r\n                    $.pinput.handle.jumpOrder(i + 1);\r\n                    return;\r\n                  }\r\n                }\r\n              }\r\n            }\r\n\r\n          };\r\n\r\n        };\r\n\r\n        $location.path(\"/paper/preview/\" + scope.pid);\r\n\r\n      };\r\n\r\n      if ($location.path().indexOf(\"paper/edit/\") == -1) {\r\n        //word\r\n        $http.get(api_url + \"/test/paper/preview?pid=\" + scope.pid)\r\n          .success(function(data) {\r\n            if (data.paper.word) {\r\n              $(\"#redactor_modal_overlay\").css(\"display\", \"block\");\r\n              $.ajax({\r\n                type: \"GET\",\r\n                url: \"http://218.244.140.132/\" + data.paper.word,\r\n                success: function(msg) {\r\n                  $(\".mtk-import-info\").css(\"display\", \"none\");\r\n                  $(\".mtk-contenter\").css(\"display\", \"none\");\r\n\r\n                  var um = UM.getEditor('self-editor');\r\n                  um.ready(function() {\r\n                    //\r\n                    $(\"#redactor_modal_overlay\").css(\"display\", \"none\");\r\n                    um.setContent(msg);\r\n                  });\r\n                }\r\n              })\r\n            }\r\n          });\r\n\r\n        //\r\n        window.uploader = new plupload.Uploader({\r\n          browse_button: 'pickfiles', //id\r\n          file_data_name: 'file',\r\n          url: 'http://218.244.140.132:9000/doc2Html', //url\r\n          filters: {\r\n            mime_types: [\r\n              { title: 'word file', extensions: \"doc,docx\" } //\r\n            ],\r\n            prevent_duplicates: true, //\r\n          },\r\n          multipart: true //truemultipart/form-data  \r\n        });\r\n        uploader.init(); //\r\n\r\n        //\r\n        uploader.bind('FilesAdded', function(uploader, files) {\r\n\r\n          uploader.start(); //\r\n\r\n          $(\"#redactor_modal_overlay\").css(\"display\", \"block\");\r\n          //\r\n          // $(\"#box\").css(\"opacity\", 0.3);\r\n          // $(\"#box\").bind(\"click\", function() {\r\n          //     return false;\r\n          // });\r\n        });\r\n\r\n        uploader.bind('UploadProgress', function(uploader, file) {\r\n          //UI\r\n          //console.log(file.percent);\r\n          $(\".loading-info\").html(file.percent + '%');\r\n        });\r\n\r\n        //\r\n        uploader.bind('FileUploaded', function(uploader, file, res) {\r\n          //\r\n          $(\".loading-info\").html(\"waiting\");\r\n\r\n          var resp = JSON.parse(res.response);\r\n\r\n          if (file.name.indexOf(\".docx\") != -1) {\r\n            var doctype = \"docx\";\r\n          } else {\r\n            var doctype = \"doc\";\r\n          }\r\n\r\n          if (resp.is_exist == -1) {\r\n            $.ajax({\r\n              type: \"POST\",\r\n              url: \"http://218.244.140.132:9000/doc2Html/conver/\" + resp.md5 + \"/\" + doctype,\r\n              success: function(msg) {\r\n                $(\".mtk-import-info\").css(\"display\", \"none\");\r\n                $(\".mtk-contenter\").css(\"display\", \"none\");\r\n                $.ajax({\r\n                  type: \"GET\",\r\n                  url: \"http://218.244.140.132/\" + resp.path,\r\n                  success: function(msg) {\r\n                    $(\".mtk-import-info\").css(\"display\", \"none\");\r\n                    $(\".mtk-contenter\").css(\"display\", \"none\");\r\n\r\n                    var um = UM.getEditor('self-editor');\r\n\r\n                    um.ready(function() {\r\n                      //\r\n                      $(\"#redactor_modal_overlay\").css(\"display\", \"none\");\r\n                      um.setContent(msg);\r\n                      //\r\n                      $http.put(api_url + \"/test/paper\", {\r\n                        \"pid\": parseInt(scope.pid),\r\n                        \"word\": resp.path\r\n                      }).success(function(data) {\r\n                        //console.log(data);\r\n                      })\r\n                    });\r\n                  }\r\n                })\r\n              }\r\n            });\r\n          } else {\r\n            $.ajax({\r\n              type: \"GET\",\r\n              url: \"http://218.244.140.132/\" + resp.path,\r\n              success: function(msg) {\r\n                $(\".mtk-import-info\").css(\"display\", \"none\");\r\n                $(\".mtk-contenter\").css(\"display\", \"none\");\r\n\r\n                var um = UM.getEditor('self-editor');\r\n\r\n                um.ready(function() {\r\n\r\n                  //\r\n                  $(\"#redactor_modal_overlay\").css(\"display\", \"none\");\r\n                  um.setContent(msg);\r\n                  //\r\n                  $http.put(api_url + \"/test/paper\", {\r\n                    \"pid\": parseInt(scope.pid),\r\n                    \"word\": resp.path\r\n                  }).success(function(data) {\r\n                    //console.log(data);\r\n                  })\r\n                });\r\n              }\r\n            })\r\n          }\r\n        })\r\n\r\n\r\n      }\r\n\r\n    }\r\n  };\r\n}]);\r\n\r\n/**/\r\nmyService.directive('correctFooter', [function() {\r\n  return {\r\n    restict: 'AE',\r\n    replace: true,\r\n    templateUrl: './views/work/correctFooter.html',\r\n    controller: 'workcorrect',\r\n    link: function() {\r\n\r\n    }\r\n  };\r\n}]);\r\n\r\n//\r\n//tab\r\nmyService.directive('myTab', [\"$rootScope\", \"mxxServices\", \"$location\", function($rootScope, mxxServices, $location) {\r\n  return {\r\n    restrict: 'AE',\r\n    replace: true,\r\n    templateUrl: './views/directive/aside.html',\r\n    link: function(scope, ele, attrs) {\r\n      if ($rootScope.location.indexOf(\"/index\") != -1) {\r\n        $(\".sidebar li .index\").addClass(\"selected\");\r\n      }\r\n      if ($rootScope.location.indexOf(\"/class/\") != -1) {\r\n        $(\".sidebar li .manger-class\").addClass(\"selected\");\r\n      }\r\n      if ($rootScope.location.indexOf(\"/paper/\") != -1) {\r\n        $(\".sidebar li .manger-paper\").addClass(\"selected\");\r\n      }\r\n      if ($rootScope.location.indexOf(\"/work/\") != -1) {\r\n        $(\".sidebar li .set-test\").addClass(\"selected\");\r\n      }\r\n      if ($rootScope.location.indexOf(\"/setting\") != -1) {\r\n        $(\".sidebar li .set-system\").addClass(\"selected\");\r\n      }\r\n    }\r\n  }\r\n}]);\r\n\r\n\r\n//\r\nmyService.directive('pagination', ['mxxServices', '$http', function(mxxServices, $http) {\r\n  return {\r\n    restrict: 'AE',\r\n    replace: true,\r\n    templateUrl: './views/directive/pagination.html',\r\n    link: function(scope, ele, attrs) {\r\n      //\r\n      scope.next = function() { //\r\n        if (scope.currentPage < scope.num) {\r\n          scope.currentPage++;\r\n          scope.getData();\r\n        }\r\n      };\r\n      scope.prev = function() { //                 \r\n        if (scope.currentPage > 1) {\r\n          scope.currentPage--;\r\n          scope.getData();\r\n        }\r\n      };\r\n      scope.getData();\r\n    }\r\n  }\r\n}]);\r\n\r\n\r\n/*sunqisteven */\r\nmyService.factory(\"correctService\", [\"$http\", function($http) {\r\n  var correctService = {\r\n    getWorkBaseInfo: function(workId) {\r\n      // var api = api_url + \"/check/base/\" + workId;\r\n      var api = api_url + \"/correct/base?workId=\" + workId;\r\n      // if(window.location.hostname==\"127.0.0.1\"){ api = \"/data/work.json\";}\r\n\r\n      var correctPromise = $http.get(api).then(function(res) {\r\n        return res.data;\r\n      })\r\n      return correctPromise;\r\n    },\r\n    /**/\r\n    /*getPaperInfo: function(pid) {\r\n      var api = api_url + \"/paper/\" + pid;\r\n      // var api = \"/data/paper.json\";\r\n      console.info(\"start to request paper info by paperid\")\r\n      var paperPromise = $http.get(api).then(function(res) {\r\n        return res.data;\r\n      })\r\n      return paperPromise;\r\n    },*/\r\n    /**/\r\n    /*getQuestions: function(qids) {\r\n      var api = api_url + \"/question/list?qid=\" + qids;\r\n      var api = \"/data/question.json\";\r\n      console.info('start to batch request questions info');\r\n      var questionsPromise = $http.get(api).then(function(res) {\r\n        return res.data;\r\n      });\r\n      return questionsPromise;\r\n    },*/\r\n    getCorrectInfoByqid: function(wid, qid) {\r\n      // var api = api_url + \"/ischeck/\" + wid + \"/\" + qid;\r\n      var api = api_url + \"/correct/base/student?workId=\" + wid + \"&qid=\" + qid;\r\n\r\n      var q = $http.get(api).then(function(res) {\r\n        res.data.studentList = res.data.studentList.concat(res.data.studentList2)\r\n        return res.data;\r\n      })\r\n      return q;\r\n    },\r\n    getStudentQidInfo: function(wid, qid, studentId) {\r\n      var api = api_url + \"/answer?studentId=\" + studentId + \"&workId=\" + wid + \"&qid=\" + qid;\r\n\r\n      var q = $http.get(api).then(function(res) {\r\n        return res.data;\r\n      })\r\n      return q;\r\n    },\r\n    submit: function(data) {\r\n      // var api = api_url + \"/answer/check\";\r\n      var api = api_url + \"/answer/correct/crosshead\";\r\n\r\n      var q = $http.put(api, data).then(function(res) {\r\n        return res.data;\r\n      })\r\n      return q;\r\n    },\r\n    /*   */\r\n    changeWorkStatus: function(wid,sendAll) {\r\n      // var api = api_url + \"/work/save/\" + wid;\r\n      var api = api_url + \"/work/correct/finish\";\r\n\r\n      var q = $http.put(api, { 'workId': wid, 'sendAll': sendAll }).then(function(res) {\r\n        return res.data;\r\n      })\r\n      return q;\r\n    },\r\n    preview: function(pid) {\r\n      // var api = api_url + \"/paper/preview/\" + pid;\r\n      var api = api_url + \"/test/paper/preview?pid=\" + pid;\r\n\r\n      // if(window.location.hostname== \"127.0.0.1\") { api = \"/data/preview.json\";}\r\n\r\n      var q = $http.get(api).then(function(res) {\r\n        return res.data;\r\n      });\r\n      return q;\r\n    },\r\n    // showTip: function(message) {\r\n    //   var bodyHeight = $(\"body\").height();\r\n    //   var tipBoxTop = bodyHeight / 2;\r\n    //   var overLay = \"<div id=\\\"zoomImageOverlay\\\" style=\\\"position:fixed;top:0;left:0;width:100%;\" + \"height:100%;background:black;opacity:0.75;text-align:center;z-index:9999;text-align:center;\\\"></div>\" + \"<div id=\\\"zoomImageBox\\\" style=\\\"width:100%;position:absolute;z-index:99999;top:0;left:0;\\\">\" + \"<div style=\\\"width:250px;height:60px;background:#fff;text-align:center;line-height:60px;position:relative;\" + \"margin:0 auto;border-radius:5px;font-size:18px;opacity:1;margin-top:\" + tipBoxTop + \"px\\\">\" + \"<span>\" + message + \"</span>\" + \"<span id=\\\"zoomImageBoxCloseBtn\\\" style=\\\"width:30px;height:30px;border-radius:15px;cursor:pointer;text-align:center;\" + \"line-height:30px;color:#FE8000;position:absolute;background:#fff;top:-25px;right:-25px;border:1px solid #fff;\\\">X</span>\" + \"</div>\" + \"</div>\";\r\n    //   $(\"body\").append(overLay).scrollTop(0);\r\n    //   $(\"#zoomImageBoxCloseBtn\").click(function() {\r\n    //     $(\"#zoomImageBox\").remove();\r\n    //     $(\"#zoomImageOverlay\").remove();\r\n    //   })\r\n    // },\r\n    // ,!\r\n    /* util for finding a object by its unique identifier property among a array */\r\n    findObjInArray: function(a, property, value) {\r\n      for (var i = 0; i < a.length; i++) {\r\n        if (a[i][property] == parseInt(value)) {\r\n          return a[i];\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  return correctService;\r\n\r\n}]);\r\n"],"sourceRoot":"/source/"}